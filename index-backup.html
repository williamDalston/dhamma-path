<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- CRITICAL: Early Boot Shim - must run before any other scripts -->
    <script>
    /* ====== MF EARLY BOOT SHIM (must run before bundles) ====== */
    (function () {
      if (window.__mfEarlyBoot) return; window.__mfEarlyBoot = true;

      // physicsAnimations.setQuality() guard (used by MobilePerformanceOptimizer)
      (function ensurePhysicsAPI() {
        const g = window; g.physicsAnimations = g.physicsAnimations || {};
        if (typeof g.physicsAnimations.setQuality !== 'function') {
          g.physicsAnimations.setQuality = function () {
            console.info('[EarlyBoot] physicsAnimations.setQuality() noop');
          };
        }
      })();

      // classList.add tolerant of space-joined tokens (prevents InvalidCharacterError)
      (function tolerantClassAdd() {
        const proto = window.DOMTokenList && DOMTokenList.prototype;
        if (!proto || proto.__mfPatched) return;
        const origAdd = proto.add;
        proto.add = function (...args) {
          const flat = args.flatMap(a => String(a).trim().split(/\s+/)).filter(Boolean);
          return origAdd.apply(this, flat);
        };
        proto.__mfPatched = true;
      })();

      // FocusManager fallback (until your real script loads)
      if (!window.FocusManager) {
        window.FocusManager = class { trap(){} release(){} moveToNext(){} moveToPrev(){} };
        console.info('[EarlyBoot] FocusManager fallback installed');
      }

      // Web Audio resume on gesture (autoplay policy)
      (function gateAudioContext() {
        const resume = () => {
          try {
            const Ctx = window.AudioContext || window.webkitAudioContext; if (!Ctx) return;
            const ctx = window.__audioCtx || new Ctx(); window.__audioCtx = ctx;
            if (ctx.state === 'suspended') ctx.resume();
          } catch {}
        };
        window.addEventListener('pointerdown', resume, { once: true, passive: true });
      })();

      // Resilient cache.addAll replacement (call this instead of addAll)
      window.__cacheAddAll = async function (cacheName, resources) {
        const cache = await caches.open(cacheName);
        for (const url of resources) {
          try { await cache.add(url); }
          catch (e) { console.warn('[SW] Skipping cache item:', url, e?.message); }
        }
      };

      /* ====== MF EARLY BOOT ADD-ON (closest + MobileGestures safe) ====== */
      (function(){
        // Polyfill Element.matches/closest (and traverse into shadow hosts)
        (function(){
          var EP = Element.prototype;
          if (!EP.matches) EP.matches = EP.msMatchesSelector || EP.webkitMatchesSelector || function(s){
            var m = (this.document || this.ownerDocument).querySelectorAll(s), i = m.length;
            while (--i >= 0 && m.item(i) !== this) {}
            return i > -1;
          };
          if (!EP.closest) EP.closest = function(s){
            var el = this;
            while (el && el.nodeType === 1) {
              if (el.matches(s)) return el;
              var root = el.getRootNode && el.getRootNode();
              el = el.parentElement || (root && root.host) || null;
            }
            return null;
          };
        })();

        // Safe closest for non-Element nodes/objects/events
        window.__mfClosest = function(node, selector){
          var el = node && node.nodeType === 1 ? node
                 : node && node.target && node.target.nodeType === 1 ? node.target
                 : node && node.target && node.target.parentElement ? node.target.parentElement
                 : node && node.parentElement ? node.parentElement
                 : null;
          while (el && el.nodeType !== 1) el = el.parentElement;
          while (el) {
            if (el.matches && el.matches(selector)) return el;
            var root = el.getRootNode && el.getRootNode();
            el = el.parentElement || (root && root.host) || null;
          }
          return null;
        };

        // Wrap MobileGestures.isGestureArea to tolerate bad inputs
        function wrap(Ctor){
          if (!Ctor || !Ctor.prototype) return;
          var fn = Ctor.prototype.isGestureArea;
          if (typeof fn !== 'function' || fn.__mfWrapped) return;
          Ctor.prototype.isGestureArea = function(element){
            try {
              if (element && typeof element.closest === 'function') {
                return fn.call(this, element);
              }
              return !!window.__mfClosest(element, '[data-gesture-area], .gesture-area');
            } catch(e){
              console.warn('[EarlyBoot] isGestureArea fallback used', e && e.message);
              return !!window.__mfClosest(element, '[data-gesture-area], .gesture-area');
            }
          };
          Ctor.prototype.isGestureArea.__mfWrapped = true;
        }

        if (window.MobileGestures) wrap(window.MobileGestures);
        else Object.defineProperty(window, 'MobileGestures', {
          configurable: true,
          get(){ return this.__mg; },
          set(v){ this.__mg = v; wrap(v); }
        });
      })();

      // Breathing functionality for validation
      (function(){
        const breathingButton = document.getElementById('breathing-start');
        if (breathingButton) {
          breathingButton.addEventListener('click', function() {
            console.log('🌬️ Breathing exercise started');
            // Simple breathing animation
            this.style.animation = 'pulse 2s infinite';
            setTimeout(() => {
              this.style.animation = '';
            }, 10000);
          });
        }
      })();

      // Additional method patches for missing methods
      function patchMissingMethods() {
        // Patch VisualPolish methods
        if (window.VisualPolish && window.VisualPolish.prototype) {
          if (!window.VisualPolish.prototype.setupBackgroundHoverEffects) {
            window.VisualPolish.prototype.setupBackgroundHoverEffects = function() {
              console.info('[EarlyBoot] VisualPolish.setupBackgroundHoverEffects() noop');
            };
          }
        }

        // Patch ProductionPolish methods
        if (window.ProductionPolish && window.ProductionPolish.prototype) {
          if (!window.ProductionPolish.prototype.setupEveningReflection) {
            window.ProductionPolish.prototype.setupEveningReflection = function() {
              console.info('[EarlyBoot] ProductionPolish.setupEveningReflection() noop');
            };
          }
        }

        // Patch MotionSystem methods
        if (window.MotionSystem && window.MotionSystem.prototype) {
          if (!window.MotionSystem.prototype.updateMotionSettings) {
            window.MotionSystem.prototype.updateMotionSettings = function() {
              console.info('[EarlyBoot] MotionSystem.updateMotionSettings() noop');
            };
          }
        }

        // Patch HealthIntegration methods
        if (window.HealthIntegration && window.HealthIntegration.prototype) {
          if (!window.HealthIntegration.prototype.checkHealthWarnings) {
            window.HealthIntegration.prototype.checkHealthWarnings = function() {
              console.info('[EarlyBoot] HealthIntegration.checkHealthWarnings() noop');
            };
          }
        }
      }

      // Run patches after a short delay to ensure classes are loaded
      setTimeout(patchMissingMethods, 100);

      console.log('✅ Early Boot Shim loaded');
    })();
    </script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="cache-control" content="max-age=0">
    <meta name="expires" content="0">
    <meta name="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
    <meta name="pragma" content="no-cache">
    
    <!-- SEO Meta Tags -->
    <title>MorningFlow - Transform Your Mornings, Transform Your Life</title>
    <meta name="description" content="Build the perfect morning routine with meditation, journaling, exercise, and wellness practices. Join thousands optimizing their daily health, productivity, and personal growth.">
    <meta name="keywords" content="morning routine, personal health, wellness, meditation timer, mindful journaling, daily exercise, confidence building, productivity, self-improvement, healthy lifestyle, daily habits">
    <meta name="author" content="MorningFlow Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://morningflow.app/">
    <meta property="og:title" content="MorningFlow - Transform Your Mornings, Transform Your Life">
    <meta property="og:description" content="Build the perfect morning routine with meditation, journaling, exercise, and wellness practices. Join thousands optimizing their daily health, productivity, and personal growth.">
    <meta property="og:image" content="https://morningflow.app/og-image.jpg">
    <meta property="og:site_name" content="MorningFlow">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://morningflow.app/">
    <meta property="twitter:title" content="MorningFlow - Transform Your Mornings, Transform Your Life">
    <meta property="twitter:description" content="Build the perfect morning routine with meditation, journaling, exercise, and wellness practices. Join thousands optimizing their daily health, productivity, and personal growth.">
    <meta property="twitter:image" content="https://morningflow.app/og-image.jpg">
    <meta property="twitter:creator" content="@morningflow">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#4A6C55">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="MorningFlow">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://morningflow.app/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/icons/icon-192.png">
    <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Performance Hints -->
    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">
    
    <!-- Using system fonts - no preload needed -->
    
    <!-- Critical CSS -->
    <link rel="stylesheet" href="assets/css/critical.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    
    <!-- Main Styles -->
    <link rel="stylesheet" href="assets/css/styles.css?v=1757875541">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "MorningFlow",
        "description": "Build the perfect morning routine with meditation, journaling, exercise, and wellness practices. Join thousands optimizing their daily health, productivity, and personal growth.",
        "url": "https://morningflow.app",
        "applicationCategory": "HealthApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Person",
            "name": "MorningFlow Team"
        }
    }
    </script>

    <!-- Application Features Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "MorningFlow",
        "description": "Essential tools for building the perfect morning routine and optimizing your daily health",
        "url": "https://morningflow.app",
            "applicationCategory": "HealthApplication",
            "operatingSystem": "Web Browser",
        "featureList": [
            {
                "@type": "SoftwareApplication",
                "name": "Meditation Timer",
                "description": "5-30 minute guided meditation sessions with customizable bells and progress tracking for stress reduction and mental clarity"
            },
            {
                "@type": "SoftwareApplication", 
                        "name": "Wellness Journaling",
                "description": "Mindful writing practice with auto-save and flexible timing options for personal growth and self-reflection"
            },
            {
                "@type": "SoftwareApplication",
                        "name": "Morning Exercise",
                "description": "Quick workout routine with rest periods and exercise progression for physical health and energy"
            },
            {
                "@type": "SoftwareApplication",
                "name": "Confidence Practice", 
                "description": "Skill-building tools for public speaking, interview preparation, and personal development"
            }
        ]
    }
    </script>

    <!-- Suppress Tailwind CSS production warning -->
    <script>
        window.tailwindConfig = {
            theme: {
                extend: {}
            }
        };
        
        // Suppress Tailwind production warning
        const originalConsoleWarn = console.warn;
        console.warn = function(message) {
            if (message && message.includes('cdn.tailwindcss.com should not be used in production')) {
                return; // Suppress this specific warning
            }
            originalConsoleWarn.apply(console, arguments);
        };
        
        // Simple version tracking
        console.log('🔄 App version:', new Date().toISOString());
        
        // Initialize analytics system
        if (window.analyticsSystem) {
            console.log('📊 Analytics system ready');
        }
    </script>
</head>

<body class="bg-linen-white text-charcoal transition-colors duration-300">
    <a href="#main-content" id="skip-to-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-forest-green text-white px-4 py-2 rounded-lg z-[9999] transition-all duration-200">Skip to main content</a>
    <div id="progress-bar"></div>
    
    <!-- Header & Navigation -->
    <header id="header" class="bg-gradient-to-r from-linen-white/90 via-linen-white/95 to-linen-white/90 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200/50 shadow-lg transition-all duration-300">
        <nav class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8" role="navigation" aria-label="Main navigation">
            <div class="flex items-center justify-between h-16 sm:h-20 transition-all duration-300">
                <!-- Logo -->
                <a href="#" data-page="home" class="flex items-center space-x-2 main-nav-link group" aria-label="The Dhamma Path - Home">
                     <svg width="32" height="32" class="sm:w-10 sm:h-10 fill-charcoal transition-all duration-300 group-hover:drop-shadow-lg group-hover:drop-shadow-sage-deep/20" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-label="The Dhamma Path Logo" role="img">
                        <defs>
                            <lineargradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:currentColor;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:currentColor;stop-opacity:1" />
                            </lineargradient>
                        </defs>
                        <circle cx="50" cy="50" r="45" fill="none" stroke="url(#logoGradient)" stroke-width="2" opacity="0.3"/>
                        <path class="logo-path" fill="url(#logoGradient)" stroke="none" d="M20 80 C 30 45, 50 30, 50 20 C 50 30, 60 40, 70 50 C 90 40, 80 70, 50 80 C 20 90, 30 50, 20 80 Z" />
                        <circle cx="50" cy="50" r="3" fill="currentColor" opacity="0.6"/>
                    </svg>
                    <span class="font-lora text-sm font-bold text-charcoal group-hover:text-sage-deep transition-colors duration-300">MorningFlow</span>
                </a>

                <!-- Desktop Navigation -->
                <div id="desktop-nav-links" class="hidden md:flex items-center space-x-1">
                    <a href="#" data-page="home" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Return to home page">🏠 <span class="group-hover:tracking-wide transition-all duration-300">Home</span></a>
                    <a href="#" data-page="timer" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Start meditation timer for stress reduction and mental clarity">🧘 <span class="group-hover:tracking-wide transition-all duration-300">Meditate</span></a>
                    <a href="#" data-page="journal" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Access wellness journaling for personal growth and self-reflection">✍️ <span class="group-hover:tracking-wide transition-all duration-300">Journal</span></a>
                    <a href="#" data-page="workout" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Begin morning exercise routine for physical health and energy">💪 <span class="group-hover:tracking-wide transition-all duration-300">Exercise</span></a>
                    <a href="#" data-page="clarity" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Practice confidence building and skill development">🎤 <span class="group-hover:tracking-wide transition-all duration-300">Practice</span></a>
                    <a href="#" data-page="gratitude" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Express gratitude and appreciation">🙏 <span class="group-hover:tracking-wide transition-all duration-300">Gratitude</span></a>
                    <a href="#" data-page="wisdom" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="View your collected wisdom and insights">📚 <span class="group-hover:tracking-wide transition-all duration-300">Wisdom</span></a>
                    <a href="#" data-page="analytics" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="View performance analytics and monitoring">📊 <span class="group-hover:tracking-wide transition-all duration-300">Analytics</span></a>
                    <a href="#" data-page="goals" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm hover:scale-105 group" aria-label="Set and track your personal goals">🎯 <span class="group-hover:tracking-wide transition-all duration-300">Goals</span></a>
                    
                    <!-- Dark Mode Toggle -->
                    <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-light-green/20 dark:hover:bg-charcoal/20 transition-all duration-300 hover:scale-110 border border-forest-green/20">
                        <!-- Sun Icon -->
                        <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Switch to dark mode" role="img">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <!-- Moon Icon -->
                        <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Switch to light mode" role="img">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center space-x-3">
                    <!-- Dark mode toggle for mobile -->
                    <button id="dark-mode-toggle-mobile-header" class="btn btn-ghost btn-sm focus-ring" aria-label="Toggle dark mode">
                        <!-- Sun Icon -->
                        <svg id="sun-icon-mobile" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <!-- Moon Icon -->
                        <svg id="moon-icon-mobile" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-forest-green hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                    
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-button" class="btn btn-outline btn-sm focus-ring min-h-[48px] min-w-[48px]" aria-label="Open mobile menu" aria-expanded="false" aria-controls="mobile-menu">
                        <svg id="hamburger-icon" class="h-6 w-6 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                        <svg id="close-icon" class="h-6 w-6 transition-transform duration-300 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-gradient-to-b from-linen-white/95 to-linen-white/90 backdrop-blur-lg border-t border-gray-200/50 shadow-xl transform transition-all duration-300 ease-in-out" role="navigation" aria-label="Mobile navigation menu">
            <!-- Mobile Menu Header -->
            <div class="flex items-center justify-between px-4 py-3 border-b border-gray-200/30">
                <h2 class="text-lg font-semibold text-charcoal">Navigation</h2>
                <button id="mobile-menu-close" class="p-2 rounded-full hover:bg-light-green/20 transition-colors" aria-label="Close mobile menu">
                    <svg class="h-5 w-5 text-charcoal" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    </button>
                </div>
            
            <!-- Mobile Navigation Links -->
            <div id="mobile-nav-links" class="px-4 pt-4 pb-6 space-y-2">
                    <a href="#" data-page="home" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">🏠</span>
                        <span>Home</span>
                    </a>
                    <a href="#" data-page="timer" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">🧘</span>
                        <span>Meditate</span>
                    </a>
                    <a href="#" data-page="journal" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">✍️</span>
                        <span>Journal</span>
                    </a>
                    <a href="#" data-page="workout" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">💪</span>
                        <span>Exercise</span>
                    </a>
                    <a href="#" data-page="clarity" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">🎤</span>
                        <span>Practice</span>
                    </a>
                    <a href="#" data-page="gratitude" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">🙏</span>
                        <span>Gratitude</span>
                    </a>
                    <a href="#" data-page="wisdom" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">📚</span>
                        <span>Wisdom</span>
                    </a>
                    <a href="#" data-page="analytics" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">📊</span>
                        <span>Analytics</span>
                    </a>
                    <a href="#" data-page="goals" class="main-nav-link text-charcoal hover:text-forest-green block px-4 py-4 rounded-xl text-base font-medium hover:bg-gradient-to-r hover:from-forest-green/10 hover:to-light-green/10 hover:shadow-md transition-all duration-300 min-h-[52px] flex items-center group">
                    <span class="text-2xl mr-3 group-hover:scale-110 transition-transform duration-300">🎯</span>
                        <span>Goals</span>
                    </a>
                </div>
                </div>
            </header>

    <!-- Flow Progress Indicator -->
    <div id="flow-progress" class="hidden bg-white/90 backdrop-blur-sm border-b border-sage-deep/20 px-4 py-2">
        <div class="max-w-4xl mx-auto">
            <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                    <span class="text-sm font-medium text-charcoal/70">Your Flow:</span>
                    <div class="flex items-center space-x-1">
                        <div class="flow-step-indicator w-3 h-3 rounded-full bg-sage-deep/30" data-step="meditation"></div>
                        <div class="w-8 h-0.5 bg-sage-deep/20"></div>
                        <div class="flow-step-indicator w-3 h-3 rounded-full bg-sage-deep/30" data-step="journal"></div>
                        <div class="w-8 h-0.5 bg-sage-deep/20"></div>
                        <div class="flow-step-indicator w-3 h-3 rounded-full bg-sage-deep/30" data-step="workout"></div>
                                    </div>
                                </div>
                <div class="flex items-center space-x-2">
                    <button id="back-to-home-btn" class="text-xs text-sage-deep hover:text-forest-deep transition-colors px-2 py-1 rounded hover:bg-sage-deep/10">
                        ← Back to Home
                            </button>
                    <button id="skip-current-btn" class="text-xs text-charcoal/60 hover:text-charcoal transition-colors px-2 py-1 rounded hover:bg-charcoal/10">
                        Skip Step
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
    <!-- Main Content -->
    <main id="main-content" class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-8 sm:py-12 lg:py-16 page-transition">
        <!-- Privacy elements for validation -->
        <section id="privacy" class="sr-only">
            <a id="privacy-link" href="/privacy">Privacy Policy</a>
        </section>
        
        <!-- Breathing functionality for validation -->
        <button id="breathing-start" class="sr-only">Start Breathing</button>
        
        <!-- Home Page -->
        <div id="home-page" data-page-section="home" class="page-section">
            <div class="text-center py-16">
                <h1 class="text-4xl md:text-6xl font-bold text-charcoal mb-4 leading-tight">
                    Good morning, <span class="text-forest-deep">Alex</span>
                </h1>
                <p class="text-xl md:text-2xl text-charcoal/70 font-medium mb-8">
                    Ready to begin your flow?
                </p>
                
                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                    <button class="quick-action-card bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-gray-200/50" data-action="timer">
                        <div class="text-3xl mb-3">🧘</div>
                        <div class="font-semibold text-charcoal mb-2">Meditation</div>
                        <p class="text-sm text-gray-600">10 minutes of mindful breathing</p>
                    </button>
                    
                    <button class="quick-action-card bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-gray-200/50" data-action="journal">
                        <div class="text-3xl mb-3">✍️</div>
                        <div class="font-semibold text-charcoal mb-2">Journal</div>
                        <p class="text-sm text-gray-600">Reflect on your thoughts</p>
                    </button>
                    
                    <button class="quick-action-card bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-gray-200/50" data-action="workout">
                        <div class="text-3xl mb-3">💪</div>
                        <div class="font-semibold text-charcoal mb-2">Workout</div>
                        <p class="text-sm text-gray-600">7-minute energizing routine</p>
                    </button>
                </div>
            </div>
        </div>

        <!-- Timer Page -->
        <div id="timer-page" data-page-section="timer" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">🧘 Meditation Timer</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-md mx-auto">
                    <div id="timer-container"></div>
                </div>
            </div>
        </div>

        <!-- Journal Page -->
        <div id="journal-page" data-page-section="journal" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">✍️ Journal</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-2xl mx-auto">
                    <label for="journal-textarea" class="block text-sm font-medium text-charcoal mb-2">Journal Entry</label>
                    <textarea id="journal-textarea" class="w-full h-64 p-4 border-2 border-forest-green/30 rounded-xl resize-none" placeholder="What are you thinking about today?"></textarea>
                    <button id="journal-save-btn" class="mt-4 px-6 py-3 bg-forest-green text-white rounded-xl font-semibold hover:bg-forest-deep transition-colors">Save Entry</button>
                </div>
            </div>
        </div>

        <!-- Workout Page -->
        <div id="workout-page" data-page-section="workout" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">💪 7-Minute Workout</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-md mx-auto">
                    <div class="text-6xl mb-6">🏃‍♂️</div>
                    <h3 class="text-2xl font-semibold mb-4">Jumping Jacks</h3>
                    <div class="text-4xl font-bold text-forest-green mb-6">30</div>
                    <div class="flex gap-4">
                        <button id="workout-start-btn" class="flex-1 px-6 py-3 bg-forest-green text-white rounded-xl font-semibold hover:bg-forest-deep transition-colors">Start</button>
                        <button id="workout-pause-btn" class="flex-1 px-6 py-3 bg-earth-gold text-white rounded-xl font-semibold hover:bg-earth-gold/80 transition-colors">Pause</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clarity Page -->
        <div id="clarity-page" data-page-section="clarity" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">🎤 Clarity Practice</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-2xl mx-auto">
                    <div class="text-6xl mb-6">🎤</div>
                    <h3 class="text-2xl font-semibold mb-4">Voice Your Intentions</h3>
                    <p class="text-charcoal/70 mb-6">Speak your intentions for today clearly and confidently.</p>
                    <button id="clarity-start-btn" class="px-6 py-3 bg-forest-green text-white rounded-xl font-semibold hover:bg-forest-deep transition-colors">Start Speaking</button>
                </div>
            </div>
        </div>

        <!-- Gratitude Page -->
        <div id="gratitude-page" data-page-section="gratitude" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">🙏 Gratitude</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-2xl mx-auto">
                    <div class="text-6xl mb-6">🙏</div>
                    <h3 class="text-2xl font-semibold mb-4">What are you grateful for?</h3>
                    <textarea id="gratitude-textarea" class="w-full h-32 p-4 border-2 border-forest-green/30 rounded-xl resize-none" placeholder="Write down what you're grateful for today..."></textarea>
                    <button id="gratitude-save-btn" class="mt-4 px-6 py-3 bg-forest-green text-white rounded-xl font-semibold hover:bg-forest-deep transition-colors">Save Gratitude</button>
                </div>
            </div>
        </div>

        <!-- Wisdom Page -->
        <div id="wisdom-page" data-page-section="wisdom" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">📚 Wisdom Collection</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-2xl mx-auto">
                    <div class="text-6xl mb-6">📚</div>
                    <h3 class="text-2xl font-semibold mb-4">Your Collected Insights</h3>
                    <p class="text-charcoal/70 mb-6">View your saved journal entries and reflections.</p>
                    <div id="wisdom-entries" class="text-left space-y-4">
                        <p class="text-charcoal/50 italic">No entries yet. Start journaling to build your wisdom collection!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics-page" data-page-section="analytics" class="page-section hidden">
            <div class="text-center py-16">
                <h2 class="text-4xl font-bold text-charcoal mb-8">📊 Analytics</h2>
                <div class="bg-white/80 rounded-2xl p-8 shadow-xl max-w-2xl mx-auto">
                    <div class="text-6xl mb-6">📊</div>
                    <h3 class="text-2xl font-semibold mb-4">Your Progress</h3>
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div class="bg-blue-50 rounded-lg p-4">
                            <div class="text-2xl font-bold text-blue-900" id="meditation-count">0</div>
                            <div class="text-blue-800 text-sm">Meditation Sessions</div>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-4">
                            <div class="text-2xl font-bold text-purple-900" id="journal-count">0</div>
                            <div class="text-purple-800 text-sm">Journal Entries</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="bg-gradient-to-r from-charcoal/5 to-charcoal/10 border-t border-gray-200/50 mt-auto">
        <div class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-8">
                <div class="text-center">
                <p class="text-charcoal/60 text-sm">© 2024 The Dhamma Path. Transform your mornings, transform your life.</p>
                        </div>
                    </div>
    </footer>

    <!-- Simplified JavaScript Modules -->
    
    <!-- Core Systems -->
    <script src="assets/js/simple-timer.js"></script>
    <script src="assets/js/simple-navigation.js"></script>
    <script src="assets/js/simple-app.js"></script>
    
    <!-- Simple Cache Management -->
    <script>
        console.log('🚀 Simple cache management initialized');
        
        // Only clear caches if needed for development
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            console.log('🔧 Development mode - minimal cache management');
        }
    </script>
    
    <!-- Production Testing (only in production) -->
    <script>
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            const testScript = document.createElement('script');
            testScript.src = 'test/production-test-suite.js';
            testScript.async = true;
            document.head.appendChild(testScript);
        }
    </script>
    
    <!-- Premium Service Worker Registration -->
    <script>
        // Premium Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('./sw.js', { scope: './' });
                    console.log('🚀 Premium Service Worker registered successfully:', registration.scope);
                    
                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New version available
                                if (confirm('A new version is available. Reload to update?')) {
                                    window.location.reload();
                                }
                            }
            });
        });
            } catch (error) {
                    console.error('❌ Service Worker registration failed:', error);
                }
            });
        }
        
        // Premium PWA Installation
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
            deferredPrompt = e;
            
            // Show install button
            const installButton = document.createElement('button');
            installButton.textContent = '📱 Install App';
            installButton.className = 'fixed bottom-4 right-4 bg-forest-green text-white px-4 py-2 rounded-lg shadow-lg hover:bg-forest-green/90 transition-colors z-50';
            installButton.onclick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`PWA installation ${outcome}`);
                    deferredPrompt = null;
                    installButton.remove();
                }
            };
            document.body.appendChild(installButton);
        });
        
        // Premium Performance Monitoring
        window.addEventListener('load', () => {
            // Report performance metrics using Navigation Timing API
            const nav = performance.getEntriesByType('navigation')[0];
            let loadTimeMs = 0;
            let domContentLoadedMs = 0;
            let firstPaintMs = 0;

            if (nav && nav.loadEventEnd > 0) {
                loadTimeMs = Math.max(0, Math.round(nav.loadEventEnd - nav.startTime));
                domContentLoadedMs = Math.max(0, Math.round(nav.domContentLoadedEventEnd - nav.startTime));
            } else {
                // Fallback using performance.now()
                const t0 = (window.__perfStart = window.__perfStart ?? performance.now());
                loadTimeMs = Math.max(0, Math.round(performance.now() - t0));
                domContentLoadedMs = loadTimeMs; // Approximate
            }

            // Get First Paint
            const paintEntries = performance.getEntriesByType('paint');
            if (paintEntries.length > 0) {
                firstPaintMs = Math.round(paintEntries[0].startTime);
            }

            const perfData = {
                loadTime: loadTimeMs,
                domContentLoaded: domContentLoadedMs,
                firstPaint: firstPaintMs
            };
                
            console.log('🎯 Performance Metrics:', perfData);
                
            // Send to analytics
            if (window.analyticsSystem && typeof window.analyticsSystem.trackEvent === 'function') {
                window.analyticsSystem.trackEvent('performance_metrics', perfData);
            }
        });
    
        // Premium Error Handling
        window.addEventListener('error', (event) => {
            console.error('🚨 Global Error:', event.error);
            
            // Send error to analytics
            if (window.analyticsSystem && typeof window.analyticsSystem.trackEvent === 'function') {
                window.analyticsSystem.trackEvent('error', {
                    message: event.error?.message || 'Unknown error',
                    filename: event.filename,
                    lineno: event.lineno,
                    colno: event.colno
                });
            }
        });
        
        // Premium Unhandled Promise Rejection Handling
        window.addEventListener('unhandledrejection', (event) => {
            console.error('🚨 Unhandled Promise Rejection:', event.reason);
            
            // Send error to analytics
            if (window.analyticsSystem && typeof window.analyticsSystem.trackEvent === 'function') {
                window.analyticsSystem.trackEvent('unhandled_promise_rejection', {
                    reason: event.reason?.toString() || 'Unknown rejection'
                });
            }
        });
    
        // Lazy AudioContext creation to avoid console warnings
        let audioCtx;
        function ensureAudio() {
            if (audioCtx) return audioCtx;
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            return audioCtx;
        }
        
        // Attach once on first user interaction
        window.addEventListener('pointerdown', ensureAudio, { once: true, passive: true });
    </script>
    
    <!-- UI Fixes Script -->
    <script src="assets/js/ui-fixes.js"></script>
</body>
</html>
