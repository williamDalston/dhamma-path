<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary SEO Meta Tags -->
    <title>The Dhamma Path - Transform Your Mornings, Transform Your Life</title>
    <meta name="title" content="The Dhamma Path - Transform Your Mornings, Transform Your Life">
    <meta name="description" content="Build a powerful morning routine with meditation, journaling, exercise, and confidence practice. Start each day with purpose and transform your life through mindful habits and timeless wisdom.">
    <meta name="keywords" content="morning routine, meditation timer, mindful journaling, 7-minute workout, confidence practice, Buddhist wisdom, mindfulness, self-help, personal development, daily habits, meditation, journaling, exercise, video practice">
    <meta name="author" content="Will Alston">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://thedhammapath.com/">
    <meta property="og:title" content="The Dhamma Path - Transform Your Mornings, Transform Your Life">
    <meta property="og:description" content="Build a powerful morning routine with meditation, journaling, exercise, and confidence practice. Start each day with purpose and transform your life through mindful habits and timeless wisdom.">
    <meta property="og:image" content="https://thedhammapath.com/og-image.jpg">
    <meta property="og:site_name" content="The Dhamma Path">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://thedhammapath.com/">
    <meta property="twitter:title" content="The Dhamma Path - Transform Your Mornings, Transform Your Life">
    <meta property="twitter:description" content="Build a powerful morning routine with meditation, journaling, exercise, and confidence practice. Start each day with purpose and transform your life through mindful habits and timeless wisdom.">
    <meta property="twitter:image" content="https://thedhammapath.com/og-image.jpg">
    <meta property="twitter:creator" content="@thedhammapath">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#4A6C55">
    <meta name="msapplication-TileColor" content="#4A6C55">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="The Dhamma Path">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://thedhammapath.com/">
    
    <!-- Sitemap -->
    <link rel="sitemap" type="application/xml" href="/sitemap.xml">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    <!-- Additional SEO Links -->
    <link rel="alternate" type="application/rss+xml" title="The Dhamma Path RSS Feed" href="/rss.xml">
    
    <!-- Performance Hints -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400;0,500;0,700;1,400;1,500&display=swap" as="style">
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">

    <!-- Fonts - Optimized loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400;0,500;0,700;1,400;1,500&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400;0,500;0,700;1,400;1,500&display=swap" rel="stylesheet"></noscript>
    
    <!-- Tailwind CSS -->
    <!-- Note: CDN is used for development/personal use. For production, consider using Tailwind CLI -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "The Dhamma Path",
        "description": "Build a powerful morning routine with meditation, journaling, exercise, and confidence practice. Start each day with purpose and transform your life through mindful habits and timeless wisdom.",
        "url": "https://thedhammapath.com",
        "applicationCategory": "HealthApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Person",
            "name": "Will Alston"
        },
        "featureList": [
            "Meditation Timer",
            "Mindful Journaling",
            "7-Minute Workout",
            "Confidence Practice",
            "Progress Tracking",
            "Buddhist Wisdom"
        ],
        "screenshot": "https://thedhammapath.com/screenshot.jpg",
        "softwareVersion": "1.0",
        "datePublished": "2025-01-01",
        "dateModified": "2025-01-01",
        "inLanguage": "en-US",
        "isAccessibleForFree": true,
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareHelp": "https://thedhammapath.com/about"
    }
    </script>

    <!-- Additional Structured Data for Features -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": "Morning Routine Features",
        "description": "Essential tools for building a powerful morning routine",
        "itemListElement": [
            {
                "@type": "SoftwareApplication",
                "position": 1,
                "name": "Meditation Timer",
                "description": "5-30 minute guided meditation sessions with customizable bells and progress tracking",
                "applicationCategory": "HealthApplication",
                "operatingSystem": "Web Browser"
            },
            {
                "@type": "SoftwareApplication", 
                "position": 2,
                "name": "Mindful Journal",
                "description": "Freewriting practice with auto-save and flexible timing options for self-reflection",
                "applicationCategory": "HealthApplication",
                "operatingSystem": "Web Browser"
            },
            {
                "@type": "SoftwareApplication",
                "position": 3, 
                "name": "7-Minute Workout",
                "description": "High-intensity circuit training with visual guides and progress tracking",
                "applicationCategory": "HealthApplication",
                "operatingSystem": "Web Browser"
            },
            {
                "@type": "SoftwareApplication",
                "position": 4,
                "name": "Confidence Practice", 
                "description": "Video practice for storytelling, communication, and speaking confidence",
                "applicationCategory": "HealthApplication",
                "operatingSystem": "Web Browser"
            }
        ]
    }
    </script>

    <!-- Critical CSS - Above the fold styles -->
    <style>
        /* Critical styles for immediate rendering */
        body { margin: 0; font-family: 'Inter', sans-serif; }
        .loading { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>

    <!-- Custom Styles and Dark Mode Logic -->
    <style>
        :root {
            --linen-white: #FDFBF5;
            --charcoal: #333333;
            --forest-green: #4A6C55;
            --earthy-gold: #B98B4C;
            --light-gold: #EADDC7;
            --light-green: #E4EAE6;
            --gradient-primary: linear-gradient(135deg, #4A6C55 0%, #6B8E6B 100%);
            --gradient-secondary: linear-gradient(135deg, #B98B4C 0%, #D4A574 100%);
            --shadow-soft: 0 4px 20px rgba(74, 108, 85, 0.1);
            --shadow-hover: 0 8px 30px rgba(74, 108, 85, 0.15);
            --text-gradient: linear-gradient(135deg, var(--forest-green), var(--earthy-gold));
            --breathing-gradient: linear-gradient(135deg, var(--linen-white), var(--light-green), var(--linen-white));
            --ripple-color: rgba(228, 234, 230, 0.3);
        }

        /* Light Mode */
        html {
            background-color: var(--linen-white);
            color: var(--charcoal);
        }

        /* Dark Mode */
        html.dark {
            background-color: #1a1a1a;
            color: #d1d1d1;
        }
        
        html.dark .bg-linen-white { background-color: #1a1a1a; }
        html.dark .text-charcoal { color: #d1d1d1; }
        html.dark .text-forest-green { color: #86b596; }
        html.dark .text-earthy-gold { color: #dcb981; }
        html.dark .border-earthy-gold { border-color: #dcb981; }
        html.dark .bg-light-gold { background-color: #3a3021; }
        html.dark .bg-light-green { background-color: #2c3a32; }
        html.dark .bg-charcoal { background-color: #111; }
        html.dark .fill-charcoal { fill: #d1d1d1; }
        html.dark nav, html.dark footer {
             background-color: #111;
             border-color: #444;
        }
        html.dark .hover\:bg-gray-100:hover {
            background-color: #333;
        }
         html.dark .logo-path {
            stroke: var(--linen-white);
        }
        html.dark .prose-p\:text-charcoal\/80 p { color: #d1d1d1; }
        html.dark .border-black\/5 { border-color: #ffffff1a; }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            font-size: 18px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        /* Performance optimizations */
        * {
            box-sizing: border-box;
        }
        
        .stagger-in {
            animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
            transform: translateY(30px);
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Floating animation for background elements */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }
        
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        .float-animation:nth-child(2) {
            animation-delay: -2s;
            animation-duration: 8s;
        }
        
        .float-animation:nth-child(3) {
            animation-delay: -4s;
            animation-duration: 7s;
        }
        
        /* Pulse animation for progress bars */
        @keyframes progressPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0); }
        }
        
        .progress-pulse {
            animation: progressPulse 2s ease-in-out infinite;
        }
        
        /* Gentle bounce for cards */
        @keyframes gentleBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }
        
        .gentle-bounce:hover {
            animation: gentleBounce 0.6s ease-in-out;
        }
        
        /* Shimmer effect for progress bars */
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }
        
        /* Breathing animation for meditation elements */
        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .breathe {
            animation: breathe 4s ease-in-out infinite;
        }
        
        /* Typewriter effect */
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        
        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            animation: typewriter 2s steps(40, end);
        }
        
        /* Gentle rotation for icons */
        @keyframes gentleRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .gentle-rotate {
            animation: gentleRotate 20s linear infinite;
        }
        
        /* Fade in from left */
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }
        
        /* Fade in from right */
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }
        
        /* Page transition animations */
        @keyframes pageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .page-transition {
            animation: pageSlideIn 0.6s ease-out;
        }
        
        /* Loading spinner animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        
        /* Pulse animation for active elements */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }
        
        /* Gentle wiggle for attention */
        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-2deg); }
            75% { transform: rotate(2deg); }
        }
        
        .wiggle {
            animation: wiggle 0.5s ease-in-out;
        }
        
        /* Fade in with scale */
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .fade-in-scale {
            animation: fadeInScale 0.5s ease-out;
        }
        
        /* Stagger animation for lists */
        .stagger-list > * {
            animation: fadeInUp 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .stagger-list > *:nth-child(1) { animation-delay: 0.1s; }
        .stagger-list > *:nth-child(2) { animation-delay: 0.2s; }
        .stagger-list > *:nth-child(3) { animation-delay: 0.3s; }
        .stagger-list > *:nth-child(4) { animation-delay: 0.4s; }
        .stagger-list > *:nth-child(5) { animation-delay: 0.5s; }
        .stagger-list > *:nth-child(6) { animation-delay: 0.6s; }
        .stagger-list > *:nth-child(7) { animation-delay: 0.7s; }
        .stagger-list > *:nth-child(8) { animation-delay: 0.8s; }

        /* 🌅 Background & Section Accents */
        .soft-gradient-bg {
            background: linear-gradient(to bottom, var(--linen-white), var(--light-green));
        }
        
        .radial-spotlight {
            background: radial-gradient(ellipse at center, rgba(184, 139, 76, 0.1) 0%, transparent 70%);
        }

        /* ✨ Text Enhancements */
        .text-gradient {
            background: var(--text-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .text-glow {
            text-shadow: 0 0 20px rgba(74, 108, 85, 0.3);
        }
        
        .text-glow-dark {
            text-shadow: 0 0 15px rgba(228, 234, 230, 0.2);
        }

        /* 🌿 Interactive Elements */
        .hover-soft {
            transition: background 0.3s ease, transform 0.2s ease;
        }
        
        .hover-soft:hover {
            background: var(--light-green);
            transform: translateY(-1px);
        }
        
        .gradient-underline {
            position: relative;
            text-decoration: none;
        }
        
        .gradient-underline::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 0;
            background: var(--text-gradient);
            transition: width 0.3s ease;
            pointer-events: none;
        }
        
        .gradient-underline:hover::after {
            width: 100%;
        }

        /* Ripple Effect */
        .ripple {
            position: relative;
            overflow: hidden;
        }
        
        .ripple::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--ripple-color);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            pointer-events: none;
        }
        
        .ripple:active::before {
            width: 300px;
            height: 300px;
        }

        /* 🌌 Section Dividers */
        .shimmer-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--earthy-gold), transparent);
            position: relative;
            overflow: hidden;
        }
        
        .shimmer-divider::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(184, 139, 76, 0.5), transparent);
            animation: shimmer-sweep 3s infinite;
            pointer-events: none;
        }
        
        @keyframes shimmer-sweep {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* 🌸 Ambient Motion */
        .breathing-bg {
            background: var(--breathing-gradient);
            background-size: 200% 200%;
            animation: breathe-bg 20s ease-in-out infinite;
        }
        
        @keyframes breathe-bg {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .floating-particles {
            position: relative;
            overflow: hidden;
        }
        
        .floating-particles::before,
        .floating-particles::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(184, 139, 76, 0.3);
            border-radius: 50%;
            animation: float-particle 15s infinite linear;
        }
        
        .floating-particles::before {
            left: 10%;
            animation-delay: 0s;
        }
        
        .floating-particles::after {
            left: 80%;
            animation-delay: -7s;
        }
        
        @keyframes float-particle {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(20px);
                opacity: 0;
            }
        }

        /* 🌸 Additional Subtle Enhancements */
        
        /* Micro-interactions */
        .focus-grow:focus {
            transform: scale(1.02);
            transition: transform 0.2s ease;
        }
        
        .card-breathe {
            animation: cardBreathe 8s ease-in-out infinite;
        }
        
        @keyframes cardBreathe {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.95; transform: scale(1.01); }
        }
        
        .icon-breathe {
            animation: iconBreathe 6s ease-in-out infinite;
        }
        
        @keyframes iconBreathe {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        /* Enhanced focus states */
        .focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 108, 85, 0.3);
            transition: box-shadow 0.2s ease;
        }
        
        /* Glass morphism effect */
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Gentle parallax */
        .parallax-slow {
            transform: translateY(0);
            transition: transform 0.1s ease-out;
        }
        
        /* Time-based subtle theming */
        .morning-theme {
            --accent-warmth: rgba(184, 139, 76, 0.1);
        }
        
        .evening-theme {
            --accent-warmth: rgba(74, 108, 85, 0.1);
        }
        
        /* Zen garden particles */
        .zen-particles::before,
        .zen-particles::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(184, 139, 76, 0.4);
            border-radius: 50%;
            animation: zenFloat 12s infinite linear;
        }
        
        .zen-particles::before {
            left: 20%;
            animation-delay: 0s;
        }
        
        .zen-particles::after {
            left: 70%;
            animation-delay: -6s;
        }
        
        @keyframes zenFloat {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-50px) translateX(30px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Subtle loading states */
        .loading-pulse {
            animation: loadingPulse 2s ease-in-out infinite;
        }
        
        @keyframes loadingPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Enhanced button states */
        .btn-zen {
            position: relative;
            overflow: hidden;
        }
        
        .btn-zen::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
            pointer-events: none;
        }
        
        .btn-zen:hover::before {
            left: 100%;
        }
        
        /* Ambient Motion Effects */
        .ambient-breathe {
            animation: ambientBreathe 8s ease-in-out infinite;
        }
        
        .ambient-float {
            animation: ambientFloat 12s ease-in-out infinite;
        }
        
        .ambient-gradient {
            background: linear-gradient(-45deg, #f0f8f0, #e8f5e8, #f5f0e8, #f0f8f0);
            background-size: 400% 400%;
            animation: ambientGradient 20s ease infinite;
        }
        
        .ambient-shadow {
            animation: ambientShadow 6s ease-in-out infinite;
        }
        
        .floating-particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 15s linear infinite;
        }
        
        .particle-1 { width: 6px; height: 6px; background: rgba(45, 80, 22, 0.3); box-shadow: 0 0 8px rgba(45, 80, 22, 0.5); }
        .particle-2 { width: 8px; height: 8px; background: rgba(184, 134, 11, 0.25); box-shadow: 0 0 10px rgba(184, 134, 11, 0.4); }
        .particle-3 { width: 5px; height: 5px; background: rgba(212, 237, 218, 0.4); box-shadow: 0 0 6px rgba(212, 237, 218, 0.6); }
        .particle-4 { width: 7px; height: 7px; background: rgba(45, 80, 22, 0.2); box-shadow: 0 0 9px rgba(45, 80, 22, 0.4); }
        .particle-5 { width: 6px; height: 6px; background: rgba(184, 134, 11, 0.3); box-shadow: 0 0 8px rgba(184, 134, 11, 0.5); }
        
        @keyframes ambientBreathe {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.02); opacity: 1; }
        }
        
        @keyframes ambientFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(1deg); }
            50% { transform: translateY(-5px) rotate(-1deg); }
            75% { transform: translateY(-15px) rotate(0.5deg); }
        }
        
        @keyframes ambientGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes ambientShadow {
            0%, 100% { 
                box-shadow: 0 10px 25px rgba(45, 80, 22, 0.1), 0 4px 10px rgba(0, 0, 0, 0.05);
            }
            50% { 
                box-shadow: 0 15px 35px rgba(45, 80, 22, 0.15), 0 6px 15px rgba(0, 0, 0, 0.08);
            }
        }
        
        @keyframes particleFloat {
            0% { 
                transform: translateY(100vh) translateX(0px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-100px) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Enhanced breathing for existing elements */
        .enhanced-breathe {
            animation: enhancedBreathe 6s ease-in-out infinite;
        }
        
        @keyframes enhancedBreathe {
            0%, 100% { 
                transform: scale(1) translateY(0px);
                filter: brightness(1);
            }
            50% { 
                transform: scale(1.01) translateY(-2px);
                filter: brightness(1.02);
            }
        }
        
        /* Gentle card breathing */
        .card-breathe-gentle {
            animation: cardBreatheGentle 8s ease-in-out infinite;
        }
        
        @keyframes cardBreatheGentle {
            0%, 100% { 
                transform: translateY(0px);
                box-shadow: 0 10px 25px rgba(45, 80, 22, 0.1);
            }
            50% { 
                transform: translateY(-1px);
                box-shadow: 0 12px 30px rgba(45, 80, 22, 0.12);
            }
        }
        
        /* Typography Enhancements */
        
        /* Beautiful Text Selection Styling */
        ::selection {
            background: linear-gradient(135deg, rgba(45, 80, 22, 0.2), rgba(184, 134, 11, 0.2));
            color: #2d5016;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        }
        
        ::-moz-selection {
            background: linear-gradient(135deg, rgba(45, 80, 22, 0.2), rgba(184, 134, 11, 0.2));
            color: #2d5016;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        }
        
        /* Smooth Text Transitions */
        .text-smooth-transition {
            transition: color 0.3s ease, text-shadow 0.3s ease, transform 0.3s ease;
        }
        
        .text-smooth-transition:hover {
            color: #2d5016;
            text-shadow: 0 2px 4px rgba(45, 80, 22, 0.1);
            transform: translateY(-1px);
        }
        
        /* Enhanced Typography Hierarchy */
        .text-hierarchy-1 {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1.1;
            letter-spacing: -0.02em;
            margin-bottom: 1.5rem;
        }
        
        .text-hierarchy-2 {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.01em;
            margin-bottom: 1.25rem;
        }
        
        .text-hierarchy-3 {
            font-size: 1.875rem;
            font-weight: 600;
            line-height: 1.3;
            letter-spacing: 0;
            margin-bottom: 1rem;
        }
        
        .text-hierarchy-4 {
            font-size: 1.5rem;
            font-weight: 600;
            line-height: 1.4;
            letter-spacing: 0;
            margin-bottom: 0.875rem;
        }
        
        .text-hierarchy-5 {
            font-size: 1.25rem;
            font-weight: 500;
            line-height: 1.5;
            letter-spacing: 0;
            margin-bottom: 0.75rem;
        }
        
        .text-body-large {
            font-size: 1.125rem;
            font-weight: 400;
            line-height: 1.7;
            letter-spacing: 0.01em;
        }
        
        .text-body {
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.6;
            letter-spacing: 0.01em;
        }
        
        .text-body-small {
            font-size: 0.875rem;
            font-weight: 400;
            line-height: 1.5;
            letter-spacing: 0.02em;
        }
        
        /* Reading Progress Indicator */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #2d5016, #b8860b, #d4edda);
            z-index: 1000;
            transition: width 0.3s ease;
            box-shadow: 0 2px 4px rgba(45, 80, 22, 0.2);
        }
        
        /* Enhanced Text Effects */
        .text-glow-subtle {
            text-shadow: 0 0 20px rgba(45, 80, 22, 0.1);
        }
        
        .text-glow-medium {
            text-shadow: 0 0 30px rgba(45, 80, 22, 0.15);
        }
        
        .text-glow-strong {
            text-shadow: 0 0 40px rgba(45, 80, 22, 0.2);
        }
        
        /* Smooth Color Transitions for Links */
        .link-smooth {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .link-smooth:hover {
            color: #2d5016;
            transform: translateY(-1px);
        }
        
        .link-smooth::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #2d5016, #b8860b);
            transition: width 0.3s ease;
        }
        
        .link-smooth:hover::after {
            width: 100%;
        }
        
        /* Enhanced Paragraph Spacing */
        .paragraph-spacing {
            margin-bottom: 1.5rem;
        }
        
        .paragraph-spacing:last-child {
            margin-bottom: 0;
        }
        
        /* Typography Focus States */
        .text-focus {
            transition: all 0.2s ease;
        }
        
        .text-focus:focus {
            outline: none;
            color: #2d5016;
            text-shadow: 0 0 8px rgba(45, 80, 22, 0.2);
        }
        
        /* Reading Flow Enhancements */
        .reading-flow {
            max-width: 65ch;
            margin: 0 auto;
        }
        
        .reading-flow h1,
        .reading-flow h2,
        .reading-flow h3,
        .reading-flow h4,
        .reading-flow h5,
        .reading-flow h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        
        .reading-flow p {
            margin-bottom: 1.25rem;
        }
        
        .reading-flow ul,
        .reading-flow ol {
            margin-bottom: 1.25rem;
            padding-left: 1.5rem;
        }
        
        .reading-flow li {
            margin-bottom: 0.5rem;
        }
        
        /* Enhanced Quote Styling */
        .quote-enhanced {
            position: relative;
            padding: 2rem;
            margin: 2rem 0;
            background: linear-gradient(135deg, rgba(45, 80, 22, 0.05), rgba(184, 134, 11, 0.05));
            border-left: 4px solid #2d5016;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            font-size: 1.125rem;
            line-height: 1.7;
        }
        
        .quote-enhanced::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 20px;
            font-size: 4rem;
            color: rgba(45, 80, 22, 0.2);
            font-family: serif;
        }
        
        /* Micro-Interactions & Feedback */
        
        /* Button Press Animations */
        .btn-press {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .btn-press:active {
            transform: translateY(2px) scale(0.98);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-press:active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            animation: pressRipple 0.3s ease-out;
        }
        
        @keyframes pressRipple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 0;
            }
        }
        
        /* Enhanced Form Focus States */
        .form-focus {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .form-focus:focus {
            outline: none;
            border-color: #2d5016;
            box-shadow: 0 0 0 3px rgba(45, 80, 22, 0.1), 0 0 0 6px rgba(45, 80, 22, 0.05);
            transform: translateY(-1px);
        }
        
        .form-focus:focus::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 2px solid transparent;
            border-radius: inherit;
            background: linear-gradient(45deg, #2d5016, #b8860b) border-box;
            mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            animation: focusPulse 2s ease-in-out infinite;
        }
        
        @keyframes focusPulse {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.8;
            }
        }
        
        /* Skeleton Loading States */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s infinite;
            border-radius: 4px;
        }
        
        .skeleton-text {
            height: 1em;
            margin-bottom: 0.5rem;
        }
        
        .skeleton-text:last-child {
            margin-bottom: 0;
        }
        
        .skeleton-text.w-3\/4 {
            width: 75%;
        }
        
        .skeleton-text.w-1\/2 {
            width: 50%;
        }
        
        .skeleton-text.w-1\/4 {
            width: 25%;
        }
        
        .skeleton-card {
            padding: 1.5rem;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        @keyframes skeletonLoading {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        /* Success/Error Feedback */
        .feedback-success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border: 1px solid #c3e6cb;
            color: #155724;
            animation: feedbackSlideIn 0.4s ease-out;
        }
        
        .feedback-error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border: 1px solid #f5c6cb;
            color: #721c24;
            animation: feedbackSlideIn 0.4s ease-out;
        }
        
        .feedback-info {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            border: 1px solid #bee5eb;
            color: #0c5460;
            animation: feedbackSlideIn 0.4s ease-out;
        }
        
        @keyframes feedbackSlideIn {
            0% {
                transform: translateY(-20px);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* Button State Feedback */
        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            animation: successPulse 0.6s ease-out;
        }
        
        .btn-error {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            color: white;
            animation: errorShake 0.6s ease-out;
        }
        
        @keyframes successPulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        
        @keyframes errorShake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-5px);
            }
            75% {
                transform: translateX(5px);
            }
        }
        
        /* Loading Spinner Enhancements */
        .loading-spinner-enhanced {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2d5016;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            position: relative;
        }
        
        .loading-spinner-enhanced::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top: 2px solid #b8860b;
            border-radius: 50%;
            animation: spin 0.5s linear infinite reverse;
        }
        
        /* Progress Indicators */
        .progress-indicator {
            position: relative;
            overflow: hidden;
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
        }
        
        .progress-indicator::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progressShimmer 2s infinite;
        }
        
        @keyframes progressShimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: toastSlideIn 0.3s ease-out;
            max-width: 300px;
        }
        
        .toast-success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .toast-error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border-left: 4px solid #dc3545;
            color: #721c24;
        }
        
        .toast-info {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        
        @keyframes toastSlideIn {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Hover State Enhancements */
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .hover-glow {
            transition: all 0.3s ease;
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(45, 80, 22, 0.3);
        }
        
        /* Scroll-Based Animations */
        
        /* Parallax Elements */
        .parallax-slow {
            transform: translateZ(0);
            will-change: transform;
        }
        
        .parallax-medium {
            transform: translateZ(0);
            will-change: transform;
        }
        
        .parallax-fast {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /* Fade-in on Scroll */
        .fade-in-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in-scroll.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .fade-in-scroll-left {
            opacity: 0;
            transform: translateX(-30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in-scroll-left.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .fade-in-scroll-right {
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in-scroll-right.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .fade-in-scroll-scale {
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in-scroll-scale.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Sticky Elements */
        .sticky-element {
            position: sticky;
            top: 20px;
            z-index: 10;
            transition: all 0.3s ease;
        }
        
        .sticky-element.sticky {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 1rem;
        }
        
        /* Interactive Elements */
        
        /* Enhanced Ripple Effects */
        .ripple-enhanced {
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .ripple-enhanced::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            pointer-events: none;
        }
        
        .ripple-enhanced:active::before {
            width: 300px;
            height: 300px;
        }
        
        /* Card Lift Effects */
        .card-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .card-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .card-lift:active {
            transform: translateY(-4px) scale(1.01);
        }
        
        /* Animated Link Underlines */
        .link-underline {
            position: relative;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .link-underline::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #2d5016, #b8860b);
            transition: width 0.3s ease;
        }
        
        .link-underline:hover::after {
            width: 100%;
        }
        
        .link-underline-draw {
            position: relative;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .link-underline-draw::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #2d5016, #b8860b);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: left;
        }
        
        .link-underline-draw:hover::after {
            width: 100%;
        }
        
        /* Performance & Polish */
        
        /* Smooth Transitions */
        .smooth-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .smooth-transition-fast {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .smooth-transition-slow {
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Lazy Loading */
        .lazy-load {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .lazy-load.loaded {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Error Boundaries */
        .error-boundary {
            padding: 2rem;
            text-align: center;
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            color: #721c24;
        }
        
        .error-boundary h3 {
            color: #721c24;
            margin-bottom: 1rem;
        }
        
        .error-boundary button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .error-boundary button:hover {
            background: #c82333;
        }
        
        
        /* Loading States */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s infinite;
            border-radius: 4px;
        }
        
        .loading-skeleton-text {
            height: 1em;
            margin-bottom: 0.5rem;
        }
        
        .loading-skeleton-text:last-child {
            margin-bottom: 0;
        }
        
        .skeleton-card {
            background: linear-gradient(90deg, #f8f9fa 25%, #e9ecef 50%, #f8f9fa 75%);
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s infinite;
            border-radius: 0.5rem;
            height: 200px;
        }
        
        .skeleton-button {
            background: linear-gradient(90deg, #e9ecef 25%, #dee2e6 50%, #e9ecef 75%);
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s infinite;
            border-radius: 0.375rem;
            height: 2.5rem;
            width: 120px;
        }
        
        /* Scroll Progress Bar */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #2d5016, #b8860b, #d4edda);
            z-index: 1000;
            transition: width 0.3s ease;
        }
        
        /* Intersection Observer Classes */
        .observe-fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .observe-fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .observe-slide-left {
            opacity: 0;
            transform: translateX(-50px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .observe-slide-left.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .observe-slide-right {
            opacity: 0;
            transform: translateX(50px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .observe-slide-right.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .observe-scale {
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .observe-scale.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Ripple Effect */
        .ripple-effect {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        /* Screen reader only class */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        /* Respect reduced motion */
        @media (prefers-reduced-motion: reduce) {
            .breathing-bg,
            .card-breathe,
            .icon-breathe,
            .float-animation,
            .zen-particles::before,
            .zen-particles::after,
            .ambient-breathe,
            .ambient-float,
            .ambient-gradient,
            .ambient-shadow,
            .floating-particle,
            .enhanced-breathe,
            .card-breathe-gentle,
            .btn-press:active,
            .form-focus:focus::after,
            .skeleton,
            .feedback-success,
            .feedback-error,
            .feedback-info,
            .btn-success,
            .btn-error,
            .loading-spinner-enhanced,
            .progress-indicator::before,
            .toast,
            .parallax-slow,
            .parallax-medium,
            .parallax-fast,
            .fade-in-scroll,
            .fade-in-scroll-left,
            .fade-in-scroll-right,
            .fade-in-scroll-scale,
            .ripple-enhanced::before,
            .card-lift,
            .link-underline::after,
            .link-underline-draw::after,
            .loading-skeleton,
            .observe-fade-in,
            .observe-slide-left,
            .observe-slide-right,
            .observe-scale {
                animation: none !important;
                transform: none !important;
                transition: none !important;
            }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
            transform: translateX(-30px);
        }
        
        @keyframes slideInLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .slide-in-right {
            animation: slideInRight 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
            transform: translateX(30px);
        }
        
        @keyframes slideInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Workout specific animations */
        .workout-pulse {
            animation: workoutPulse 2s ease-in-out infinite;
        }
        
        @keyframes workoutPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .workout-bounce {
            animation: workoutBounce 1s ease-in-out infinite;
        }
        
        @keyframes workoutBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .workout-shake {
            animation: workoutShake 0.5s ease-in-out;
        }
        
        @keyframes workoutShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Smooth scrolling for better UX */
        html {
            scroll-behavior: smooth;
        }
        
        body.fullscreen-active #header, body.fullscreen-active footer { display: none; }
        body.fullscreen-active #main-content { padding-top: 2rem; padding-bottom: 2rem; height: 100vh; }


        h1, h2, h3, h4, h5, h6, .font-lora {
            font-family: 'Lora', serif;
        }
        
        /* Global Enhancements */
        .btn-primary { 
            @apply px-6 py-3 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105;
            background: var(--gradient-primary);
            box-shadow: var(--shadow-soft);
            display: inline-block !important;
            visibility: visible !important;
        }
        
        /* Ensure all start buttons are visible */
        #timer-start-btn, #journal-start-btn, #workout-start-btn, #start-recording-btn {
            background-color: #2d5016 !important;
            color: white !important;
            display: inline-block !important;
            visibility: visible !important;
            border: 2px solid #2d5016 !important;
            font-weight: bold !important;
        }
        
        #timer-start-btn:hover, #journal-start-btn:hover, #workout-start-btn:hover, #start-recording-btn:hover {
            background-color: #1a3009 !important;
            border-color: #1a3009 !important;
        }
        .btn-primary:hover {
            box-shadow: var(--shadow-hover);
        }
        .btn-secondary { 
            @apply px-6 py-3 bg-transparent border-2 border-earthy-gold text-earthy-gold font-semibold rounded-lg transition-all duration-300 transform hover:scale-105;
            background: linear-gradient(135deg, transparent 0%, rgba(185, 139, 76, 0.05) 100%);
        }
        .btn-secondary:hover {
            background: var(--gradient-secondary);
            color: white;
            border-color: transparent;
        }
        
        .main-nav-link, .timer-duration-btn, button, .card-link {
            transition: all 0.4s ease-in-out;
        }
        .card-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: transform, box-shadow;
        }
        .card-link:hover {
             transform: translateY(-6px) scale(1.02);
             box-shadow: var(--shadow-hover);
        }
         html.dark .card-link:hover {
             box-shadow: 0 12px 40px rgba(0,0,0,0.3), 0 6px 12px rgba(0,0,0,0.2);
         }
        button:active {
            transform: scale(0.97);
        }
        
        .main-nav-link {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .main-nav-link::before {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            width: 0;
            height: 3px;
            background: var(--forest-green);
            border-radius: 2px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(-50%);
        }
        .main-nav-link:hover::before {
            width: 100%;
        }
        .main-nav-link.active {
            font-weight: 700;
            color: var(--forest-green);
        }
        .main-nav-link.active::before {
            width: 100%;
        }
        html.dark .main-nav-link.active { color: #86b596; }
        html.dark .main-nav-link::before { background: #86b596; }
        
        
        a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
            outline: 2px solid var(--earthy-gold);
            outline-offset: 2px;
            border-radius: 4px;
        }

        #skip-to-content {
            position: absolute;
            left: -9999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        #skip-to-content:focus {
            position: fixed;
            top: 1rem;
            left: 1rem;
            width: auto;
            height: auto;
            padding: 0.5rem 1rem;
            background: var(--charcoal);
            color: var(--linen-white);
            z-index: 1000;
            border-radius: 6px;
        }
        
        /* Custom UI Elements */
        .article-content blockquote {
            border-left: 4px solid var(--earthy-gold);
            padding-left: 1.5rem;
            margin: 2rem 0;
            font-style: italic;
            font-family: 'Lora', serif;
            letter-spacing: 0.025em;
            color: #555;
        }
        html.dark .article-content blockquote {
            border-left-color: #dcb981;
            color: #aaa;
        }

        .call-out-box {
            background-color: var(--light-green);
            border-left: 4px solid var(--forest-green);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 8px 8px 0;
        }
        html.dark .call-out-box {
            background-color: #2c3a32;
            border-left-color: #86b596;
        }

        #progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background-color: var(--forest-green);
            width: 0%;
            z-index: 100;
            transition: width 0.1s linear;
        }
        html.dark #progress-bar {
            background-color: #86b596;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-in-out;
        }
        .stagger-in > * {
            animation: fadeIn 0.6s ease-in-out both;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Pali Term Tooltip */
        .pali-term {
            border-bottom: 2px dotted var(--earthy-gold);
            cursor: help;
            position: relative;
        }
        html.dark .pali-term { border-bottom-color: #dcb981; }

        .pali-tooltip {
            visibility: hidden;
            width: 250px;
            background-color: var(--charcoal);
            color: var(--linen-white);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.4s;
        }
        html.dark .pali-tooltip { background-color: #f0f0f0; color: #111; }
        
        .pali-term:hover .pali-tooltip {
            visibility: visible;
            opacity: 1;
        }
        
        /* Meditation Timer Styles */
        .timer-ring-bg {
            stroke: var(--light-green);
        }
        .timer-ring-fg {
            stroke: var(--forest-green);
            transform: rotate(-90deg);
            transform-origin: center;
            transition: stroke-dashoffset 1s linear;
        }
        .timer-active .timer-ring-fg {
            animation: pulse-ring 2s infinite ease-in-out;
        }
        @keyframes pulse-ring {
            0%, 100% { stroke-opacity: 1; }
            50% { stroke-opacity: 0.7; }
        }
        html.dark .timer-ring-bg { stroke: #2c3a32; }
        html.dark .timer-ring-fg { stroke: #86b596; }
        
        /* Interview Recorder Styles - Optimized */
        #live-video {
            transform: scaleX(-1);
            object-fit: cover;
            will-change: transform; /* Optimize for animations */
        }
        
        #playback-video {
            transform: none;
            object-fit: cover;
            will-change: auto;
        }
        
        /* Video containers with better performance */
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            contain: layout style paint; /* CSS containment for better performance */
        }
        
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            contain: layout style paint;
        }
        
        .recording-dot {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Journal Focus Mode */
        .journal-focus #header, .journal-focus #footer {
            display: none;
        }
        .journal-focus #main-content {
            padding: 2rem 1rem;
            max-width: 100%;
        }
        .journal-focus #journal-container {
            max-width: 800px;
            margin: auto;
        }
    </style>
</head>
<body class="bg-linen-white text-charcoal transition-colors duration-300">
    <a href="#main-content" id="skip-to-content">Skip to main content</a>
    <div id="progress-bar"></div>
    
    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="hidden fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4">
        <div class="bg-linen-white dark:bg-charcoal rounded-lg shadow-2xl max-w-lg w-full p-8 text-center fade-in">
            <h2 class="text-3xl font-bold font-lora text-forest-green mb-4">Welcome to The Dhamma Path</h2>
            <p class="text-charcoal/80 dark:text-gray-300 mb-6">Ready to transform your mornings? Choose your starting point and begin your journey today.</p>
            <div class="space-y-4">
                <button class="onboarding-choice w-full p-4 bg-light-green hover:bg-green-200/50 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg text-left border-2 border-forest-green" style="background-color: #d4edda !important; color: #2d5016 !important; display: block !important; visibility: visible !important;">
                    <strong class="text-forest-green">Start My Morning Routine</strong>
                    <p class="text-sm text-charcoal/70 dark:text-gray-400">I want to build a powerful morning routine with meditation, journaling, and exercise.</p>
                </button>
                <button class="onboarding-choice w-full p-4 bg-light-green hover:bg-green-200/50 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg text-left border-2 border-forest-green" style="background-color: #d4edda !important; color: #2d5016 !important; display: block !important; visibility: visible !important;">
                     <strong class="text-forest-green">Explore Buddhist Wisdom</strong>
                    <p class="text-sm text-charcoal/70 dark:text-gray-400">I want to learn about Buddhist teachings and mindfulness principles.</p>
                </button>
            </div>
            <button id="close-onboarding" class="mt-8 text-sm text-charcoal/60 dark:text-gray-400 hover:underline">Or, just explore the site</button>
        </div>
    </div>


    <!-- Enhanced Header & Navigation -->
    <header id="header" class="bg-gradient-to-r from-linen-white/90 via-linen-white/95 to-linen-white/90 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200/50 shadow-lg transition-all duration-300">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" role="navigation" aria-label="Main navigation">
            <div class="flex items-center justify-between h-20 transition-all duration-300">
                <!-- Logo -->
                <a href="#" data-page="home" class="flex items-center space-x-2 main-nav-link" aria-label="The Dhamma Path - Home">
                     <svg width="40" height="40" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="fill-charcoal transition-colors duration-300" aria-label="The Dhamma Path Logo" role="img">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:currentColor;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:currentColor;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle cx="50" cy="50" r="45" fill="none" stroke="url(#logoGradient)" stroke-width="2" opacity="0.3"/>
                        <path class="logo-path" fill="url(#logoGradient)" stroke="none" d="M20 80 C 30 45, 50 30, 50 20 C 50 30, 60 40, 70 50 C 90 40, 80 70, 50 80 C 20 90, 30 50, 20 80 Z" />
                        <circle cx="50" cy="50" r="3" fill="currentColor" opacity="0.6"/>
                    </svg>
                    <span class="font-lora text-sm font-bold text-charcoal">The Dhamma Path</span>
                </a>

                <!-- Enhanced Desktop Nav -->
                <div id="desktop-nav-links" class="hidden md:flex items-center space-x-1">
                    <!-- Activities First -->
                    <a href="#" data-page="timer" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">🧘 Meditate</a>
                    <a href="#" data-page="journal" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">✍️ Journal</a>
                    <a href="#" data-page="workout" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">💪 Exercise</a>
                    <a href="#" data-page="interview" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">🎤 Practice</a>
                    <!-- Info Pages Last -->
                    <a href="#" data-page="category-meditation" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">📚 Learning</a>
                    <a href="#" data-page="glossary" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">Glossary</a>
                    <a href="#" data-page="about" class="main-nav-link link-underline-draw text-charcoal hover:text-forest-green transition-all duration-300 px-6 py-3 rounded-lg hover:bg-light-green/20 hover:shadow-sm">About</a>
                    <div class="relative">
                        <input type="search" id="search-input" placeholder="Search wisdom..." class="form-focus focus-grow focus-ring w-40 bg-gradient-to-r from-light-green to-linen-white border border-transparent rounded-full px-4 py-2 focus:w-48 focus:bg-white focus:border-earthy-gold focus:outline-none focus:shadow-lg transition-all duration-300 dark:bg-gray-700 dark:text-white">
                        <svg class="w-5 h-5 absolute right-3 top-1/2 -translate-y-1/2 text-charcoal/60" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Search icon" role="img"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        <div id="autocomplete-results" class="hidden absolute top-full mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-xl"></div>
                    </div>
                    <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-light-green/20 dark:hover:bg-charcoal/20 transition-colors border border-forest-green/20" style="display: inline-block !important; visibility: visible !important;">
                        <!-- Sun Icon -->
                        <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Switch to dark mode" role="img"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                        <!-- Moon Icon -->
                        <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Switch to light mode" role="img"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                    </button>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-charcoal hover:text-forest-green focus:outline-none border border-forest-green/20" style="display: inline-flex !important; visibility: visible !important;" aria-label="Open mobile menu" aria-expanded="false" aria-controls="mobile-menu">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Menu icon" role="img">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <!-- Enhanced Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-gradient-to-b from-linen-white/95 to-linen-white/90 backdrop-blur-lg border-t border-gray-200/50 shadow-lg" role="navigation" aria-label="Mobile navigation menu">
            <div id="mobile-nav-links" class="px-4 pt-4 pb-6 space-y-2">
                <a href="#" data-page="timer" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">🧘 Meditate</a>
                <a href="#" data-page="journal" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">✍️ Journal</a>
                <a href="#" data-page="workout" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">💪 Exercise</a>
                <a href="#" data-page="interview" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">🎤 Practice</a>
                <a href="#" data-page="category-meditation" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">📚 Learning</a>
                <a href="#" data-page="glossary" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">Glossary</a>
                <a href="#" data-page="about" class="main-nav-link text-charcoal hover:text-forest-green block px-6 py-3 rounded-xl text-base font-medium hover:bg-light-green/20 hover:shadow-sm transition-all duration-300">About</a>
                <div class="px-3 py-2">
                    <button id="dark-mode-toggle-mobile" class="w-full flex items-center justify-between p-2 rounded-md hover:bg-light-green/20 dark:hover:bg-charcoal/20 transition-colors border border-forest-green/20" style="display: block !important; visibility: visible !important;" aria-label="Toggle dark mode">
                        <span>Toggle Theme</span>
                        <div class="flex items-center">
                           <svg class="h-6 w-6 text-earthy-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-label="Theme toggle icon" role="img"><use href="#sun-icon" /><use href="#moon-icon" /></svg>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Reading Progress Indicator -->
    <div class="reading-progress" id="reading-progress"></div>
    
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scroll-progress"></div>
    
    
    <!-- Loading Indicator -->
    <div id="loading-indicator" class="fixed inset-0 bg-linen-white/90 backdrop-blur-sm z-50 flex items-center justify-center hidden">
        <div class="text-center fade-in-scale">
            <div class="w-16 h-16 border-4 border-forest-green border-t-transparent rounded-full loading-spinner mx-auto mb-6 shadow-lg"></div>
            <p class="text-charcoal/70 text-lg font-medium">Loading your morning routine...</p>
            <div class="mt-4 flex justify-center space-x-1">
                <div class="w-2 h-2 bg-forest-green rounded-full animate-pulse"></div>
                <div class="w-2 h-2 bg-earthy-gold rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
                <div class="w-2 h-2 bg-light-green rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
            </div>
        </div>
    </div>

    <!-- Enhanced Notification Toast -->
    <div id="notification" class="fixed top-6 right-6 z-50 transform translate-x-full transition-all duration-500 ease-out">
        <div class="bg-gradient-to-r from-white to-gray-50 dark:from-gray-800 dark:to-gray-700 border border-gray-200 dark:border-gray-600 rounded-2xl shadow-xl px-6 py-4 max-w-sm fade-in-scale">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0">
                    <svg class="w-6 h-6 text-forest-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <div>
                    <p id="notification-text" class="text-sm font-medium text-charcoal dark:text-white"></p>
                </div>
            </div>
        </div>
    </div>


    <main id="main-content" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16 page-transition">
        <!-- Page content will be injected here -->
    </main>
    
    <!-- Enhanced Footer -->
    <footer id="footer" class="bg-gradient-to-br from-light-green/40 via-white to-light-green/20 border-t border-gray-200/80 transition-colors duration-300 shadow-lg" role="contentinfo">
        <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="space-y-4 md:col-span-2">
                    <a href="#" data-page="home" class="main-nav-link link-smooth flex items-center space-x-2" aria-label="The Dhamma Path - Home">
                         <svg width="32" height="32" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="fill-charcoal transition-colors duration-300" aria-label="The Dhamma Path Logo" role="img">
                             <defs>
                                 <linearGradient id="logoGradientMobile" x1="0%" y1="0%" x2="100%" y2="100%">
                                     <stop offset="0%" style="stop-color:currentColor;stop-opacity:0.8" />
                                     <stop offset="100%" style="stop-color:currentColor;stop-opacity:1" />
                                 </linearGradient>
                             </defs>
                             <circle cx="50" cy="50" r="45" fill="none" stroke="url(#logoGradientMobile)" stroke-width="2" opacity="0.3"/>
                             <path class="logo-path" fill="url(#logoGradientMobile)" stroke="none" d="M20 80 C 30 45, 50 30, 50 20 C 50 30, 60 40, 70 50 C 90 40, 80 70, 50 80 C 20 90, 30 50, 20 80 Z" />
                             <circle cx="50" cy="50" r="3" fill="currentColor" opacity="0.6"/>
                         </svg>
                        <span class="font-lora text-lg font-bold text-charcoal">The Dhamma Path</span>
                    </a>
                    <p class="text-charcoal/70">Your trusted companion on the path to inner peace through authentic Buddhist teachings and mindful living.</p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-charcoal tracking-wider uppercase font-lora">Explore</h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="#" data-page="timer" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Guided Meditation Timer</a></li>
                        <li><a href="#" data-page="journal" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Mindful Freewriting</a></li>
                        <li><a href="#" data-page="workout" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">7-Minute Mindful Workout</a></li>
                        <li><a href="#" data-page="interview" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Confident Interview Practice</a></li>
                        <li><a href="#" data-page="about" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">About Us</a></li>
                        <li><a href="#" data-page="glossary" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Pāli Glossary</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-charcoal tracking-wider uppercase font-lora">Legal</h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="#" data-page="privacy" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Privacy Policy</a></li>
                        <li><a href="#" data-page="terms" class="main-nav-link text-base text-charcoal/80 hover:text-forest-green">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-300/50 text-center text-charcoal/60">
                <p>&copy; 2025 The Dhamma Path. All rights reserved.</p>
            </div>
        </div>
    </footer>


    <!-- TEMPLATES for dynamic content -->
    <template id="template-home">
        <article class="space-y-8 sm:space-y-12 max-w-5xl mx-auto">
            <!-- Hero Section -->
            <header class="text-left py-16 sm:py-20 rounded-2xl breathing-bg floating-particles zen-particles ambient-gradient dark:from-gray-800/30 dark:via-gray-900/20 dark:to-transparent relative overflow-hidden">
                <!-- Subtle background pattern with floating animation -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-10 left-10 w-32 h-32 bg-forest-green rounded-full blur-3xl float-animation ambient-breathe"></div>
                    <div class="absolute bottom-10 right-10 w-24 h-24 bg-earthy-gold rounded-full blur-2xl float-animation ambient-float"></div>
                    <div class="absolute top-1/2 left-1/4 w-16 h-16 bg-light-green rounded-full blur-xl float-animation ambient-breathe"></div>
                </div>
                
                <!-- Floating Particles -->
                <div class="floating-particle parallax-slow particle-1" style="left: 10%; animation-delay: 0s;"></div>
                <div class="floating-particle parallax-medium particle-2" style="left: 20%; animation-delay: 3s;"></div>
                <div class="floating-particle parallax-fast particle-3" style="left: 30%; animation-delay: 6s;"></div>
                <div class="floating-particle parallax-slow particle-4" style="left: 70%; animation-delay: 9s;"></div>
                <div class="floating-particle parallax-medium particle-5" style="left: 80%; animation-delay: 12s;"></div>
                <div class="floating-particle parallax-fast particle-1" style="left: 90%; animation-delay: 15s;"></div>
                <div class="relative max-w-5xl">
                    <!-- Trust Badge -->
                    <div class="flex items-center justify-center mb-6 slide-in-left">
                        <div class="flex items-center space-x-2 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg border border-white/20">
                            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-sm font-medium text-charcoal">Join 1,200+ people transforming their mornings</span>
                        </div>
                    </div>
                    
                    <h1 class="text-hierarchy-1 text-gradient font-lora text-glow-strong slide-in-left text-center">Transform Your Mornings, Transform Your Life</h1>
                    <p class="text-body-large text-charcoal/80 text-smooth-transition max-w-4xl mx-auto text-center slide-in-right mb-8">Master the art of mindful mornings with our integrated toolkit: meditation, journaling, exercise, and confidence practice. Discover how just <strong class="text-forest-green">30 minutes each morning</strong> can revolutionize your entire day.</p>
                    
                    <!-- Key Benefits -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 slide-in-right">
                        <div class="text-center p-8 bg-white/90 backdrop-blur-sm rounded-xl border border-white/50 shadow-lg">
                            <div class="text-3xl mb-3">🧘‍♂️</div>
                            <p class="text-base font-semibold text-charcoal">Find Inner Peace</p>
                        </div>
                        <div class="text-center p-8 bg-white/90 backdrop-blur-sm rounded-xl border border-white/50 shadow-lg">
                            <div class="text-3xl mb-3">⚡</div>
                            <p class="text-base font-semibold text-charcoal">Boost Energy</p>
                        </div>
                        <div class="text-center p-8 bg-white/90 backdrop-blur-sm rounded-xl border border-white/50 shadow-lg">
                            <div class="text-3xl mb-3">🎯</div>
                            <p class="text-base font-semibold text-charcoal">Build Confidence</p>
                        </div>
                    </div>
                    
                    <!-- Primary CTA -->
                    <div class="text-center slide-in-right">
                        <button onclick="navigateTo('timer')" class="inline-flex items-center px-10 py-5 bg-white text-forest-green font-bold text-xl rounded-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 shadow-xl border-2 border-white focus:ring-4 focus:ring-white/50 focus:outline-none">
                            <svg class="w-7 h-7 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v18m-9-9h18M12 3a9 9 0 0 1 9 9 9 9 0 0 1-9 9M12 3a9 9 0 0 0-9 9 9 9 0 0 0 9 9"></path>
                            </svg>
                            Start Your Morning Journey
                        </button>
                        <p class="text-base text-white/90 mt-4 font-medium">✨ Free forever • No signup required • Start in 30 seconds</p>
                    </div>
                    
                    <!-- Shimmer divider -->
                    <div class="mt-8 shimmer-divider w-24 mx-auto"></div>
                </div>
            </header>

            <!-- Social Proof & Testimonials -->
            <section class="bg-gradient-to-r from-white to-gray-50/50 rounded-2xl p-6 sm:p-10 shadow-lg border border-gray-100 relative overflow-hidden">
                <!-- Subtle background pattern -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-forest-green rounded-full blur-2xl"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-earthy-gold rounded-full blur-xl"></div>
                </div>
                
                <div class="text-center mb-8 relative">
                    <h2 class="text-2xl sm:text-3xl font-bold text-charcoal font-lora mb-6">What People Are Saying</h2>
                    <p class="text-charcoal/70">Real stories from people who transformed their mornings</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Testimonial 1 -->
                    <div class="bg-white rounded-xl p-8 shadow-md border border-gray-100 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center">
                                <span class="text-white font-bold text-sm">S</span>
                            </div>
                            <div class="ml-3">
                                <p class="font-semibold text-charcoal text-sm">Sarah M.</p>
                                <p class="text-xs text-charcoal/60">Marketing Manager</p>
                            </div>
                        </div>
                        <p class="text-sm text-charcoal/80 leading-relaxed">"This changed everything. I went from chaotic mornings to feeling centered and ready for anything. The meditation timer is perfect."</p>
                        <div class="flex text-earthy-gold mt-4">
                            <span>⭐⭐⭐⭐⭐</span>
                        </div>
                    </div>
                    
                    <!-- Testimonial 2 -->
                    <div class="bg-white rounded-xl p-8 shadow-md border border-gray-100 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 bg-gradient-to-br from-earthy-gold to-earthy-gold/80 rounded-full flex items-center justify-center">
                                <span class="text-white font-bold text-sm">M</span>
                            </div>
                            <div class="ml-3">
                                <p class="font-semibold text-charcoal text-sm">Mike R.</p>
                                <p class="text-xs text-charcoal/60">Software Developer</p>
                            </div>
                        </div>
                        <p class="text-sm text-charcoal/80 leading-relaxed">"The journaling feature helped me process my thoughts better. I'm more focused and less stressed throughout the day."</p>
                        <div class="flex text-earthy-gold mt-4">
                            <span>⭐⭐⭐⭐⭐</span>
                        </div>
                    </div>
                    
                    <!-- Testimonial 3 -->
                    <div class="bg-white rounded-xl p-8 shadow-md border border-gray-100 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center">
                                <span class="text-white font-bold text-sm">A</span>
                            </div>
                            <div class="ml-3">
                                <p class="font-semibold text-charcoal text-sm">Alex K.</p>
                                <p class="text-xs text-charcoal/60">Entrepreneur</p>
                            </div>
                        </div>
                        <p class="text-sm text-charcoal/80 leading-relaxed">"The confidence practice sessions are incredible. I feel so much more prepared for presentations and meetings now."</p>
                        <div class="flex text-earthy-gold mt-4">
                            <span>⭐⭐⭐⭐⭐</span>
                        </div>
                    </div>
                </div>
                
                <!-- Trust Indicators -->
                <div class="mt-8 pt-6 border-t border-gray-200">
                    <div class="flex flex-wrap items-center justify-center gap-8 text-sm text-charcoal/60">
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>100% Free</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>No Signup Required</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Privacy Protected</span>
                        </div>
                    </div>
                 </div>
            </section>

            <!-- Daily Morning Routine -->
            <section class="observe-fade-in bg-gradient-to-br from-light-green/40 via-white to-light-gold/20 rounded-2xl p-8 sm:p-12 shadow-lg border border-light-green/20 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-bl from-forest-green/10 to-transparent rounded-full blur-2xl"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-earthy-gold/10 to-transparent rounded-full blur-xl"></div>
                
                <div class="text-center mb-10 relative">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gradient font-lora mb-6 text-glow">Your Daily Morning Routine</h2>
                    <p class="text-lg text-charcoal/80 max-w-2xl mx-auto leading-relaxed">Four powerful practices, one transformative morning. Build your ideal routine by combining meditation, journaling, exercise, and confidence practice.</p>
                    <!-- Decorative elements -->
                    <div class="mt-4 flex justify-center space-x-2">
                        <div class="w-2 h-2 bg-forest-green rounded-full"></div>
                        <div class="w-2 h-2 bg-earthy-gold rounded-full"></div>
                        <div class="w-2 h-2 bg-light-green rounded-full"></div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Meditation Timer -->
                    <a href="#" data-page="timer" class="main-nav-link card-lift observe-scale group block p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-forest-green/10 hover:border-forest-green/30 hover:-translate-y-1 relative overflow-hidden gentle-bounce card-breathe card-breathe-gentle ambient-shadow">
                        <!-- Subtle gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-br from-forest-green/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="text-center relative">
                            <div class="w-20 h-20 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-all duration-500 shadow-lg gentle-rotate">
                                <svg class="w-10 h-10 text-white drop-shadow-sm icon-breathe" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v18m-9-9h18M12 3a9 9 0 0 1 9 9 9 9 0 0 1-9 9M12 3a9 9 0 0 0-9 9 9 9 0 0 0 9 9"></path>
                                </svg>
                            </div>
                            <h3 class="text-hierarchy-4 text-charcoal font-lora mb-3 group-hover:text-forest-green text-smooth-transition">Meditation Overview</h3>
                            <p class="text-body-small text-charcoal/70 mb-4 paragraph-spacing">Find your center with 5-30 minute sessions, customizable bells, and gentle progress tracking.</p>
                            <span class="inline-block px-4 py-2 bg-gradient-to-r from-forest-green/10 to-forest-green/5 text-forest-green text-xs font-semibold rounded-full border border-forest-green/20">Quick Start</span>
                        </div>
                    </a>

                    <!-- Mindful Journal -->
                    <a href="#" data-page="journal" class="main-nav-link card-lift observe-scale group block p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-earthy-gold/10 hover:border-earthy-gold/30 hover:-translate-y-1 relative overflow-hidden gentle-bounce card-breathe card-breathe-gentle ambient-shadow">
                        <!-- Subtle gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-br from-earthy-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="text-center relative">
                            <div class="w-20 h-20 bg-gradient-to-br from-earthy-gold to-earthy-gold/80 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-all duration-500 shadow-lg gentle-rotate">
                                <svg class="w-10 h-10 text-white drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                            <h3 class="text-hierarchy-4 text-charcoal font-lora mb-3 group-hover:text-earthy-gold text-smooth-transition">Mindful Journal</h3>
                            <p class="text-body-small text-charcoal/70 mb-4 paragraph-spacing">Capture your thoughts with freewriting practice, auto-save, and flexible timing options.</p>
                            <span class="inline-block px-4 py-2 bg-gradient-to-r from-earthy-gold/10 to-earthy-gold/5 text-earthy-gold text-xs font-semibold rounded-full border border-earthy-gold/20">Self-Reflection</span>
                        </div>
                    </a>

                    <!-- 7-Minute Workout -->
                    <a href="#" data-page="workout" class="main-nav-link card-lift observe-scale group block p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-light-green/10 hover:border-light-green/30 hover:-translate-y-1 relative overflow-hidden card-breathe card-breathe-gentle ambient-shadow">
                        <!-- Subtle gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-br from-light-green/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="text-center relative">
                            <div class="w-20 h-20 bg-gradient-to-br from-light-green to-light-green/80 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-all duration-500 shadow-lg">
                                <svg class="w-10 h-10 text-forest-green drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-hierarchy-4 text-charcoal font-lora mb-3 group-hover:text-light-green text-smooth-transition">7-Minute Workout</h3>
                            <p class="text-body-small text-charcoal/70 mb-4 paragraph-spacing">Energize your body with high-intensity circuit training, visual guides, and progress tracking.</p>
                            <span class="inline-block px-4 py-2 bg-gradient-to-r from-light-green/20 to-light-green/10 text-forest-green text-xs font-semibold rounded-full border border-light-green/20">Energy Boost</span>
                        </div>
                    </a>

                    <!-- Confidence Practice -->
                    <a href="#" data-page="interview" class="main-nav-link card-lift observe-scale group block p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-forest-green/10 hover:border-forest-green/30 hover:-translate-y-1 relative overflow-hidden card-breathe card-breathe-gentle ambient-shadow">
                        <!-- Subtle gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-br from-forest-green/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="text-center relative">
                            <div class="w-20 h-20 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-all duration-500 shadow-lg">
                                <svg class="w-10 h-10 text-white drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-hierarchy-4 text-charcoal font-lora mb-3 group-hover:text-forest-green text-smooth-transition">Confidence Practice</h3>
                            <p class="text-body-small text-charcoal/70 mb-4 paragraph-spacing">Build speaking confidence with video practice for storytelling, communication, and presentation skills.</p>
                            <span class="inline-block px-4 py-2 bg-gradient-to-r from-light-green to-light-green/50 text-forest-green text-xs font-semibold rounded-full border border-forest-green/20">Build Skills</span>
                        </div>
                    </a>
                </div>

                <div class="text-center mt-8">
                    <p class="text-sm text-charcoal/60">💡 <strong>Pro Tip:</strong> Begin with 5 minutes of meditation, then gradually add journaling or exercise as your routine becomes natural!</p>
                 </div>
            </section>

            <!-- Daily Progress Tracker -->
            <section class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-8 shadow-xl border border-gray-100 relative overflow-hidden">
                <!-- Subtle background pattern -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-0 left-0 w-64 h-64 bg-forest-green rounded-full blur-3xl"></div>
                    <div class="absolute bottom-0 right-0 w-48 h-48 bg-earthy-gold rounded-full blur-2xl"></div>
                </div>
                <div class="text-center mb-10 relative">
                    <h2 class="text-2xl sm:text-3xl font-bold text-charcoal font-lora mb-4 drop-shadow-sm">Today's Progress</h2>
                    <p class="text-charcoal/70 text-lg">Monitor your daily progress and build momentum</p>
                    <!-- Decorative line -->
                    <div class="mt-4 w-16 h-1 bg-gradient-to-r from-forest-green to-earthy-gold rounded-full mx-auto"></div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <!-- Meditation Progress -->
                    <div class="flex items-center p-5 bg-gradient-to-r from-light-green/30 to-light-green/10 rounded-xl border border-light-green/20 shadow-sm hover:shadow-md transition-all duration-300">
                        <div class="flex-shrink-0">
                            <div id="meditation-status" class="w-10 h-10 rounded-full bg-gradient-to-br from-forest-green to-forest-green/80 flex items-center justify-center shadow-lg">
                                <svg class="w-5 h-5 text-white drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v18m-9-9h18M12 3a9 9 0 0 1 9 9 9 9 0 0 1-9 9M12 3a9 9 0 0 0-9 9 9 9 0 0 0 9 9"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <p class="text-sm font-semibold text-charcoal">Meditation</p>
                            <p id="meditation-time" class="text-xs text-charcoal/60">Not started</p>
                        </div>
                    </div>

                    <!-- Journal Progress -->
                    <div class="flex items-center p-5 bg-gradient-to-r from-earthy-gold/30 to-earthy-gold/10 rounded-xl border border-earthy-gold/20 shadow-sm hover:shadow-md transition-all duration-300">
                        <div class="flex-shrink-0">
                            <div id="journal-status" class="w-10 h-10 rounded-full bg-gradient-to-br from-earthy-gold to-earthy-gold/80 flex items-center justify-center shadow-lg">
                                <svg class="w-5 h-5 text-white drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <p class="text-sm font-semibold text-charcoal">Journal</p>
                            <p id="journal-time" class="text-xs text-charcoal/60">Not started</p>
                        </div>
                    </div>

                    <!-- Workout Progress -->
                    <div class="flex items-center p-5 bg-gradient-to-r from-light-green/30 to-light-green/10 rounded-xl border border-light-green/20 shadow-sm hover:shadow-md transition-all duration-300">
                        <div class="flex-shrink-0">
                            <div id="workout-status" class="w-10 h-10 rounded-full bg-gradient-to-br from-light-green to-light-green/80 flex items-center justify-center shadow-lg">
                                <svg class="w-5 h-5 text-forest-green drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <p class="text-sm font-semibold text-charcoal">Workout</p>
                            <p id="workout-time" class="text-xs text-charcoal/60">Not started</p>
                        </div>
                    </div>

                    <!-- Confidence Practice Progress -->
                    <div class="flex items-center p-5 bg-gradient-to-r from-light-green/50 to-light-green/30 rounded-xl border border-forest-green/20 shadow-sm hover:shadow-md transition-all duration-300">
                        <div class="flex-shrink-0">
                            <div id="confidence-status" class="w-10 h-10 rounded-full bg-gradient-to-br from-forest-green to-forest-green/80 flex items-center justify-center shadow-lg">
                                <svg class="w-5 h-5 text-white drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <p class="text-sm font-semibold text-charcoal">Confidence</p>
                            <p id="confidence-time" class="text-xs text-charcoal/60">Not started</p>
                        </div>
                    </div>
                </div>

                <!-- Overall Progress Bar -->
                <div class="bg-gradient-to-r from-gray-200 to-gray-100 rounded-full h-4 mb-6 shadow-inner border border-gray-200/50">
                    <div id="overall-progress" class="bg-gradient-to-r from-forest-green via-light-green to-earthy-gold h-4 rounded-full transition-all duration-700 shadow-lg relative overflow-hidden progress-pulse shimmer" style="width: 0%">
                        <!-- Animated shimmer effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"></div>
                    </div>
                </div>
                
                <div class="flex justify-between items-center text-sm">
                    <span id="progress-text" class="text-charcoal/70 font-medium">Complete 0 of 4 activities</span>
                    <span id="streak-text" class="text-charcoal/70 font-medium">🔥 0 day streak</span>
                 </div>
            </section>

            <!-- Why Morning Routines Matter -->
            <section class="soft-gradient-bg bg-gradient-to-br from-earthy-gold/15 via-white to-light-green/15 rounded-2xl p-10 sm:p-14 shadow-xl border border-earthy-gold/20 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute top-0 right-0 w-48 h-48 bg-gradient-to-bl from-earthy-gold/10 to-transparent rounded-full blur-3xl"></div>
                <div class="absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-light-green/10 to-transparent rounded-full blur-2xl"></div>
                
                <div class="text-center mb-12 relative">
                    <h2 class="text-3xl sm:text-4xl font-bold text-charcoal font-lora mb-6 drop-shadow-sm">Why Your Morning Routine Matters</h2>
                    <p class="text-lg text-charcoal/80 max-w-3xl mx-auto leading-relaxed mb-6">The first hour of your day shapes everything that follows. A purposeful morning routine builds discipline, reduces stress, amplifies productivity, and creates sacred space for personal growth.</p>
                    
                    <!-- Key Statistics -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-forest-green mb-2">85%</div>
                            <p class="text-sm text-charcoal/70">of successful people have morning routines</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-earthy-gold mb-2">30 min</div>
                            <p class="text-sm text-charcoal/70">is all you need to see results</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-light-green mb-2">21 days</div>
                            <p class="text-sm text-charcoal/70">to form a lasting habit</p>
                        </div>
                    </div>
                    
                    <!-- Decorative elements -->
                    <div class="mt-6 flex justify-center space-x-3">
                        <div class="w-3 h-3 bg-earthy-gold rounded-full"></div>
                        <div class="w-3 h-3 bg-light-green rounded-full"></div>
                        <div class="w-3 h-3 bg-forest-green rounded-full"></div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="text-center p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-forest-green/10 hover:border-forest-green/30 group">
                        <div class="w-16 h-16 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:scale-110 transition-transform duration-300">
                            <svg class="w-10 h-10 text-white drop-shadow-xl" fill="currentColor" stroke="currentColor" viewBox="0 0 24 24" style="filter: drop-shadow(0 3px 6px rgba(0,0,0,0.4)); color: white !important;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-charcoal mb-4 group-hover:text-forest-green transition-colors duration-300">Energy & Focus</h3>
                        <p class="text-sm text-charcoal/70 leading-relaxed">Start your day with intention and build momentum that carries through your entire day.</p>
                    </div>
                    
                    <div class="text-center p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-earthy-gold/10 hover:border-earthy-gold/30 group">
                        <div class="w-16 h-16 bg-gradient-to-br from-earthy-gold to-earthy-gold/80 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:scale-110 transition-transform duration-300">
                            <svg class="w-10 h-10 text-white drop-shadow-xl" fill="currentColor" stroke="currentColor" viewBox="0 0 24 24" style="filter: drop-shadow(0 3px 6px rgba(0,0,0,0.4)); color: white !important;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-charcoal mb-4 group-hover:text-earthy-gold transition-colors duration-300">Habit Formation</h3>
                        <p class="text-sm text-charcoal/70 leading-relaxed">Consistent morning practices create powerful habits that compound into lasting transformation.</p>
                    </div>
                    
                    <div class="text-center p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-500 border border-light-green/10 hover:border-light-green/30 group">
                        <div class="w-16 h-16 bg-gradient-to-br from-light-green to-light-green/80 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:scale-110 transition-transform duration-300">
                            <svg class="w-10 h-10 text-forest-green drop-shadow-xl" fill="currentColor" stroke="currentColor" viewBox="0 0 24 24" style="filter: drop-shadow(0 3px 6px rgba(0,0,0,0.3)); color: #2d5016 !important;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-charcoal mb-4 group-hover:text-light-green transition-colors duration-300">Mental Wellbeing</h3>
                        <p class="text-sm text-charcoal/70 leading-relaxed">Dedicated time for reflection and self-care strengthens your mental health and builds unshakeable resilience.</p>
                    </div>
                </div>
            </section>

            <!-- Final Call-to-Action -->
            <section class="bg-gradient-to-br from-forest-green via-forest-green/90 to-forest-green/80 rounded-2xl p-12 sm:p-16 text-center text-white relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl"></div>
                    <div class="absolute bottom-0 right-0 w-48 h-48 bg-earthy-gold rounded-full blur-2xl"></div>
                </div>
                
                <div class="relative max-w-4xl mx-auto">
                    <h2 class="text-3xl sm:text-4xl font-bold font-lora mb-6 text-white drop-shadow-lg">Ready to Transform Your Mornings?</h2>
                    <p class="text-xl text-white/90 mb-8 leading-relaxed">Join thousands of people who start each day with purpose, clarity, and inner peace. Your journey begins with a single click.</p>
                    
                    <!-- CTA Buttons -->
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-8" style="z-index: 10; position: relative;">
                        <button onclick="navigateTo('timer')" class="inline-flex items-center px-8 py-4 bg-white text-forest-green font-bold text-lg rounded-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 shadow-xl focus:ring-4 focus:ring-white/50 focus:outline-none" style="background-color: white !important; color: #2d5016 !important; display: inline-flex !important; visibility: visible !important; border: 2px solid white !important; font-weight: bold !important; text-shadow: none !important; opacity: 1 !important;">
                            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #2d5016 !important;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v18m-9-9h18M12 3a9 9 0 0 1 9 9 9 9 0 0 1-9 9M12 3a9 9 0 0 0-9 9 9 9 0 0 0 9 9"></path>
                            </svg>
                            <span style="color: #2d5016 !important; font-weight: bold !important; text-shadow: none !important;">Start Meditating Now</span>
                        </button>
                        <button onclick="navigateTo('journal')" class="inline-flex items-center px-8 py-4 bg-white/90 backdrop-blur-sm text-forest-green font-bold text-lg rounded-xl hover:bg-white hover:shadow-xl hover:scale-105 transition-all duration-300 border-2 border-white focus:ring-4 focus:ring-white/50 focus:outline-none" style="background-color: rgba(255, 255, 255, 0.9) !important; color: #2d5016 !important; display: inline-flex !important; visibility: visible !important; border: 2px solid white !important; font-weight: bold !important; text-shadow: none !important; opacity: 1 !important;">
                            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #2d5016 !important;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                            </svg>
                            <span style="color: #2d5016 !important; font-weight: bold !important; text-shadow: none !important;">Begin Journaling</span>
                        </button>
                    </div>
                    
                    <!-- Trust Indicators -->
                    <div class="flex flex-wrap items-center justify-center gap-6 text-sm text-white/80">
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>No credit card required</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Start in 30 seconds</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>100% private & secure</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Buddhist Wisdom & Learning -->
            <section>
                <h2 class="text-3xl font-bold text-center text-charcoal font-lora mb-6">Wisdom for Your Journey</h2>
                <p class="text-center text-charcoal/70 mb-10 max-w-2xl mx-auto">Deepen your morning practice with timeless teachings that support personal growth and mindful living.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 stagger-in">
                    <!-- Card 1 -->
                    <a href="#" data-page="category-introduction" class="main-nav-link card-link block p-8 bg-light-green rounded-lg shadow-sm duration-300 border border-black/5 hover:shadow-md" style="animation-delay: 0.1s;">
                        <h3 class="text-2xl font-bold text-forest-green font-lora">Understanding Theravāda</h3>
                        <p class="mt-2 text-charcoal/80">Explore the ancient wisdom of the oldest Buddhist tradition and its timeless teachings for modern life.</p>
                    </a>
                    <!-- Card 2 -->
                    <a href="#" data-page="path" data-path-id="7-day-mindfulness" class="main-nav-link card-link block p-8 bg-light-gold rounded-lg shadow-sm duration-300 border border-black/5 hover:shadow-md" style="animation-delay: 0.2s;">
                        <h3 class="text-2xl font-bold text-earthy-gold font-lora">7-Day Mindfulness Journey</h3>
                        <p class="mt-2 text-charcoal/80">Start your meditation practice with our carefully crafted beginner's guide to mindfulness.</p>
                    </a>
                    <!-- Card 3 -->
                    <a href="#" data-page="article" data-article-id="four-noble-truths" class="main-nav-link card-link block p-8 bg-light-green rounded-lg shadow-sm duration-300 border border-black/5 hover:shadow-md" style="animation-delay: 0.3s;">
                        <h3 class="text-2xl font-bold text-forest-green font-lora">The Four Noble Truths</h3>
                        <p class="mt-2 text-charcoal/80">Discover the fundamental insights that illuminate the path to lasting happiness and freedom from suffering.</p>
                    </a>
                </div>
            </section>

            <!-- Latest Articles -->
            <section>
                 <h2 class="text-3xl font-bold text-center text-charcoal font-lora mb-10">Insights & Wisdom</h2>
                 <div id="latest-articles-grid" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-12 stagger-in">
                    <!-- Article cards will be injected by JS -->
                 </div>
            </section>

             <!-- From the Canon -->
            <section class="bg-charcoal text-linen-white rounded-lg p-10 sm:p-16 text-center">
                <h2 class="text-3xl font-bold font-lora text-earthy-gold mb-6">Daily Inspiration</h2>
                <blockquote class="text-2xl sm:text-3xl font-lora italic leading-relaxed">
                    "Just as a solid rock is not shaken by the wind, so are the wise unshaken by praise or blame."
                </blockquote>
                <cite class="block mt-6 text-lg text-linen-white/70 not-italic">- The Dhammapada, Verse 81</cite>
            </section>
        </div>
    </template>
    
    <template id="template-category">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-12">
                <h1 id="category-title" class="text-4xl sm:text-5xl font-bold text-forest-green font-lora"></h1>
                <p id="category-description" class="mt-4 max-w-2xl mx-auto text-xl text-charcoal/80"></p>
            </div>
            <div id="category-paths-section" class="mb-16"></div>
            <div id="category-articles-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 stagger-in">
                <!-- Category article cards will be injected by JS -->
            </div>
        </div>
    </template>

    <template id="template-article">
        <article class="max-w-3xl mx-auto">
            <header class="text-center mb-10">
                <a href="#" id="article-category-link" data-page="" class="main-nav-link text-earthy-gold font-semibold uppercase tracking-wider"></a>
                <h1 id="article-title" class="text-4xl sm:text-5xl font-bold text-forest-green font-lora mt-2"></h1>
                <div class="mt-4 text-charcoal/60 text-sm flex justify-center items-center space-x-4">
                    <span>Last updated on <span id="article-date"></span></span> &bull; 
                    <span id="article-read-time"></span> min read
                    <button id="read-aloud-btn" class="flex items-center space-x-2 text-sm text-forest-green hover:underline px-3 py-2 bg-light-green rounded-lg border border-forest-green" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-flex !important; visibility: visible !important;">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z" /></svg>
                        <span>Read Aloud</span>
                    </button>
                </div>
            </header>
            
            <div id="audio-player-container" class="my-8"></div>

            <div id="article-toc" class="p-6 bg-light-gold rounded-lg my-8">
                <h3 class="text-xl font-bold font-lora text-earthy-gold mb-3">Table of Contents</h3>
                <ul id="toc-list" class="space-y-2"></ul>
            </div>
            
            <div id="article-content" class="article-content text-lg leading-relaxed space-y-6">
                <!-- Article content will be injected by JS -->
            </div>

            <hr class="my-12 border-gray-300/70 dark:border-gray-600">

            <!-- Author Bio -->
            <section id="author-bio" class="p-6 bg-light-green rounded-lg flex items-center space-x-6"></section>

            <!-- Related Articles -->
            <section id="related-articles" class="mt-16"></section>

            <!-- Comments Section -->
            <section id="comments-section" class="mt-16"></section>
        </article>
    </template>

    <template id="template-about">
        <div class="max-w-6xl mx-auto">
            <!-- Hero Section with Enhanced Styling -->
            <div class="breathing-bg floating-particles zen-particles ambient-gradient rounded-3xl p-16 sm:p-20 mb-16 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-10 left-10 w-40 h-40 bg-forest-green rounded-full blur-3xl float-animation ambient-breathe"></div>
                    <div class="absolute bottom-10 right-10 w-32 h-32 bg-earthy-gold rounded-full blur-2xl float-animation ambient-float"></div>
                    <div class="absolute top-1/2 left-1/3 w-24 h-24 bg-light-green rounded-full blur-xl float-animation ambient-breathe"></div>
                </div>
                
                <!-- Floating Particles -->
                <div class="floating-particle particle-1" style="left: 18%; animation-delay: 2.5s;"></div>
                <div class="floating-particle particle-2" style="left: 42%; animation-delay: 5.5s;"></div>
                <div class="floating-particle particle-3" style="left: 68%; animation-delay: 8.5s;"></div>
                <div class="floating-particle particle-4" style="left: 92%; animation-delay: 11.5s;"></div>
                
                <header class="text-center relative z-10">
                    <div class="w-24 h-24 bg-gradient-to-br from-forest-green/30 to-earthy-gold/30 rounded-full flex items-center justify-center mx-auto mb-8 icon-breathe">
                        <svg class="w-12 h-12 text-forest-green drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </div>
                    <h1 class="text-5xl sm:text-6xl font-bold text-gradient font-lora mb-6 text-glow">About The Dhamma Path</h1>
                    <p class="text-xl text-charcoal/80 max-w-3xl mx-auto leading-relaxed mb-8">A personal journey of morning routines, mindfulness, and timeless wisdom</p>
                    <!-- Shimmer divider -->
                    <div class="shimmer-divider w-32 mx-auto"></div>
            </header>
            </div>
            
            <!-- Enhanced Personal Story Section -->
            <section class="mb-20">
                <div class="bg-gradient-to-br from-light-green/40 via-white to-light-gold/20 rounded-3xl p-12 sm:p-16 shadow-xl border border-light-green/20 relative overflow-hidden">
                    <!-- Subtle background elements -->
                    <div class="absolute inset-0 opacity-10">
                        <div class="absolute top-0 right-0 w-48 h-48 bg-gradient-to-bl from-forest-green/20 to-transparent rounded-full blur-3xl float-animation"></div>
                        <div class="absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-earthy-gold/20 to-transparent rounded-full blur-2xl float-animation"></div>
                        <div class="absolute top-1/2 left-1/2 w-24 h-24 bg-light-green rounded-full blur-xl float-animation"></div>
                    </div>
                    
                    <div class="relative z-10">
                        <h2 class="text-4xl font-bold text-charcoal font-lora mb-8 text-gradient drop-shadow-sm">My Story</h2>
            <div class="text-lg leading-relaxed space-y-6">
                            <p>Hi, I'm William. This website began as my personal morning routine companion—a simple tool to help me start each day with intention through meditation, journaling, exercise, and confidence practice.</p>
                            <p>Like many people, I struggled with establishing consistent morning habits. I knew the benefits of meditation and mindful practices, but found it challenging to maintain a routine that actually stuck. That's when I decided to build something that would make it easier for me to show up for myself each morning.</p>
                            <p>What began as a personal project has evolved into a comprehensive platform that combines practical morning routine tools with the profound wisdom of Buddhist teachings. I believe that the best self-help is grounded in timeless principles, and that's why I've integrated authentic Buddhist wisdom throughout the site.</p>
                            <p>This isn't just another productivity app or meditation timer. It's a holistic approach to personal transformation that honors both modern self-help principles and ancient wisdom traditions.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Enhanced Buddhist Foundation Section -->
            <section class="mb-20">
                <div class="bg-gradient-to-br from-earthy-gold/15 via-white to-earthy-gold/5 rounded-3xl p-12 sm:p-16 shadow-xl border border-earthy-gold/20 relative overflow-hidden">
                    <!-- Subtle background elements -->
                    <div class="absolute inset-0 opacity-10">
                        <div class="absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-earthy-gold/20 to-transparent rounded-full blur-2xl float-animation"></div>
                        <div class="absolute bottom-0 right-0 w-32 h-32 bg-gradient-to-tl from-forest-green/20 to-transparent rounded-full blur-xl float-animation"></div>
                        <div class="absolute top-1/2 right-1/4 w-20 h-20 bg-light-green rounded-full blur-lg float-animation"></div>
                    </div>
                    
                    <div class="relative z-10">
                        <h2 class="text-4xl font-bold text-charcoal font-lora mb-8 text-gradient drop-shadow-sm">The Buddhist Foundation</h2>
                        <div class="text-lg leading-relaxed space-y-6">
                            <p>The Dhamma Path is grounded in the profound wisdom of Theravāda Buddhism, the oldest surviving Buddhist tradition. In a world of noise and distraction, we believe the path of mindfulness and wisdom offers a profound way to cultivate inner peace and clarity.</p>
                            <p>As a long-term practitioner of Vipassanā meditation, I found that many online resources were either too academic and dense for beginners, or too commercialized and disconnected from the original teachings. This website is an attempt to bridge that gap.</p>
                            
                            <h3 class="text-2xl font-bold text-charcoal font-lora mt-10 mb-6">Our Approach</h3>
                            <p>We are committed to presenting the Dhamma (the teachings of the Buddha) as it is found in the Pāli Canon, the earliest collection of Buddhist scriptures. Our content is written with three core principles in mind:</p>
                            <ul class="list-disc list-inside space-y-3 ml-6 mt-4">
                    <li><strong>Authenticity:</strong> We ground our content in the suttas and the Theravāda tradition.</li>
                    <li><strong>Clarity:</strong> We strive to explain complex concepts in simple, practical language without sacrificing depth.</li>
                    <li><strong>Practicality:</strong> We emphasize how these ancient teachings can be applied to modern life to reduce stress and cultivate genuine well-being.</li>
                </ul>
                    </div>
                </div>
            </section>

            <!-- Enhanced Mission Section -->
            <section class="mb-20">
                <div class="bg-gradient-to-br from-charcoal via-gray-800 to-charcoal text-linen-white rounded-2xl p-10 sm:p-14 text-center shadow-xl relative overflow-hidden">
                    <!-- Subtle background elements -->
                    <div class="absolute inset-0 opacity-10">
                        <div class="absolute top-0 right-0 w-48 h-48 bg-earthy-gold rounded-full blur-3xl"></div>
                        <div class="absolute bottom-0 left-0 w-40 h-40 bg-forest-green rounded-full blur-2xl"></div>
                    </div>
                    <div class="relative">
                        <h2 class="text-4xl font-bold font-lora text-gradient mb-8 drop-shadow-sm">Our Mission</h2>
                        <p class="text-xl leading-relaxed text-charcoal/80">To help you build a powerful morning routine that transforms your life, guided by timeless wisdom and modern self-help principles. We believe that the first hour of your day shapes everything that follows.</p>
                    </div>
                </div>
            </section>

            <!-- Enhanced Contact Section -->
            <section class="text-center">
                <h2 class="text-4xl font-bold text-charcoal font-lora mb-8 text-gradient drop-shadow-sm">Get In Touch</h2>
                <p class="text-xl text-charcoal/80 mb-12 max-w-3xl mx-auto leading-relaxed">Have questions, suggestions, or want to share your morning routine journey? I'd love to hear from you.</p>
                <div class="bg-gradient-to-br from-light-green/40 via-white to-light-green/20 rounded-3xl p-10 max-w-2xl mx-auto shadow-xl border border-light-green/20 relative overflow-hidden">
                    <!-- Subtle background elements -->
                    <div class="absolute inset-0 opacity-5">
                        <div class="absolute top-0 left-0 w-24 h-24 bg-forest-green rounded-full blur-xl"></div>
                        <div class="absolute bottom-0 right-0 w-20 h-20 bg-earthy-gold rounded-full blur-lg"></div>
                    </div>
                    <div class="relative">
                        <p class="text-charcoal/80 mb-6 leading-relaxed">This is a personal project, offered freely for the benefit of all who are curious about building better morning habits and exploring mindful living.</p>
                        <p class="text-sm text-charcoal/60 font-medium">Built with ❤️ and ☕ in the early morning hours</p>
                    </div>
                </div>
            </section>
        </div>
    </template>
    
    <template id="template-privacy">
        <div class="max-w-5xl mx-auto">
            <!-- Enhanced header -->
            <header class="text-center mb-16">
                <h1 class="text-4xl sm:text-5xl font-bold text-forest-green font-lora mb-6 drop-shadow-sm">Privacy Policy</h1>
                <p class="text-xl text-charcoal/80 leading-relaxed max-w-3xl mx-auto">Your privacy matters to us. Here's how we handle your data.</p>
                <p class="mt-4 text-sm text-charcoal/60 font-medium">Last updated: January 2025</p>
                <!-- Decorative line -->
                <div class="mt-8 w-24 h-1 bg-gradient-to-r from-forest-green to-earthy-gold rounded-full mx-auto"></div>
            </header>
            
            <div class="prose prose-lg max-w-none">
                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Overview</h2>
                    <p class="text-charcoal/80 leading-relaxed">The Dhamma Path is designed with privacy in mind. We believe your personal growth journey should remain private, and we've built this platform to respect that principle.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Information We Collect</h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Data Stored Locally</h3>
                            <p class="text-charcoal/80 leading-relaxed">All your personal data is stored locally in your browser, including:</p>
                            <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                                <li>Journal entries and writing sessions</li>
                                <li>Meditation timer preferences and progress</li>
                                <li>Workout completion records</li>
                                <li>Interview practice recordings (stored as local files)</li>
                                <li>Daily progress tracking data</li>
                                <li>Theme preferences (dark/light mode)</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">No Server-Side Data Collection</h3>
                            <p class="text-charcoal/80 leading-relaxed">We do not collect, store, or transmit any of your personal data to external servers. Your information never leaves your device unless you explicitly choose to export it.</p>
                        </div>
                    </div>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">How We Use Your Information</h2>
                    <p class="text-charcoal/80 leading-relaxed">Since all data is stored locally, we use your information only to:</p>
                    <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                        <li>Provide personalized morning routine tracking</li>
                        <li>Remember your preferences and settings</li>
                        <li>Display your progress and streaks</li>
                        <li>Enable features like auto-save and progress persistence</li>
                    </ul>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Data Security</h2>
                    <p class="text-charcoal/80 leading-relaxed">Your data is secured by your browser's built-in security features. We use standard web technologies (localStorage) that are designed to keep your information private and secure on your device.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Third-Party Services</h2>
                    <p class="text-charcoal/80 leading-relaxed">We use minimal third-party services:</p>
                    <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                        <li><strong>Tailwind CSS (CDN):</strong> For styling - no personal data transmitted</li>
                        <li><strong>Google Fonts:</strong> For typography - no personal data transmitted</li>
                        <li><strong>No analytics or tracking:</strong> We don't use Google Analytics, Facebook Pixel, or any other tracking services</li>
                    </ul>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Your Rights</h2>
                    <p class="text-charcoal/80 leading-relaxed">You have complete control over your data:</p>
                    <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                        <li>Export your journal entries and progress data anytime</li>
                        <li>Clear all data by using your browser's "Clear Site Data" feature</li>
                        <li>Delete specific entries through the interface</li>
                        <li>No account required - you can use the site anonymously</li>
                    </ul>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Changes to This Policy</h2>
                    <p class="text-charcoal/80 leading-relaxed">We may update this privacy policy occasionally. Any changes will be reflected on this page with an updated "Last updated" date. Since we don't collect contact information, we'll announce significant changes through the website itself.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Contact</h2>
                    <p class="text-charcoal/80 leading-relaxed">If you have any questions about this privacy policy or how we handle your data, please reach out through the About page. We're committed to transparency and will respond to any concerns.</p>
                </section>

                <div class="bg-light-green rounded-lg p-6 mt-12">
                    <p class="text-charcoal/80 text-center"><strong>Remember:</strong> Your morning routine journey is personal and private. We've designed this platform to keep it that way.</p>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-terms">
        <div class="max-w-5xl mx-auto">
            <!-- Enhanced header -->
            <header class="text-center mb-16">
                <h1 class="text-4xl sm:text-5xl font-bold text-forest-green font-lora mb-6 drop-shadow-sm">Terms of Service</h1>
                <p class="text-xl text-charcoal/80 leading-relaxed max-w-3xl mx-auto">Simple terms for using The Dhamma Path</p>
                <p class="mt-4 text-sm text-charcoal/60 font-medium">Last updated: January 2025</p>
                <!-- Decorative line -->
                <div class="mt-8 w-24 h-1 bg-gradient-to-r from-forest-green to-earthy-gold rounded-full mx-auto"></div>
            </header>
            
            <div class="prose prose-lg max-w-none">
                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Acceptance of Terms</h2>
                    <p class="text-charcoal/80 leading-relaxed">By using The Dhamma Path, you agree to these terms. If you don't agree, please don't use the site. It's that simple.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">What We Provide</h2>
                    <p class="text-charcoal/80 leading-relaxed">The Dhamma Path is a free platform that offers:</p>
                    <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                        <li>Meditation timer with customizable settings</li>
                        <li>Mindful journaling with auto-save functionality</li>
                        <li>7-minute workout with guided exercises</li>
                        <li>Confidence practice with video recording</li>
                        <li>Progress tracking for your morning routine</li>
                        <li>Educational content about Buddhist teachings and mindfulness</li>
                    </ul>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Your Responsibilities</h2>
                    <p class="text-charcoal/80 leading-relaxed">Please use the site responsibly:</p>
                    <ul class="list-disc list-inside ml-6 space-y-1 text-charcoal/80">
                        <li>Use the tools for personal growth and self-improvement</li>
                        <li>Respect the Buddhist teachings and cultural context</li>
                        <li>Don't attempt to hack, damage, or misuse the platform</li>
                        <li>Understand that this is a personal project, not a commercial service</li>
                    </ul>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Content and Intellectual Property</h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Buddhist Teachings</h3>
                            <p class="text-charcoal/80 leading-relaxed">The Buddhist content is based on public domain texts and traditional teachings. We present them respectfully and for educational purposes only.</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Your Content</h3>
                            <p class="text-charcoal/80 leading-relaxed">Your journal entries, recordings, and personal data belong to you. We don't claim ownership of anything you create using our tools.</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Website Code</h3>
                            <p class="text-charcoal/80 leading-relaxed">The website design and functionality are original work. Please don't copy or reproduce without permission.</p>
                        </div>
                    </div>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Disclaimers</h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Health and Wellness</h3>
                            <p class="text-charcoal/80 leading-relaxed">The meditation, exercise, and wellness content is for educational purposes only. Consult healthcare professionals for medical advice. Listen to your body and practice safely.</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Spiritual Guidance</h3>
                            <p class="text-charcoal/80 leading-relaxed">While we present Buddhist teachings respectfully, this is not a substitute for guidance from qualified teachers or spiritual advisors.</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-charcoal mb-2">Technical Issues</h3>
                            <p class="text-charcoal/80 leading-relaxed">We strive for reliability, but this is a personal project. We're not liable for any technical issues, data loss, or service interruptions.</p>
                        </div>
                    </div>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Limitation of Liability</h2>
                    <p class="text-charcoal/80 leading-relaxed">This website is provided "as is" without warranties. We're not responsible for any damages, losses, or issues arising from your use of the platform. Use at your own discretion.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Changes to Terms</h2>
                    <p class="text-charcoal/80 leading-relaxed">We may update these terms occasionally. Continued use of the site after changes constitutes acceptance of the new terms. We'll announce significant changes on the website.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Termination</h2>
                    <p class="text-charcoal/80 leading-relaxed">You can stop using the site anytime. We reserve the right to modify or discontinue the service, though we'll try to give notice for significant changes.</p>
                </section>

                <section class="mb-8">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-4">Contact</h2>
                    <p class="text-charcoal/80 leading-relaxed">Questions about these terms? Reach out through the About page. We're here to help and want to make sure everything is clear.</p>
                </section>

                <div class="bg-light-green rounded-lg p-6 mt-12">
                    <p class="text-charcoal/80 text-center"><strong>Remember:</strong> This is a personal project created to help people build better morning routines. We're not a big corporation - just someone who believes in the power of mindful mornings.</p>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-glossary">
        <div class="max-w-6xl mx-auto">
            <!-- Hero Section with Enhanced Styling -->
            <div class="breathing-bg floating-particles zen-particles ambient-gradient rounded-3xl p-16 sm:p-20 mb-16 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-10 left-10 w-40 h-40 bg-forest-green rounded-full blur-3xl float-animation ambient-breathe"></div>
                    <div class="absolute bottom-10 right-10 w-32 h-32 bg-earthy-gold rounded-full blur-2xl float-animation ambient-float"></div>
                    <div class="absolute top-1/2 left-1/3 w-24 h-24 bg-light-green rounded-full blur-xl float-animation ambient-breathe"></div>
                </div>
                
                <!-- Floating Particles -->
                <div class="floating-particle particle-1" style="left: 12%; animation-delay: 1.5s;"></div>
                <div class="floating-particle particle-2" style="left: 35%; animation-delay: 4.5s;"></div>
                <div class="floating-particle particle-3" style="left: 65%; animation-delay: 7.5s;"></div>
                <div class="floating-particle particle-4" style="left: 88%; animation-delay: 10.5s;"></div>
                
                <header class="text-center relative z-10">
                    <div class="w-24 h-24 bg-gradient-to-br from-forest-green/30 to-earthy-gold/30 rounded-full flex items-center justify-center mx-auto mb-8 icon-breathe">
                        <svg class="w-12 h-12 text-forest-green drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                    </div>
                    <h1 class="text-5xl sm:text-6xl font-bold text-gradient font-lora mb-6 text-glow">Pāli Glossary</h1>
                    <p class="text-xl text-charcoal/80 max-w-3xl mx-auto leading-relaxed mb-8">Deepen your understanding with clear definitions of key Buddhist terms from the ancient Pāli language.</p>
                    <!-- Shimmer divider -->
                    <div class="shimmer-divider w-32 mx-auto"></div>
            </header>
            </div>
            
            <!-- Search and Filter Section -->
            <div class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-8 shadow-xl border border-gray-100 mb-12 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-0 right-0 w-24 h-24 bg-forest-green rounded-full blur-xl float-animation"></div>
                    <div class="absolute bottom-0 left-0 w-16 h-16 bg-earthy-gold rounded-full blur-lg float-animation"></div>
                </div>
                
                <div class="relative z-10">
                    <h2 class="text-2xl font-bold text-charcoal font-lora mb-6 text-center">Find Your Term</h2>
                    <div class="max-w-md mx-auto">
                        <input type="text" id="glossary-search" placeholder="Search for a Pāli term..." class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-forest-green focus:border-forest-green transition-all duration-300 shadow-sm focus:shadow-lg">
                    </div>
                </div>
            </div>
            
            <!-- Glossary Terms Grid -->
            <div id="glossary-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 stagger-in">
                <!-- Glossary terms will be injected here -->
            </div>
            
            <!-- Learning Tips Card -->
            <div class="mt-16 bg-gradient-to-br from-earthy-gold/15 via-white to-earthy-gold/5 rounded-3xl p-10 shadow-xl border border-earthy-gold/20 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-earthy-gold rounded-full blur-2xl float-animation"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-forest-green rounded-full blur-xl float-animation"></div>
                </div>
                
                <div class="text-center relative z-10">
                    <h3 class="text-3xl font-bold text-charcoal font-lora mb-6 text-gradient">Understanding Pāli</h3>
                    <p class="text-lg text-charcoal/70 max-w-3xl mx-auto mb-8">Pāli is the ancient language of the Buddha's teachings. These terms carry deep meaning and can transform your understanding of meditation and mindfulness.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                        <div class="text-left">
                            <h4 class="text-xl font-bold text-charcoal font-lora mb-4 flex items-center">
                                <div class="w-8 h-8 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-white text-sm font-bold">1</span>
                                </div>
                                Pronunciation Guide
                            </h4>
                            <p class="text-charcoal/70 leading-relaxed">Pāli uses simple phonetic pronunciation. Each letter is pronounced as written, with vowels similar to Spanish or Italian.</p>
                        </div>
                        
                        <div class="text-left">
                            <h4 class="text-xl font-bold text-charcoal font-lora mb-4 flex items-center">
                                <div class="w-8 h-8 bg-gradient-to-br from-earthy-gold to-earthy-gold/80 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-white text-sm font-bold">2</span>
                                </div>
                                Context Matters
                            </h4>
                            <p class="text-charcoal/70 leading-relaxed">These terms often have multiple layers of meaning. Understanding the context helps reveal their deeper significance.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="template-search-results">
        <div class="max-w-4xl mx-auto">
            <header class="text-center mb-12">
                <h1 class="text-4xl sm:text-5xl font-bold text-forest-green font-lora">Search Results</h1>
                <p id="search-results-query" class="mt-4 max-w-2xl mx-auto text-xl text-charcoal/80"></p>
            </header>
            <div id="search-results-list" class="space-y-8">
                <!-- Search results will be injected here -->
            </div>
        </div>
    </template>
    
    <template id="template-timer">
        <div class="max-w-4xl mx-auto">
            <!-- Compact Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gradient font-lora mb-4">Meditation Timer</h1>
                <p class="text-lg text-charcoal/80 max-w-2xl mx-auto">Find your center with gentle guidance and peaceful timing</p>
            </div>
            
            <!-- Main Timer Section - Centered and Prominent -->
            <div class="max-w-4xl mx-auto">
                <div class="space-y-8">
            
                    <!-- Enhanced timer ring container with breathing animation -->
                    <div class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-8 shadow-xl border border-gray-100 relative overflow-hidden">
                        <!-- Subtle floating background elements -->
                        <div class="absolute inset-0 opacity-5">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-forest-green rounded-full blur-2xl float-animation"></div>
                            <div class="absolute bottom-0 left-0 w-24 h-24 bg-earthy-gold rounded-full blur-xl float-animation"></div>
                        </div>
                        
                        <div class="text-center relative z-10">
                            <h2 class="text-2xl font-bold text-charcoal font-lora mb-6">Your Meditation Timer</h2>
                            
                            <!-- Timer Ring -->
                            <div id="timer-ring-container" class="relative w-80 h-80 mx-auto mb-8 breathe">
                                <!-- Outer glow effect -->
                                <div class="absolute inset-0 rounded-full bg-gradient-to-r from-forest-green/20 to-earthy-gold/20 blur-xl scale-110 float-animation"></div>
                                
                                <!-- Timer ring -->
                                <div class="relative w-full h-full">
                                    <svg class="w-full h-full drop-shadow-lg" viewBox="0 0 100 100">
                    <circle class="timer-ring-bg" cx="50" cy="50" r="45" stroke-width="8" fill="transparent"></circle>
                    <circle id="timer-progress-ring" class="timer-ring-fg" cx="50" cy="50" r="45" stroke-width="8" fill="transparent" stroke-dasharray="283" stroke-dashoffset="283"></circle>
                </svg>
                                    <div id="timer-display" class="absolute inset-0 flex items-center justify-center text-7xl font-lora text-forest-green font-bold drop-shadow-lg" role="timer" aria-live="polite" aria-label="Meditation timer display">10:00</div>
            </div>
                            </div>
                        </div>
                    </div>
                    <!-- Enhanced timer controls with floating background -->
                    <div id="timer-controls" class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-8 shadow-xl border border-gray-100 relative overflow-hidden ambient-shadow">
                        <!-- Subtle floating background elements -->
                        <div class="absolute inset-0 opacity-5">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-forest-green rounded-full blur-2xl float-animation"></div>
                            <div class="absolute bottom-0 left-0 w-24 h-24 bg-earthy-gold rounded-full blur-xl float-animation"></div>
                        </div>
                <div class="text-center space-y-8">
                    <!-- Session Progress Indicator -->
                    <div id="session-progress" class="hidden">
                        <div class="bg-white/80 dark:bg-gray-800/80 rounded-xl p-4 shadow-lg border border-forest-green/20">
                            <div class="flex items-center justify-between text-sm text-charcoal/70 mb-2">
                                <span>Session Progress</span>
                                <span id="progress-percentage">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div id="progress-bar" class="bg-gradient-to-r from-forest-green to-earthy-gold h-2 rounded-full transition-all duration-1000 ease-out" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Duration Selection -->
                    <div>
                        <div class="text-sm uppercase tracking-wider text-charcoal/70 font-semibold mb-4 block">Meditation Duration</div>
                        <div id="duration-buttons" class="flex flex-wrap justify-center gap-3" role="group" aria-label="Select meditation duration">
                            <button data-duration="5" class="timer-duration-btn px-6 py-3 rounded-full bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-semibold transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 border-forest-green shadow-md focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;" aria-pressed="false" tabindex="0">5 min</button>
                            <button data-duration="10" class="timer-duration-btn px-6 py-3 rounded-full bg-gradient-to-r from-light-green to-light-green/80 text-forest-green transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 border-forest-green shadow-md focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important;" aria-pressed="false" tabindex="0">10 min</button>
                            <button data-duration="15" class="timer-duration-btn px-6 py-3 rounded-full bg-gradient-to-r from-light-green to-light-green/80 text-forest-green transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 border-forest-green shadow-md focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important;" aria-pressed="false" tabindex="0">15 min</button>
                            <button data-duration="20" class="timer-duration-btn px-6 py-3 rounded-full bg-gradient-to-r from-light-green to-light-green/80 text-forest-green transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 border-forest-green shadow-md focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important;" aria-pressed="false" tabindex="0">20 min</button>
                            <button data-duration="30" class="timer-duration-btn px-6 py-3 rounded-full bg-gradient-to-r from-light-green to-light-green/80 text-forest-green transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 border-forest-green shadow-md focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important;" aria-pressed="false" tabindex="0">30 min</button>
                        </div>
                    </div>
                    
                    <!-- Sound Selection -->
                     <div>
                        <label for="sound-select" class="text-sm uppercase tracking-wider text-charcoal/70 font-semibold mb-4 block">Meditation Bell</label>
                        <select id="sound-select" class="w-full max-w-xs mx-auto p-4 border-2 border-gray-200 rounded-xl bg-white dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-earthy-gold focus:border-earthy-gold focus:outline-none transition-all duration-300 shadow-sm" aria-label="Select meditation bell sound">
                            <option value="chime">🔔 Gentle Chime</option>
                            <option value="bowl">🪷 Tibetan Singing Bowl</option>
                            <option value="wood">🪵 Wooden Meditation Block</option>
                        </select>
                    </div>

                    <!-- Session Controls -->
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                        <button id="timer-start-btn" class="px-12 py-6 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-xl shadow-xl border-2 border-forest-green focus:ring-4 focus:ring-earthy-gold focus:outline-none" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;" aria-label="Start meditation session">
                            <span class="flex items-center space-x-3">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>Begin Meditation</span>
                            </span>
                        </button>
                        
                        <button id="timer-pause-btn" class="px-12 py-6 bg-gradient-to-r from-earthy-gold to-earthy-gold/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-xl shadow-xl border-2 border-earthy-gold hidden focus:ring-4 focus:ring-forest-green focus:outline-none" style="background-color: #b8860b !important; color: white !important; display: inline-block !important; visibility: visible !important;" aria-label="Pause meditation session">
                            <span class="flex items-center space-x-3">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>Pause Session</span>
                            </span>
                        </button>
                        
                        <button id="timer-reset-btn" class="px-8 py-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg border-2 border-gray-600 focus:ring-4 focus:ring-gray-400 focus:outline-none" style="background-color: #4b5563 !important; color: white !important; display: inline-block !important; visibility: visible !important;" aria-label="Reset meditation timer">
                            <span class="flex items-center space-x-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0120.5 15M20 20l-1.5-1.5A9 9 0 003.5 9"></path>
                                </svg>
                                <span>Reset</span>
                            </span>
                    </button>
                </div>

                    <!-- Session Status -->
                    <div id="session-status" class="hidden">
                        <div class="bg-gradient-to-r from-forest-green/10 to-earthy-gold/10 rounded-xl p-4 border border-forest-green/20">
                            <p class="text-charcoal/80 text-sm">
                                <span class="font-semibold">Session Active:</span> 
                                <span id="session-time-remaining">10:00</span> remaining
                            </p>
            </div>
                    </div>
                </div>
                
            </div>
                </div>
                
                <!-- Practice Log Card - Moved below timer -->
                <div class="bg-gradient-to-br from-light-green/30 to-light-green/10 rounded-2xl p-8 shadow-xl border border-light-green/20 relative overflow-hidden card-breathe-gentle ambient-shadow">
                    <div class="relative z-10">
                        <h3 class="text-3xl font-bold text-charcoal font-lora mb-6 text-gradient text-center">📊 Practice Log</h3>
                        <div id="practice-log" class="text-left"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-path">
        <div class="max-w-6xl mx-auto">
            <!-- Hero Section with Enhanced Styling -->
            <div class="breathing-bg floating-particles zen-particles ambient-gradient rounded-3xl p-16 sm:p-20 mb-16 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-10 left-10 w-40 h-40 bg-forest-green rounded-full blur-3xl float-animation ambient-breathe"></div>
                    <div class="absolute bottom-10 right-10 w-32 h-32 bg-earthy-gold rounded-full blur-2xl float-animation ambient-float"></div>
                    <div class="absolute top-1/2 left-1/3 w-24 h-24 bg-light-green rounded-full blur-xl float-animation ambient-breathe"></div>
                </div>
                
                <!-- Floating Particles -->
                <div class="floating-particle particle-1" style="left: 20%; animation-delay: 1s;"></div>
                <div class="floating-particle particle-2" style="left: 40%; animation-delay: 4s;"></div>
                <div class="floating-particle particle-3" style="left: 60%; animation-delay: 7s;"></div>
                <div class="floating-particle particle-4" style="left: 80%; animation-delay: 10s;"></div>
                
                <header class="text-center relative z-10">
                    <p class="text-earthy-gold font-semibold uppercase tracking-wider text-lg mb-4">Guided Learning Path</p>
                    <h1 id="path-title" class="text-5xl sm:text-6xl font-bold text-gradient font-lora mb-6 text-glow"></h1>
                    <p id="path-description" class="text-xl text-charcoal/80 max-w-3xl mx-auto leading-relaxed mb-8"></p>
                    <!-- Shimmer divider -->
                    <div class="shimmer-divider w-32 mx-auto"></div>
            </header>
            </div>
            
            <!-- Learning Path Steps with Enhanced Design -->
            <div class="space-y-8">
                <div id="path-steps-list" class="space-y-6 stagger-in">
                <!-- Path steps will be injected here -->
                </div>
            </div>
            
            <!-- Progress Summary Card -->
            <div class="mt-16 bg-gradient-to-br from-light-green/20 via-white to-earthy-gold/10 rounded-3xl p-10 shadow-xl border border-light-green/20 relative overflow-hidden card-breathe-gentle ambient-shadow">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-forest-green rounded-full blur-2xl float-animation"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-earthy-gold rounded-full blur-xl float-animation"></div>
                </div>
                
                <div class="text-center relative z-10">
                    <h3 class="text-3xl font-bold text-charcoal font-lora mb-6 text-gradient">Your Learning Journey</h3>
                    <p class="text-lg text-charcoal/70 max-w-2xl mx-auto mb-8">Each step builds upon the last, creating a solid foundation for your understanding and practice.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                        <div class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-6 shadow-lg border border-gray-100">
                            <div class="w-16 h-16 bg-gradient-to-br from-forest-green to-forest-green/80 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                            <h4 class="text-xl font-bold text-charcoal font-lora mb-2">Foundation</h4>
                            <p class="text-charcoal/70 text-sm">Build your understanding from the ground up</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-6 shadow-lg border border-gray-100">
                            <div class="w-16 h-16 bg-gradient-to-br from-earthy-gold to-earthy-gold/80 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h4 class="text-xl font-bold text-charcoal font-lora mb-2">Practice</h4>
                            <p class="text-charcoal/70 text-sm">Apply your knowledge through mindful practice</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-6 shadow-lg border border-gray-100">
                            <div class="w-16 h-16 bg-gradient-to-br from-light-green to-light-green/80 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-forest-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h4 class="text-xl font-bold text-charcoal font-lora mb-2">Integration</h4>
                            <p class="text-charcoal/70 text-sm">Integrate wisdom into your daily life</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-workout">
        <div class="max-w-7xl mx-auto">
            <!-- Compact Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gradient font-lora mb-4">7-Minute Mindful Workout</h1>
                <p class="text-lg text-charcoal/80 max-w-2xl mx-auto">Strengthen your body and mind with efficient circuit training</p>
            </div>
            
            <!-- Enhanced Workout Settings -->
            <div class="bg-gradient-to-br from-light-green/40 via-white to-light-green/20 rounded-2xl p-8 shadow-xl border border-light-green/20 mb-10 relative overflow-hidden">
                <!-- Subtle background elements with floating animation -->
                <div class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-bl from-forest-green/10 to-transparent rounded-full blur-2xl float-animation"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-earthy-gold/10 to-transparent rounded-full blur-xl float-animation"></div>
                
                <div class="flex flex-col lg:flex-row justify-between items-center space-y-6 lg:space-y-0 relative">
                    <div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-8">
                        <div class="flex items-center space-x-3">
                            <label class="flex items-center space-x-3 cursor-pointer p-3 rounded-xl hover:bg-white/50 transition-all duration-300">
                                <input type="checkbox" id="workout-double-mode" class="h-5 w-5 rounded text-forest-green focus:ring-forest-green focus:ring-2">
                                <span class="font-semibold text-charcoal">14-Minute Mode</span>
                 </label>
            </div>
                        <div class="flex items-center space-x-4">
                            <label for="workout-sound" class="text-sm font-semibold text-charcoal">Sound:</label>
                            <select id="workout-sound" class="px-4 py-2 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-earthy-gold focus:border-earthy-gold focus:outline-none dark:bg-gray-800 dark:border-gray-600 bg-white shadow-sm transition-all duration-300">
                                <option value="on">🔊 On</option>
                                <option value="off">🔇 Off</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex items-center space-x-6">
                        <div class="text-center">
                            <div class="text-sm font-semibold text-charcoal mb-2">Progress</div>
                            <div class="text-lg font-bold text-forest-green" id="workout-progress-text">Exercise 1 of 12</div>
                        </div>
                        <div class="w-40 bg-gradient-to-r from-gray-200 to-gray-100 rounded-full h-3 shadow-inner border border-gray-200/50">
                            <div id="workout-progress-bar" class="bg-gradient-to-r from-forest-green via-light-green to-earthy-gold h-3 rounded-full transition-all duration-500 shadow-lg" style="width: 0%">
                                <!-- Animated shimmer effect -->
                                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Workout Display - Single Column -->
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Exercise Visual - Centered -->
                <div class="text-center">
                    <div id="workout-visual" class="bg-gradient-to-br from-light-green/40 via-white to-light-green/20 rounded-2xl p-10 flex items-center justify-center h-80 mx-auto shadow-xl border border-light-green/20 relative overflow-hidden max-w-md">
                        <!-- Subtle background elements -->
                        <div class="absolute inset-0 opacity-5">
                            <div class="absolute top-4 right-4 w-24 h-24 bg-forest-green rounded-full blur-2xl"></div>
                            <div class="absolute bottom-4 left-4 w-20 h-20 bg-earthy-gold rounded-full blur-xl"></div>
                        </div>
                    <!-- SVG Animation will be injected here -->
                </div>
                    
                    <!-- Exercise Instructions -->
                    <div id="workout-instructions" class="mt-6 p-6 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl shadow-lg border border-gray-100 max-w-2xl mx-auto">
                        <h3 class="text-xl font-bold text-charcoal mb-4 flex items-center justify-center space-x-2">
                            <svg class="w-6 h-6 text-forest-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span>Instructions</span>
                        </h3>
                        <p id="workout-instruction-text" class="text-charcoal/80 leading-relaxed text-lg text-center">Get ready to start with jumping jacks. Stand with feet together and arms at your sides.</p>
                    </div>
                    </div>

                <!-- Workout Controls - Centered -->
                <div class="text-center">
                    <div id="workout-display" class="p-10 bg-gradient-to-br from-light-green/40 via-white to-light-green/20 rounded-2xl shadow-xl border border-light-green/20 relative overflow-hidden">
                        <!-- Subtle background elements -->
                        <div class="absolute inset-0 opacity-5">
                            <div class="absolute top-0 left-0 w-32 h-32 bg-forest-green rounded-full blur-2xl"></div>
                            <div class="absolute bottom-0 right-0 w-28 h-28 bg-earthy-gold rounded-full blur-xl"></div>
                        </div>
                        
                        <div class="text-center relative">
                            <p id="workout-status" class="text-xl font-bold text-earthy-gold uppercase tracking-wider mb-4 drop-shadow-sm">Get Ready!</p>
                            <h2 id="workout-exercise" class="text-5xl font-bold font-lora text-charcoal mb-6 drop-shadow-sm">Jumping Jacks</h2>
                            <div id="workout-timer" class="text-9xl font-lora text-forest-green mb-6 drop-shadow-lg">10</div>
                            <div id="workout-phase" class="text-xl text-charcoal/70 font-medium">Rest</div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Next Exercise -->
                    <div id="workout-next" class="text-center mt-8 p-6 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl shadow-lg border border-gray-100">
                        <span class="text-sm text-charcoal/60 font-medium">Next up:</span>
                        <div id="workout-next-exercise" class="text-xl font-bold text-charcoal mt-1">Wall Sit</div>
                    </div>
                    
                    <!-- Enhanced Workout Controls -->
                    <div id="workout-controls" class="mt-10 flex items-center justify-center space-x-6">
                        <button id="workout-back-btn" class="p-4 bg-gradient-to-r from-gray-200 to-gray-100 text-charcoal rounded-full hover:shadow-lg hover:scale-110 transition-all duration-300 dark:bg-gray-700 dark:hover:bg-gray-600 border border-gray-300" title="Previous Exercise">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>
                        </button>
                        <button id="workout-start-btn" class="px-12 py-6 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-2xl shadow-xl border-2 border-forest-green" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                            <span class="flex items-center space-x-3">
                                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                <span>Begin Workout</span>
                            </span>
                        </button>
                        <button id="workout-pause-btn" class="px-10 py-5 bg-gradient-to-r from-earthy-gold to-earthy-gold/90 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-xl hidden shadow-lg border-2 border-earthy-gold" style="background-color: #b8860b !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #b8860b !important;">
                            <span class="flex items-center space-x-2">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>Pause Session</span>
                            </span>
                        </button>
                        <button id="workout-forward-btn" class="p-4 bg-gradient-to-r from-gray-200 to-gray-100 text-charcoal rounded-full hover:shadow-lg hover:scale-110 transition-all duration-300 dark:bg-gray-700 dark:hover:bg-gray-600 border border-gray-300" title="Next Exercise">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg>
                        </button>
                    </div>
                    
                    <!-- Enhanced Workout Stats -->
                    <div id="workout-stats" class="mt-10 grid grid-cols-3 gap-6 text-center">
                        <div class="p-6 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
                            <div id="workout-total-time" class="text-3xl font-bold text-forest-green mb-2">0:00</div>
                            <div class="text-sm text-charcoal/70 font-medium">Total Time</div>
                </div>
                        <div class="p-6 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
                            <div id="workout-calories" class="text-3xl font-bold text-earthy-gold mb-2">0</div>
                            <div class="text-sm text-charcoal/70 font-medium">Calories</div>
                        </div>
                        <div class="p-6 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
                            <div id="workout-completed" class="text-3xl font-bold text-forest-green mb-2">0/12</div>
                            <div class="text-sm text-charcoal/70 font-medium">Completed</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-interview">
        <div class="max-w-6xl mx-auto">
            <!-- Compact Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gradient font-lora mb-4">Morning Confidence Practice</h1>
                <p class="text-lg text-charcoal/80 max-w-2xl mx-auto">Practice speaking skills and build self-assurance</p>
            </div>
            
            <!-- Enhanced Practice Options -->
            <div class="bg-gradient-to-br from-earthy-gold/15 via-white to-earthy-gold/5 rounded-2xl p-8 shadow-lg border border-earthy-gold/20 mb-10 relative overflow-hidden">
                <!-- Subtle background elements with floating animation -->
                <div class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-bl from-earthy-gold/10 to-transparent rounded-full blur-2xl float-animation"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-forest-green/10 to-transparent rounded-full blur-xl float-animation"></div>
                
                <div class="text-center mb-8 relative">
                    <h3 class="text-xl font-bold text-charcoal mb-2 drop-shadow-sm">Choose Your Confidence Practice</h3>
                    <p class="text-sm text-charcoal/70">Select a category to practice different speaking skills</p>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <button data-category="general" class="interview-cat-btn px-6 py-4 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-sm shadow-lg border-2 border-forest-green" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #2d5016 !important;">Daily Life</button>
                    <button data-category="storytelling" class="interview-cat-btn px-6 py-4 bg-gradient-to-r from-earthy-gold to-earthy-gold/90 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-sm shadow-lg border-2 border-earthy-gold" style="background-color: #b8860b !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #b8860b !important;">Storytelling</button>
                    <button data-category="communication" class="interview-cat-btn px-6 py-4 bg-gradient-to-r from-light-green to-light-green/80 text-forest-green font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-sm shadow-lg border-2 border-forest-green" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important; border: 2px solid #2d5016 !important;">Communication</button>
                    <button data-category="creativity" class="interview-cat-btn px-6 py-4 bg-gradient-to-r from-forest-green to-forest-green/80 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-sm shadow-lg border-2 border-forest-green" style="background-color: #4A6C55 !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #4A6C55 !important;">Creativity</button>
                </div>
                <div class="text-center">
                    <button id="random-question-btn" class="px-10 py-4 bg-gradient-to-r from-earthy-gold to-earthy-gold/80 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg border-2 border-earthy-gold" style="background-color: #B98B4C !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #B98B4C !important;">🎲 Random Question</button>
                </div>
            </div>

            <!-- Enhanced Question Box -->
            <div id="interview-question-box" class="p-10 bg-gradient-to-br from-earthy-gold/20 via-white to-earthy-gold/10 rounded-2xl text-center mb-10 shadow-xl border border-earthy-gold/20 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute inset-0 opacity-5">
                    <div class="absolute top-0 left-0 w-32 h-32 bg-earthy-gold rounded-full blur-2xl"></div>
                    <div class="absolute bottom-0 right-0 w-24 h-24 bg-forest-green rounded-full blur-xl"></div>
                </div>
                <h2 id="interview-question" class="text-3xl font-lora text-earthy-gold relative drop-shadow-sm">Tell me about yourself.</h2>
            </div>
            
            <!-- Main Practice Area - Single Column -->
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Recording Section - Centered -->
                <div class="text-center">
                    <h3 class="text-2xl font-bold font-lora text-charcoal mb-6 drop-shadow-sm">Your Camera</h3>
                    <div id="recorder-section">
                        <div class="relative bg-gradient-to-br from-gray-200 to-gray-100 dark:bg-gray-800 rounded-2xl overflow-hidden shadow-xl border border-gray-200">
                            <div class="video-container">
                                <video id="live-video" class="w-full h-full" autoplay muted></video>
                            </div>
                            <div id="camera-error" class="hidden absolute inset-0 bg-black/70 text-white flex flex-col items-center justify-center p-6 rounded-2xl">
                                <h4 class="font-bold text-xl mb-2">Camera Error</h4>
                                <p class="text-sm text-center">Could not access camera and microphone. Please check your browser permissions and try again.</p>
                            </div>
                        </div>
                        <div id="recorder-controls" class="mt-8 flex items-center justify-center space-x-6">
                            <button id="start-recording-btn" class="px-12 py-6 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-xl shadow-xl border-2 border-forest-green" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                                <span class="flex items-center space-x-3">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                    <span>Start Morning Practice</span>
                                </span>
                            </button>
                            <button id="stop-recording-btn" class="px-10 py-5 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-lg hidden shadow-lg border-2 border-red-600" style="background-color: #dc2626 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                                <span class="flex items-center space-x-2">
                                    <span class="w-3 h-3 bg-white rounded-full recording-dot"></span>
                                    <span>End Recording</span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Playback Section - Centered -->
                <div class="text-center">
                    <h3 class="text-2xl font-bold font-lora text-charcoal mb-6 drop-shadow-sm">Session Recordings</h3>
                    <div id="playback-section" class="space-y-6">
                         <div id="no-recordings-message" class="text-center p-10 bg-gradient-to-br from-light-green/30 to-light-green/10 rounded-2xl text-charcoal/70 shadow-lg border border-light-green/20">
                             <div class="flex flex-col items-center space-y-3">
                                 <svg class="w-12 h-12 text-light-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                 </svg>
                                 <p class="text-lg font-medium">Your recordings for this session will appear here.</p>
                             </div>
                         </div>
                         <div id="recordings-list"></div>
                         <div class="relative bg-gradient-to-br from-gray-200 to-gray-100 dark:bg-gray-800 rounded-2xl overflow-hidden hidden shadow-xl border border-gray-200" id="playback-video-container">
                             <div class="video-container">
                                 <video id="playback-video" class="w-full h-full" controls></video>
                             </div>
                         </div>
                         <div id="interview-feedback" class="hidden text-center p-4 bg-light-green rounded-lg text-charcoal/80 mt-4"></div>
                    </div>
                </div>
            </div>
            
            <!-- Enhanced Question Navigation -->
            <div class="text-center mt-12 space-y-6">
                <div class="flex justify-center space-x-6">
                    <button id="next-question-btn" class="px-10 py-5 bg-gradient-to-r from-earthy-gold to-earthy-gold/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-lg shadow-xl border-2 border-earthy-gold" style="background-color: #b8860b !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                        <span class="flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0120.5 15M20 20l-1.5-1.5A9 9 0 003.5 9"></path>
                            </svg>
                            <span>Next Question</span>
                        </span>
                    </button>
                    <button id="previous-question-btn" class="px-10 py-5 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-lg shadow-xl border-2 border-gray-600" style="background-color: #4b5563 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                        <span class="flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                            <span>Previous</span>
                        </span>
                    </button>
                </div>
                <p class="text-sm text-charcoal/70 font-medium">Click to change your practice prompt</p>
            </div>
        </div>
    </template>
    
    <template id="template-journal">
        <div class="max-w-5xl mx-auto">
            <!-- Compact Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gradient font-lora mb-4">Mindful Freewriting</h1>
                <p class="text-lg text-charcoal/80 max-w-2xl mx-auto">Let your thoughts flow freely - everything saves automatically</p>
            </div>

            <!-- Enhanced Quick Morning Presets -->
            <div class="bg-gradient-to-br from-earthy-gold/15 via-white to-earthy-gold/5 rounded-2xl p-8 mb-8 shadow-lg border border-earthy-gold/20 relative overflow-hidden">
                <!-- Subtle background elements with floating animation -->
                <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-earthy-gold/10 to-transparent rounded-full blur-2xl float-animation"></div>
                <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-forest-green/10 to-transparent rounded-full blur-xl float-animation"></div>
                
                <div class="text-center mb-6 relative">
                    <h3 class="text-xl font-bold text-charcoal mb-2 drop-shadow-sm">Quick Morning Presets</h3>
                    <p class="text-sm text-charcoal/70">Choose your writing session length</p>
                </div>
                <div class="flex flex-wrap justify-center gap-4">
                    <button class="quick-preset-btn px-6 py-3 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg border-2 border-forest-green text-sm" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #2d5016 !important;" data-duration="300">⚡ 5 min</button>
                    <button class="quick-preset-btn px-6 py-3 bg-gradient-to-r from-earthy-gold to-earthy-gold/90 text-white font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg border-2 border-earthy-gold text-sm" style="background-color: #b8860b !important; color: white !important; display: inline-block !important; visibility: visible !important; border: 2px solid #b8860b !important;" data-duration="600">🌟 10 min</button>
                    <button class="quick-preset-btn px-6 py-3 bg-gradient-to-r from-light-green to-light-green/80 text-forest-green font-semibold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg border-2 border-forest-green text-sm" style="background-color: #d4edda !important; color: #2d5016 !important; display: inline-block !important; visibility: visible !important; border: 2px solid #2d5016 !important;" data-duration="900">🧘 15 min</button>
                </div>
            </div>

            <!-- Enhanced timer and controls -->
            <div class="bg-gradient-to-br from-light-green/40 via-white to-light-green/20 rounded-2xl p-8 shadow-xl border border-light-green/20 mb-8 relative overflow-hidden">
                <!-- Subtle background elements -->
                <div class="absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-forest-green/10 to-transparent rounded-full blur-2xl"></div>
                <div class="absolute bottom-0 right-0 w-32 h-32 bg-gradient-to-tl from-earthy-gold/10 to-transparent rounded-full blur-xl"></div>
                
                <div class="flex flex-col lg:flex-row justify-between items-center mb-8 space-y-6 lg:space-y-0 relative">
                    <div class="flex items-center space-x-6">
                        <div class="text-center">
                            <div id="journal-timer" class="text-5xl font-lora text-forest-green font-bold drop-shadow-sm">10:00</div>
                            <div class="text-sm text-charcoal/70 font-medium">remaining</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <label for="timer-duration" class="text-sm font-semibold text-charcoal">Custom Duration:</label>
                        <select id="timer-duration" class="px-6 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-earthy-gold focus:border-earthy-gold focus:outline-none dark:bg-gray-800 dark:border-gray-600 bg-white shadow-sm transition-all duration-300">
                            <option value="300">5 minutes</option>
                            <option value="600" selected>10 minutes</option>
                            <option value="900">15 minutes</option>
                            <option value="1200">20 minutes</option>
                            <option value="1800">30 minutes</option>
                            <option value="3600">1 hour</option>
                        </select>
                    </div>
                    <button id="journal-start-btn" class="ripple hover-soft px-12 py-5 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-xl shadow-xl border-2 border-forest-green w-full lg:w-auto" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                        <span class="flex items-center justify-center space-x-3">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                            </svg>
                            <span>Begin Freewriting</span>
                        </span>
                    </button>
                </div>
                <textarea id="journal-entry" placeholder="Let your thoughts flow freely... the timer will begin as soon as you start typing." class="w-full h-80 p-6 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-earthy-gold focus:border-earthy-gold focus:outline-none dark:bg-gray-800 dark:border-gray-600 shadow-sm transition-all duration-300" style="font-family: 'Lora', serif; font-size: 1.1rem; line-height: 1.8;"></textarea>
                
                <!-- Save Button -->
                <div class="mt-6 flex justify-center">
                    <button id="journal-save-btn" class="px-8 py-4 bg-gradient-to-r from-forest-green to-forest-green/90 text-white font-bold rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 text-lg shadow-lg border-2 border-forest-green hidden" style="background-color: #2d5016 !important; color: white !important; display: inline-block !important; visibility: visible !important;">
                        <span class="flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            <span>Save Entry</span>
                        </span>
                    </button>
                </div>
            </div>

            <!-- Enhanced journal history -->
            <div id="journal-history" class="mt-16">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-charcoal font-lora mb-4 drop-shadow-sm">Your Entries</h2>
                    <p class="text-charcoal/70">Reflect on your journey of self-discovery</p>
                    <!-- Decorative line -->
                    <div class="mt-4 w-16 h-1 bg-gradient-to-r from-forest-green to-earthy-gold rounded-full mx-auto"></div>
                </div>
                <div id="journal-history-list" class="space-y-6">
                    <!-- Saved entries will be injected here -->
                </div>
            </div>
        </div>
    </template>


    <script>
    // --- DATABASE --- //
    const db = {
        articles: {
            "what-is-theravada": {
                title: "What Is Theravāda Buddhism? A Simple Guide",
                category: "Introduction",
                categoryId: "introduction",
                date: "September 10, 2025",
                readTime: 8,
                author: "Alan Dhamma",
                tags: ["theravada", "buddhism", "introduction"],
                content: `
                    <p><span class="pali-term" data-term="theravada">Theravāda</span>, which means "The Way of the Elders" in the Pāli language, is the oldest surviving school of Buddhism. It is widely considered to be the most faithful representation of the original teachings of Siddhartha Gautama, the Buddha. For over two millennia, its traditions have been passed down from teacher to student, preserving a path of wisdom that is both profound and practical.</p>
                    <h2>The Foundation: The Pāli Canon</h2>
                    <p>The core of Theravāda Buddhism is the Pāli Canon, the most complete and earliest collection of the Buddha's discourses. This vast body of texts, known as the Tipiṭaka (or "Three Baskets"), is organized into three main sections:</p>
                    <ul>
                        <li><strong>Vinaya Piṭaka:</strong> The code of monastic discipline for monks and nuns.</li>
                        <li><strong>Sutta Piṭaka:</strong> The collection of discourses and sermons delivered by the Buddha and his senior disciples. This is the heart of the teachings.</li>
                        <li><strong>Abhidhamma Piṭaka:</strong> A detailed philosophical and psychological analysis of the nature of mind and matter.</li>
                    </ul>
                    <p>Unlike some other Buddhist schools, Theravāda does not recognize later scriptures or sutras as canonical. It holds that the path to liberation is found within these original teachings.</p>
                    <blockquote>"Ardently do today what must be done. Who knows? Tomorrow, death comes."</blockquote>
                    <h2>Core Beliefs: The Three Marks of Existence</h2>
                    <p>At the heart of Theravāda philosophy are the Three Marks of Existence (Tilakkhaṇa), the fundamental characteristics of all conditioned phenomena:</p>
                    <ol>
                        <li><strong><span class="pali-term" data-term="anicca">Anicca</span> (Impermanence):</strong> Everything is in a constant state of flux. Nothing lasts forever.</li>
                        <li><strong><span class="pali-term" data-term="dukkha">Dukkha</span> (Unsatisfactoriness):</strong> Because things are impermanent, clinging to them inevitably leads to suffering or a subtle sense of dissatisfaction.</li>
                        <li><strong><span class="pali-term" data-term="anatta">Anattā</span> (Not-Self):</strong> There is no permanent, unchanging, independent self or soul. What we call "I" is merely a temporary combination of physical and mental components.</li>
                    </ol>
                    <div class="call-out-box">
                        <p><strong>Key Takeaway:</strong> Understanding these three truths on an experiential level, not just an intellectual one, is the key to liberation in Theravāda Buddhism. This insight is cultivated through meditation.</p>
                    </div>
                    <h2>The Path to Liberation: The Noble Eightfold Path</h2>
                    <p>The Buddha taught that the way to end suffering is to follow the Noble Eightfold Path. This isn't a linear sequence of steps, but rather eight interconnected factors that should be developed simultaneously. They are grouped into three divisions: Wisdom (<span class="pali-term" data-term="panna">Paññā</span>), Ethical Conduct (Sīla), and Mental Discipline (<span class="pali-term" data-term="samadhi">Samādhi</span>).</p>
                    <p>By cultivating this path, practitioners aim to achieve the ultimate goal: <span class="pali-term" data-term="nibbana">Nibbāna</span> (Nirvana), the complete cessation of suffering and the cycle of rebirth.</p>
                `
            },
            "vipassana-guide": {
                title: "How to Practice Vipassanā: A Beginner's Guide",
                category: "Meditation",
                categoryId: "meditation",
                date: "September 8, 2025",
                readTime: 10,
                author: "Jane Bodhi",
                tags: ["meditation", "vipassana", "mindfulness", "guide"],
                audioSrc: null, // Audio will be generated programmatically
                content: `
                    <p><span class="pali-term" data-term="vipassana">Vipassanā</span>, which means "to see things as they really are," is one of India's most ancient meditation techniques. It is a process of self-observation, a journey to the common root of mind and body that dissolves mental impurity, resulting in a balanced mind full of love and compassion.</p>
                    <h2>Preparing for Your Practice</h2>
                    <p>Before you begin, find a quiet place where you won't be disturbed for 15-20 minutes. Sit in a comfortable position, either on a cushion on the floor with your legs crossed or upright in a chair with your feet flat on the ground. The key is to keep your back straight but not stiff. Close your eyes gently.</p>
                    <h2>The Practice: Mindfulness of Breath (<span class="pali-term" data-term="anapanasati">Ānāpānasati</span>)</h2>
                    <p>The foundation of Vipassanā practice is mindfulness of breath. This is your anchor to the present moment.</p>
                    <ol>
                        <li><strong>Bring your attention to your breath.</strong> Observe the natural, normal sensation of the breath as it enters and leaves your nostrils. Don't try to control or change it. Just observe.</li>
                        <li><strong>Focus on the sensation.</strong> Notice the feeling of the air touching the inside of your nostrils or the area of your upper lip. Stay with this sensation.</li>
                        <li><strong>When the mind wanders, gently bring it back.</strong> And it will wander. Thoughts, sounds, or physical sensations will pull your attention away. This is normal. The moment you realize your mind has wandered, without any judgment or frustration, gently guide your attention back to the sensation of the breath.</li>
                    </ol>
                    <blockquote>"The breath is the bridge which connects life to consciousness, which unites your body to your thoughts."</blockquote>
                    <h2>Expanding Awareness: Body Scan</h2>
                    <p>Once you have developed some stability with the breath, you can begin to expand your awareness to the entire body. Systematically move your attention through your body, from the top of your head to the tips of your toes, observing whatever sensations arise.</p>
                    <p>You might feel tingling, warmth, pressure, or nothing at all. Whatever the sensation, simply observe it with a balanced, equanimous mind. The goal is to understand the impermanent nature of all sensations without reacting to them with craving or aversion.</p>
                    <div class="call-out-box">
                        <p><strong>Key Insight:</strong> The practice is not about having pleasant sensations. It's about developing equanimity—the ability to observe your experience without being controlled by it.</p>
                    </div>
                    <p>End your session by taking a few moments to sit quietly, letting go of the technique. Then, when you are ready, gently open your eyes.</p>
                `
            },
            "four-noble-truths": {
                title: "The Four Noble Truths Explained",
                category: "Core Teachings",
                categoryId: "teachings",
                date: "September 5, 2025",
                readTime: 7,
                author: "Alan Dhamma",
                tags: ["theravada", "teachings", "four noble truths", "dukkha"],
                content: `
                    <p>The Four Noble Truths are the very first teaching the Buddha gave after his enlightenment. They are the foundation of all Buddhist traditions and provide a framework for understanding the nature of our experience and the path to liberation.</p>
                    <h2>1. The Truth of Suffering (<span class="pali-term" data-term="dukkha">Dukkha</span>)</h2>
                    <p>The first truth acknowledges that life inevitably contains suffering. This isn't a pessimistic view but a realistic one. It includes obvious suffering like pain, old age, and sickness, but also more subtle forms of dissatisfaction, like the stress of not getting what we want or the anxiety of holding onto what we have.</p>
                    <h2>2. The Truth of the Origin of Suffering (Samudāya)</h2>
                    <p>The second truth identifies the cause of suffering: craving and clinging (Taṇhā). We suffer because we cling to things, ideas, and even our sense of self, wishing they were permanent when they are not. This craving comes in three forms:</p>
                    <ul>
                        <li>Craving for sense pleasures.</li>
                        <li>Craving for existence and becoming.</li>
                        <li>Craving for non-existence.</li>
                    </ul>
                    <blockquote>"The root of suffering is attachment."</blockquote>
                    <h2>3. The Truth of the Cessation of Suffering (Nirodhha)</h2>
                    <p>The third truth is the good news: there is an end to suffering. By eliminating craving and clinging, we can attain <span class="pali-term" data-term="nibbana">Nibbāna</span> (Nirvana), a state of profound peace, freedom, and the complete cessation of Dukkha.</p>
                    <h2>4. The Truth of the Path to the Cessation of Suffering (Magga)</h2>
                    <p>The fourth and final truth lays out the practical method for ending suffering: The Noble Eightfold Path. This is the prescription for the ailment of Dukkha. By cultivating wisdom, ethical conduct, and mental discipline, we systematically uproot the causes of our dissatisfaction and move towards liberation.</p>
                `
            },
            "noble-eightfold-path": {
                title: "The Noble Eightfold Path: A Practical Guide",
                category: "Core Teachings",
                categoryId: "teachings",
                date: "September 1, 2025",
                readTime: 9,
                author: "Alan Dhamma",
                tags: ["teachings", "eightfold path", "ethics", "meditation"],
                content: `
                    <p>The Noble Eightfold Path is the Buddha's practical prescription for ending suffering. It is not a set of rules, but a group of eight interconnected factors that, when developed together, lead to wisdom, peace, and liberation.</p>
                    <h2>Division 1: Wisdom (<span class="pali-term" data-term="panna">Paññā</span>)</h2>
                    <ol>
                        <li><strong>Right Understanding (Sammā Diṭṭhi):</strong> Seeing things as they truly are, which begins with understanding the Four Noble Truths.</li>
                        <li><strong>Right Intention (Sammā Saṅkappa):</strong> Cultivating intentions of renunciation, goodwill, and harmlessness.</li>
                    </ol>
                    <h2>Division 2: Ethical Conduct (Sīla)</h2>
                    <ol start="3">
                        <li><strong>Right Speech (Sammā Vācā):</strong> Abstaining from lying, divisive speech, harsh speech, and idle chatter.</li>
                        <li><strong>Right Action (Sammā Kammanta):</strong> Abstaining from killing, stealing, and sexual misconduct.</li>
                        <li><strong>Right Livelihood (Sammā Ājīva):</strong> Earning a living in a way that does not harm others.</li>
                    </ol>
                    <h2>Division 3: Mental Discipline (<span class="pali-term" data-term="samadhi">Samādhi</span>)</h2>
                    <ol start="6">
                        <li><strong>Right Effort (Sammā Vāyāma):</strong> Actively preventing unwholesome states and cultivating wholesome ones.</li>
                        <li><strong>Right Mindfulness (Sammā Sati):</strong> Developing bare awareness of the body, feelings, mind, and mental objects.</li>
                        <li><strong>Right Concentration (Sammā Samādhi):</strong> Developing one-pointedness of mind, often through meditation, leading to deep states of calm and insight.</li>
                    </ol>
                    <div class="call-out-box"><p>These eight factors support and strengthen each other. Ethical conduct provides a stable foundation for concentration, which in turn clarifies the mind, allowing wisdom to arise.</p></div>
                `
            },
            "metta-meditation": {
                title: "A Guide to Mettā (Loving-Kindness) Meditation",
                category: "Meditation",
                categoryId: "meditation",
                date: "September 12, 2025",
                readTime: 8,
                author: "Jane Bodhi",
                tags: ["meditation", "metta", "loving-kindness", "compassion"],
                audioSrc: null, // Audio will be generated programmatically
                content: `
                    <p><span class="pali-term" data-term="metta">Mettā</span>, or loving-kindness, is a meditation practice designed to cultivate unconditional, compassionate love for all beings. It is a powerful antidote to anger, ill will, and fear.</p>
                    <h2>The Practice</h2>
                    <p>Find a comfortable sitting position and gently close your eyes. Begin by offering loving-kindness to yourself. Silently repeat phrases that resonate with you, such as:</p>
                    <ul>
                        <li>May I be happy.</li>
                        <li>May I be healthy.</li>
                        <li>May I be safe.</li>
                        <li>May I live with ease.</li>
                    </ul>
                    <p>Feel the intention behind the words. There is no need to force a particular feeling; simply offer the phrases with gentle sincerity.</p>
                    <h2>Expanding the Circle of Kindness</h2>
                    <p>After a few minutes of offering mettā to yourself, you gradually expand the circle of loving-kindness to include others:</p>
                    <ol>
                        <li><strong>A loved one:</strong> Bring to mind a close friend or family member. Offer them the same phrases: "May you be happy. May you be healthy..."</li>
                        <li><strong>A neutral person:</strong> Think of someone you see regularly but don't have strong feelings about, like a cashier or a neighbor. Offer them mettā.</li>
                        <li><strong>A difficult person:</strong> This can be challenging. Bring to mind someone with whom you have friction. To the best of your ability, offer them the same wishes for their happiness and well-being.</li>
                        <li><strong>All beings:</strong> Finally, expand your loving-kindness to all living beings everywhere, without exception. "May all beings be happy. May all beings be healthy..."</li>
                    </ol>
                    <blockquote>"Just as a mother would protect her only child at the risk of her own life, even so, let him cultivate a boundless heart towards all beings."</blockquote>
                `
            }
        },
        categories: {
            "introduction": {
                title: "Introduction to Theravāda",
                description: "Begin your journey here. Understand the origins, history, and foundational principles of the oldest school of Buddhism."
            },
            "teachings": {
                title: "Core Teachings",
                description: "Explore the fundamental doctrines of the Buddha, from the Four Noble Truths to the nature of reality. These articles form the philosophical heart of the path."
            },
            "meditation": {
                title: "Meditation & Practice",
                description: "Learn the practical techniques of mindfulness and concentration. Our guides provide clear, step-by-step instructions to help you establish a stable and fruitful practice."
            }
        },
        glossary: {
            "theravada": "The 'Way of the Elders'. The oldest surviving school of Buddhism, based on the Pāli Canon.",
            "dukkha": "Unsatisfactoriness, suffering, stress. The inherent unease in conditioned existence.",
            "anicca": "Impermanence. The principle that all conditioned things are in a constant state of flux.",
            "anatta": "Not-self. The doctrine that there is no permanent, unchanging soul or self.",
            "nibbana": "Nirvana. The ultimate goal, meaning 'to extinguish'. The cessation of suffering and the cycle of rebirth.",
            "panna": "Wisdom, insight. One of the three divisions of the Noble Eightfold Path.",
            "samadhi": "Concentration, mental discipline. The second division of the Noble Eightfold Path.",
            "vipassana": "Insight meditation. The practice of seeing things as they truly are.",
            "anapanasati": "Mindfulness of breathing. A core meditation practice.",
            "metta": "Loving-kindness, goodwill. A meditation practice for cultivating universal, non-attached love."
        },
        authors: {
            "Alan Dhamma": {
                name: "Alan Dhamma",
                bio: "Alan is the founder of The Dhamma Path and a long-term practitioner of Vipassanā meditation in the Theravāda tradition. His focus is on making the original teachings accessible and practical for modern life.",
                avatar: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM2Yjg1NzYiLz4KPGNpcmNsZSBjeD0iNDAiIGN5PSIzMCIgcj0iMTIiIGZpbGw9IiNGREZCRjUiLz4KPHBhdGggZD0iTTI1IDY1QzI1IDU1IDMxIDQ1IDQwIDQ1UzU1IDU1IDU1IDY1VjY1SDI1WiIgZmlsbD0iI0ZERkJGNSIvPgo8L3N2Zz4K"
            },
            "Jane Bodhi": {
                name: "Jane Bodhi",
                bio: "Jane has been a dedicated student of Buddhist meditation for over 15 years. She is a certified mindfulness instructor and is passionate about sharing the benefits of practice with others.",
                 avatar: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNjOWE5NzMiLz4KPGNpcmNsZSBjeD0iNDAiIGN5PSIzMCIgcj0iMTIiIGZpbGw9IiNGREZCRjUiLz4KPHBhdGggZD0iTTI1IDY1QzI1IDU1IDMxIDQ1IDQwIDQ1UzU1IDU1IDU1IDY1VjY1SDI1WiIgZmlsbD0iI0ZERkJGNSIvPgo8L3N2Zz4K"
            }
        },
        paths: {
            "7-day-mindfulness": {
                title: "7-Day Introduction to Mindfulness",
                description: "A guided path for beginners to establish a daily practice. Each day includes a short reading and a guided meditation.",
                steps: [
                    { day: 1, title: "Finding Your Seat & Your Breath", articleId: "vipassana-guide", focus: "Posture and basic breath awareness."},
                    { day: 2, title: "Working with a Wandering Mind", articleId: "vipassana-guide", focus: "Gently returning your attention without judgment."},
                    { day: 3, title: "Mindfulness of the Body", articleId: "vipassana-guide", focus: "Expanding awareness to physical sensations."},
                    { day: 4, title: "Cultivating Loving-Kindness", articleId: "metta-meditation", focus: "Introducing the practice of Mettā."},
                    { day: 5, title: "Observing Thoughts and Feelings", articleId: "vipassana-guide", focus: "Seeing mental events as impermanent."},
                    { day: 6, title: "Mindfulness in Daily Life", articleId: "what-is-theravada", focus: "Taking practice off the cushion."},
                    { day: 7, title: "Establishing a Routine", articleId: "noble-eightfold-path", focus: "Tips for continuing your practice."}
                ]
            }
        },
        workout: {
            exercises: [
                { name: "Jumping Jacks", duration: 30, calories: 8, instructions: "Stand with feet together and arms at your sides. Jump up spreading your feet shoulder-width apart while bringing your arms overhead. Jump back to starting position.", visual: '<svg viewBox="0 0 100 100" class="w-full h-full"><g stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="50" cy="25" r="6" fill="currentColor" opacity="0.8"/><path d="M50 35v25m0 0l-12 25m12-25l12 25M50 45L35 30m30 0L65 30"><animateTransform attributeName="transform" type="translate" values="0 0; 0 8; 0 0" dur="0.8s" repeatCount="indefinite"/></path><path d="M35 75L25 90m30-30l-10-15m30 30l10-15"><animateTransform attributeName="transform" type="translate" values="0 0; 0 -8; 0 0" dur="0.8s" repeatCount="indefinite"/></path><circle cx="20" cy="85" r="3" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="translate" values="0 0; 0 -5; 0 0" dur="0.8s" repeatCount="indefinite"/></circle><circle cx="80" cy="85" r="3" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="translate" values="0 0; 0 -5; 0 0" dur="0.8s" repeatCount="indefinite"/></circle></g></svg>' },
                { name: "Wall Sit", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M30 10v80"/><circle cx="50" cy="35" r="5"/><path d="M50 40v20 H40 v20 H50 v10"/><path d="M50 60 L60 60"><animate attributeName="d" values="M50 60 L60 60; M50 60 L65 60; M50 60 L60 60" dur="2s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "Push-ups", duration: 30, visual: '<svg viewBox="0 0 100 100" class="w-full h-full"><g stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"><rect x="10" y="75" width="80" height="8" fill="currentColor" opacity="0.3"/><path d="M25 75 L50 35 L75 75"><animate attributeName="d" values="M25 75 L50 35 L75 75; M25 75 L50 55 L75 75; M25 75 L50 35 L75 75" dur="1.2s" repeatCount="indefinite"/></path><circle cx="50" cy="35" r="4" fill="currentColor" opacity="0.8"><animateTransform attributeName="transform" type="translate" values="0 0; 0 20; 0 0" dur="1.2s" repeatCount="indefinite"/></circle><path d="M45 30 L50 25 L55 30" stroke-width="2"><animateTransform attributeName="transform" type="translate" values="0 0; 0 20; 0 0" dur="1.2s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "Crunches", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M20 80 L40 60 H80 L90 80"/><path d="M45 60 L35 40 m 30 0 L75 40"><animateTransform attributeName="transform" type="translate" values="0 0; 0 5; 0 0" dur="1s" repeatCount="indefinite"/></path><circle cx="55" cy="30" r="5"><animateTransform attributeName="transform" type="translate" values="0 0; 0 5; 0 0" dur="1s" repeatCount="indefinite"/></circle></g></svg>' },
                { name: "Step-ups", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M20 80H80v10H20z"/><circle cx="40" cy="30" r="5"/><path d="M40 35v35H30v10"><animate attributeName="d" values="M40 35v35H30v10; M60 35v35H50v10; M40 35v35H30v10" dur="1.5s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "Squats", duration: 30, visual: '<svg viewBox="0 0 100 100" class="w-full h-full"><g stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="50" cy="25" r="6" fill="currentColor" opacity="0.8"/><path d="M50 35v30m0 0L40 90m10-25L60 90"><animateTransform attributeName="transform" type="translate" values="0 0; 0 15; 0 0" dur="1.5s" repeatCount="indefinite"/></path><path d="M45 30 L50 25 L55 30" stroke-width="2"><animateTransform attributeName="transform" type="translate" values="0 0; 0 15; 0 0" dur="1.5s" repeatCount="indefinite"/></path><circle cx="35" cy="85" r="4" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="translate" values="0 0; 0 15; 0 0" dur="1.5s" repeatCount="indefinite"/></circle><circle cx="65" cy="85" r="4" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="translate" values="0 0; 0 15; 0 0" dur="1.5s" repeatCount="indefinite"/></circle></g></svg>' },
                { name: "Triceps Dips", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M20 60h60v10H20z"/><g><circle cx="50" cy="30" r="5"/><path d="M50 35v15m-15-15l15 15l15-15"/><animateTransform attributeName="transform" type="translate" values="0 0; 0 10; 0 0" dur="1s" repeatCount="indefinite"/></g></g></svg>' },
                { name: "Plank", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M10 70L30 50 H70 L90 70"/><path d="M30 50v20m40-20v20"><animateTransform attributeName="transform" type="translate" values="0 0; 0 2; 0 0" dur="2s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "High Knees", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="50" cy="30" r="5"/><path d="M50 35v25m0 0L40 85m10-25L60 85"/><path d="M40 85v-20h-5"><animate attributeName="d" values="M40 85v-20h-5; M40 65v-20h-5; M40 85v-20h-5" dur="0.5s" repeatCount="indefinite"/></path><path d="M60 65v20h5"><animate attributeName="d" values="M60 65v20h5; M60 85v-20h5; M60 65v20h5" dur="0.5s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "Lunges", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="50" cy="30" r="5"/><path d="M50 35v25L70 85"/><path d="M50 60L30 85"><animate attributeName="d" values="M50 60L30 85; M50 60L50 85; M50 60L30 85" dur="1s" repeatCount="indefinite" alternate="true"/></path></g></svg>' },
                { name: "Push-up & Rotation", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M10 80h80"/><path d="M20 80 L50 40 L80 80"/><path d="M50 40v-15"><animateTransform attributeName="transform" type="rotate" values="0 50 40; 90 50 40; 0 50 40" dur="2s" repeatCount="indefinite"/></path></g></svg>' },
                { name: "Side Plank", duration: 30, visual: '<svg viewBox="0 0 100 100"><g stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"><path d="M50 10v80"/><path d="M50 50l30-20v40z"/><circle cx="80" cy="30" r="5"><animateTransform attributeName="transform" type="translate" values="0 0; 0 2; 0 0" dur="2s" repeatCount="indefinite"/></path></g></svg>' }
            ],
            restDuration: 10
        },
        interviewQuestions: {
            general: [
                "Tell me about yourself.",
                "What are your goals for today?",
                "How do you like to start your mornings?",
                "What motivates you to get up each day?",
                "Describe your ideal morning routine.",
                "What's something you're looking forward to this week?",
                "How do you stay focused throughout the day?",
                "What's a recent accomplishment you're proud of?",
                "Describe your perfect day from start to finish.",
                "What's the best advice you've ever received?",
                "Tell me about a person who has influenced you greatly.",
                "What's something you're currently learning or want to learn?",
                "Describe a place that makes you feel peaceful.",
                "What's your favorite way to unwind after a long day?",
                "Tell me about a book, movie, or song that changed your perspective."
            ],
            storytelling: [
                "Tell me about a time you overcame a fear.",
                "Describe your most memorable travel experience.",
                "Share a story about a time you helped someone.",
                "Tell me about a moment when you felt truly proud.",
                "Describe a time you had to be brave.",
                "Share a story about a mistake that taught you something valuable.",
                "Tell me about a time you had to stand up for what you believed in.",
                "Describe a moment when you felt completely at peace.",
                "Share a story about a time you had to start over.",
                "Tell me about a time you surprised yourself.",
                "Describe a moment when you felt deeply grateful.",
                "Share a story about a time you had to be patient.",
                "Tell me about a time you had to trust your instincts.",
                "Describe a moment when you felt truly connected to someone.",
                "Share a story about a time you had to let go of something."
            ],
            communication: [
                "Explain why meditation is important for daily life.",
                "Describe your ideal work environment.",
                "Present three ways to stay productive throughout the day.",
                "Explain the benefits of a healthy morning routine.",
                "Describe how you would teach someone to be more confident.",
                "Present your vision for personal growth this year.",
                "Explain why self-care is essential for success.",
                "Describe how you handle stress and pressure.",
                "Explain what mindfulness means to you.",
                "Describe your approach to building meaningful relationships.",
                "Present your philosophy on work-life balance.",
                "Explain how you stay motivated during difficult times.",
                "Describe what success means to you personally.",
                "Present your thoughts on the importance of gratitude.",
                "Explain how you would help someone who's feeling overwhelmed."
            ],
            creativity: [
                "If you could have dinner with anyone, who would it be and why?",
                "Describe your dream job or career path.",
                "If you could travel anywhere in the world, where would you go?",
                "What's a skill you wish you had more time to develop?",
                "If you could solve one world problem, what would it be?",
                "Describe your ideal weekend.",
                "What's something you've always wanted to try but haven't yet?",
                "If you could give your younger self one piece of advice, what would it be?",
                "Describe a project or hobby you're passionate about.",
                "What's a goal you have for the next five years?",
                "If you could learn any language instantly, which would you choose?",
                "Describe your perfect home or living space.",
                "What's a cause or issue you care deeply about?",
                "If you could have any superpower, what would it be and why?",
                "Describe what happiness looks like to you."
            ]
        }
    };

        // --- PROGRESS TRACKING --- //
        const ProgressTracker = {
            activities: {
                meditation: { completed: false, time: null },
                journal: { completed: false, time: null },
                workout: { completed: false, time: null },
                confidence: { completed: false, time: null }
            },
            
            init() {
                this.loadProgress();
                this.updateDisplay();
            },
            
            markComplete(activity, duration = null) {
                this.activities[activity].completed = true;
                this.activities[activity].time = new Date();
                this.saveProgress();
                this.updateDisplay();
            },
            
            loadProgress() {
                const today = new Date().toDateString();
                const saved = localStorage.getItem('dailyProgress');
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.date === today) {
                        this.activities = data.activities;
                    } else {
                        // New day, reset progress
                        this.resetProgress();
                    }
                }
            },
            
            saveProgress() {
                const data = {
                    date: new Date().toDateString(),
                    activities: this.activities
                };
                localStorage.setItem('dailyProgress', JSON.stringify(data));
            },
            
            resetProgress() {
                Object.keys(this.activities).forEach(key => {
                    this.activities[key] = { completed: false, time: null };
                });
                this.saveProgress();
            },
            
            updateDisplay() {
                const completedCount = Object.values(this.activities).filter(a => a.completed).length;
                const progressPercent = (completedCount / 4) * 100;
                
                // Update progress bar
                const progressBar = document.getElementById('overall-progress');
                const progressText = document.getElementById('progress-text');
                if (progressBar && progressText) {
                    progressBar.style.width = `${progressPercent}%`;
                    progressText.textContent = `Complete ${completedCount} of 4 activities`;
                }
                
                // Update individual activity status
                Object.keys(this.activities).forEach(activity => {
                    const statusEl = document.getElementById(`${activity}-status`);
                    const timeEl = document.getElementById(`${activity}-time`);
                    
                    if (statusEl && timeEl) {
                        if (this.activities[activity].completed) {
                            statusEl.className = 'w-8 h-8 rounded-full bg-forest-green flex items-center justify-center';
                            statusEl.innerHTML = '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
                            const time = this.activities[activity].time;
                            timeEl.textContent = time ? time.toLocaleTimeString() : 'Completed';
                        } else {
                            statusEl.className = 'w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center';
                            timeEl.textContent = 'Not started';
                        }
                    }
                });
                
                // Update streak
                this.updateStreak();
            },
            
            updateStreak() {
                const streakEl = document.getElementById('streak-text');
                if (streakEl) {
                    // Simple streak calculation - in a real app, you'd track this more sophisticatedly
                    const allCompleted = Object.values(this.activities).every(a => a.completed);
                    const streak = allCompleted ? 1 : 0; // Simplified for now
                    streakEl.textContent = `🔥 ${streak} day streak`;
                }
        }
    };

    // --- APP LOGIC --- //
    let mainContent; // Declare globally
    
    document.addEventListener('DOMContentLoaded', () => {
        mainContent = document.getElementById('main-content');
            
            // Initialize progress tracking
            ProgressTracker.init();
        
        // --- Dark Mode --- //
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const darkModeToggleMobile = document.getElementById('dark-mode-toggle-mobile');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        
        const applyTheme = (isDark) => {
            if (isDark) {
                document.documentElement.classList.add('dark');
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'block';
            } else {
                document.documentElement.classList.remove('dark');
                sunIcon.style.display = 'block';
                moonIcon.style.display = 'none';
            }
        };

        const toggleDarkMode = () => {
            const isDark = !document.documentElement.classList.contains('dark');
            localStorage.setItem('darkMode', isDark);
            applyTheme(isDark);
        };

        if (darkModeToggle) {
            darkModeToggle.addEventListener('click', toggleDarkMode);
        }
        if (darkModeToggleMobile) {
            darkModeToggleMobile.addEventListener('click', toggleDarkMode);
        }

        // Check for saved preference
        if (localStorage.getItem('darkMode') === 'true' || 
           (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('darkMode'))) {
            applyTheme(true);
        } else {
            applyTheme(false);
        }

        // --- Mobile Menu --- //
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }

        // --- Scroll Progress Bar --- //
        const progressBar = document.getElementById('progress-bar');
        const updateProgressBar = () => {
            const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
            if (scrollHeight > clientHeight) {
                const scrollPercent = (scrollTop / (scrollHeight - clientHeight)) * 100;
                progressBar.style.width = `${scrollPercent}%`;
            } else {
                progressBar.style.width = '0%';
            }
        };
        
        // Reading Progress Indicator
        const updateReadingProgress = () => {
            const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
            if (scrollHeight > clientHeight) {
                const scrollPercent = Math.min((scrollTop / (scrollHeight - clientHeight)) * 100, 100);
                const readingProgress = document.getElementById('reading-progress');
                if (readingProgress) {
                    readingProgress.style.width = `${scrollPercent}%`;
                }
            }
        };
        // --- Performance Utilities --- //
        const debounce = (func, wait) => {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        const throttle = (func, limit) => {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        };

        window.addEventListener('scroll', throttle(() => {
            updateProgressBar();
            updateReadingProgress();
        }, 16)); // 60fps

        const cleanupPageResources = () => {
            // Clear all intervals
            clearInterval(timerInterval); 
            clearInterval(workoutInterval);
            clearInterval(journalInterval);
            
            // Reset page state
            document.body.classList.remove('fullscreen-active', 'journal-focus');
            
            // Stop media recording
            if (mediaRecorder && mediaRecorder.state === "recording") {
                mediaRecorder.stop();
            }
            
            // Stop speech synthesis
            if(window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
            }
            
            // Clear main content
            if (mainContent) {
                mainContent.innerHTML = '';
            }
        };
        
        // --- Templating & Routing --- //
        const templates = {
            home: document.getElementById('template-home').content.cloneNode(true),
            category: document.getElementById('template-category').content.cloneNode(true),
            article: document.getElementById('template-article').content.cloneNode(true),
            about: document.getElementById('template-about').content.cloneNode(true),
            privacy: document.getElementById('template-privacy').content.cloneNode(true),
            terms: document.getElementById('template-terms').content.cloneNode(true),
            glossary: document.getElementById('template-glossary').content.cloneNode(true),
            searchResults: document.getElementById('template-search-results').content.cloneNode(true),
            timer: document.getElementById('template-timer').content.cloneNode(true),
            path: document.getElementById('template-path').content.cloneNode(true),
            workout: document.getElementById('template-workout').content.cloneNode(true),
            interview: document.getElementById('template-interview').content.cloneNode(true),
            journal: document.getElementById('template-journal').content.cloneNode(true),
        };

        const renderArticleCard = (articleId, article, fullWidth = false, delay = 0) => {
            const description = article.content.match(/<p>(.*?)<\/p>/)[1].replace(/<[^>]+>/g, '').substring(0, 100);
            return `
                <a href="#" data-page="article" data-article-id="${articleId}" class="main-nav-link card-link group block ${fullWidth ? '' : 'p-6 bg-light-green rounded-lg shadow-sm border border-black/5'}" style="animation-delay: ${delay}s">
                    <div class="space-y-2">
                         <p class="text-sm font-semibold uppercase tracking-wider text-earthy-gold">${article.category}</p>
                         <h3 class="text-2xl font-bold text-charcoal font-lora group-hover:text-forest-green transition-colors">${article.title}</h3>
                         <p class="text-charcoal/70">${description}...</p>
                         <span class="text-sm text-forest-green font-semibold">Read more &rarr;</span>
                    </div>
                </a>
            `;
        };
        
        const renderHomePage = () => {
            const page = templates.home.cloneNode(true);
            const latestArticlesGrid = page.getElementById('latest-articles-grid');
            
            // Add stagger animation to cards
            Object.entries(db.articles).slice(0, 4).forEach(([id, article], index) => {
                const card = document.createElement('div');
                card.className = 'stagger-in';
                card.style.animationDelay = `${index * 0.1}s`;
                card.innerHTML = renderArticleCard(id, article, true, index * 0.1);
                latestArticlesGrid.appendChild(card);
            });
            
            // Quick access toolbar was removed - no longer needed
            
            return page;
        };
        
        const renderAboutPage = () => {
            const page = templates.about.cloneNode(true);
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            return page;
        };

        const renderGlossaryPage = () => {
            const page = templates.glossary.cloneNode(true);
            const list = page.getElementById('glossary-list');
            
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            
            Object.entries(db.glossary).sort().forEach(([term, def], index) => {
                const item = document.createElement('div');
                item.className = 'p-6 bg-light-green rounded-lg stagger-in';
                item.style.animationDelay = `${index * 0.05}s`;
                item.innerHTML = `
                    <h3 class="text-2xl font-bold text-forest-green font-lora">${term.charAt(0).toUpperCase() + term.slice(1)}</h3>
                    <p class="mt-2 text-charcoal/80">${def}</p>
                `;
                list.appendChild(item);
            });
            return page;
        };

        const renderCategoryPage = (categoryId) => {
            const page = templates.category.cloneNode(true);
            const category = db.categories[categoryId];
            if (!category) return renderHomePage();

            page.getElementById('category-title').textContent = category.title;
            page.getElementById('category-description').textContent = category.description;
            const grid = page.getElementById('category-articles-grid');
            
            // Add stagger animation to category header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            
            // Add paths section if it's the meditation category
            if (categoryId === 'meditation') {
                const pathsSection = page.getElementById('category-paths-section');
                let pathsHtml = '<h2 class="text-3xl font-bold text-center text-charcoal font-lora mb-10">Guided Paths</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-8 stagger-in">';
                Object.entries(db.paths).forEach(([id, path], index) => {
                    pathsHtml += `
                    <a href="#" data-page="path" data-path-id="${id}" class="main-nav-link card-link block p-8 bg-light-gold rounded-lg shadow-sm duration-300 border border-black/5" style="animation-delay: ${index * 0.1}s">
                        <h3 class="text-2xl font-bold text-earthy-gold font-lora">${path.title}</h3>
                        <p class="mt-2 text-charcoal/80">${path.description}</p>
                    </a>
                    `;
                });
                pathsHtml += '</div><hr class="my-16 border-gray-300/70 dark:border-gray-600">';
                pathsSection.innerHTML = pathsHtml;
            }

            Object.entries(db.articles)
                .filter(([id, article]) => article.categoryId === categoryId)
                .forEach(([id, article], index) => {
                    const card = document.createElement('div');
                    card.className = 'stagger-in';
                    card.style.animationDelay = `${index * 0.1}s`;
                    card.innerHTML = renderArticleCard(id, article, false, index * 0.1);
                    grid.appendChild(card);
                });
            return page;
        };
        
        const renderArticlePage = (articleId) => {
            const page = templates.article.cloneNode(true);
            const article = db.articles[articleId];
            if (!article) return renderHomePage();

            const categoryLink = page.getElementById('article-category-link');
            categoryLink.textContent = article.category;
            categoryLink.dataset.page = `category-${article.categoryId}`;

            page.getElementById('article-title').textContent = article.title;
            page.getElementById('article-date').textContent = article.date;
            page.getElementById('article-read-time').textContent = article.readTime;
            const articleContentDiv = page.getElementById('article-content');
            articleContentDiv.innerHTML = article.content;

            // Audio Player
            if (article.audioSrc) {
                const audioPlayerContainer = page.getElementById('audio-player-container');
                audioPlayerContainer.innerHTML = `
                    <div class="bg-light-green p-6 rounded-lg">
                         <h3 class="text-xl font-bold font-lora text-forest-green mb-4">Guided Meditation</h3>
                         <div class="flex items-center space-x-4">
                            <button class="audio-play-btn w-14 h-14 bg-forest-green text-white rounded-full flex items-center justify-center hover:bg-forest-green/90 transition">
                                <svg class="play-icon h-8 w-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                                <svg class="pause-icon h-8 w-8 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                            </button>
                            <div class="flex-grow">
                                <p class="font-semibold text-charcoal">${article.readTime}-Minute Guided Practice</p>
                                <div class="relative pt-1">
                                    <div class="overflow-hidden h-2 mt-2 text-xs flex rounded bg-gray-300">
                                        <div style="width:0%" class="audio-progress shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-earthy-gold"></div>
                                    </div>
                                </div>
                            </div>
                         </div>
                    </div>
                `;
            }

            // Generate TOC
            const tocList = page.getElementById('toc-list');
            const headings = articleContentDiv.querySelectorAll('h2');
            if(headings.length > 0){
                headings.forEach(h => {
                    const id = h.textContent.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]+/g, '');
                    h.id = id;
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="#${id}" class="hover:text-forest-green">${h.textContent}</a>`;
                    tocList.appendChild(li);
                });
            } else {
                page.getElementById('article-toc').style.display = 'none';
            }

            // Author Bio
            const author = db.authors[article.author];
            if (author) {
                const authorBioDiv = page.getElementById('author-bio');
                authorBioDiv.innerHTML = `
                    <img src="${author.avatar}" alt="${author.name}" class="w-20 h-20 rounded-full">
                    <div>
                        <p class="text-sm text-charcoal/70 uppercase tracking-wider">Written by</p>
                        <h4 class="text-xl font-bold font-lora text-charcoal">${author.name}</h4>
                        <p class="mt-1 text-charcoal/80">${author.bio}</p>
                    </div>
                `;
            }

            // Related Articles
            const relatedArticlesDiv = page.getElementById('related-articles');
            const relatedArticles = Object.entries(db.articles)
                .filter(([id, a]) => id !== articleId && (a.categoryId === article.categoryId || a.tags.some(t => article.tags.includes(t))))
                .slice(0, 3);
            
            if (relatedArticles.length > 0) {
                relatedArticlesDiv.innerHTML = `<h3 class="text-3xl font-bold font-lora text-center mb-8">Related Articles</h3>`;
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-1 md:grid-cols-3 gap-8 stagger-in';
                relatedArticles.forEach(([id, a], index) => {
                    const card = document.createElement('div');
                    card.innerHTML = renderArticleCard(id, a, false, index * 0.1);
                    grid.appendChild(card);
                });
                relatedArticlesDiv.appendChild(grid);
            }

            // Comments
            const commentsDiv = page.getElementById('comments-section');
            commentsDiv.innerHTML = `
                <h3 class="text-3xl font-bold font-lora mb-6">Leave a Comment</h3>
                <form class="space-y-4">
                    <textarea placeholder="Your comment..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-earthy-gold focus:outline-none dark:bg-gray-700 dark:border-gray-600" rows="4"></textarea>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" placeholder="Your Name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-earthy-gold focus:outline-none dark:bg-gray-700 dark:border-gray-600">
                        <input type="email" placeholder="Your Email (not published)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-earthy-gold focus:outline-none dark:bg-gray-700 dark:border-gray-600">
                    </div>
                    <button type="submit" class="px-6 py-3 bg-forest-green text-white font-semibold rounded-lg hover:bg-forest-green/90 transition">Post Comment</button>
                </form>
                <div class="mt-12 space-y-8">
                    <h4 class="text-2xl font-bold font-lora">2 Comments</h4>
                    <div class="flex space-x-4">
                        <div class="w-12 h-12 rounded-full bg-earthy-gold flex items-center justify-center text-white font-bold text-lg">M</div>
                        <div>
                            <p class="font-bold text-charcoal">Maria S.</p>
                            <p class="text-sm text-charcoal/60 mb-2">September 9, 2025</p>
                            <p class="text-charcoal/90">Thank you for this wonderful guide. The instructions for mindfulness of breath are the clearest I've ever read.</p>
                        </div>
                    </div>
                    <div class="flex space-x-4">
                        <div class="w-12 h-12 rounded-full bg-light-green flex items-center justify-center text-forest-green font-bold text-lg">D</div>
                        <div>
                            <p class="font-bold text-charcoal">David L.</p>
                            <p class="text-sm text-charcoal/60 mb-2">September 11, 2025</p>
                            <p class="text-charcoal/90">Really appreciate the breakdown of the body scan. It's a part of the practice I've always struggled with.</p>
                        </div>
                    </div>
                </div>
            `;
            return page;
        };
        
        const renderSearchResultsPage = (query) => {
            const page = templates.searchResults.cloneNode(true);
            const resultsList = page.getElementById('search-results-list');
            const queryText = page.getElementById('search-results-query');

            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }

            const lowerQuery = query.toLowerCase();
            const results = Object.entries(db.articles).filter(([id, article]) => {
                return article.title.toLowerCase().includes(lowerQuery) || article.content.toLowerCase().includes(lowerQuery);
            });

            if (results.length > 0) {
                queryText.textContent = `Found ${results.length} result(s) for "${query}"`;
                results.forEach(([id, article], index) => {
                     const card = document.createElement('div');
                     card.className = 'border-b border-gray-200 dark:border-gray-700 pb-6 stagger-in';
                     card.style.animationDelay = `${index * 0.1}s`;
                     card.innerHTML = renderArticleCard(id, article, true);
                     resultsList.appendChild(card);
                });
            } else {
                queryText.textContent = `No results found for "${query}"`;
            }
            return page;
        };
        
        const renderTimerPage = () => {
            const page = templates.timer.cloneNode(true);
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            return page;
        };
        
        const renderWorkoutPage = () => {
            const page = templates.workout.cloneNode(true);
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            return page;
        };
        
        const renderInterviewPage = () => {
            const page = templates.interview.cloneNode(true);
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            return page;
        };
        
        const renderJournalPage = () => {
            const page = templates.journal.cloneNode(true);
            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }
            return page;
        };

        const renderPathPage = (pathId) => {
            const page = templates.path.cloneNode(true);
            const path = db.paths[pathId];
            if (!path) return renderHomePage();

            // Add stagger animation to header
            const header = page.querySelector('header');
            if (header) {
                header.className += ' stagger-in';
            }

            page.getElementById('path-title').textContent = path.title;
            page.getElementById('path-description').textContent = path.description;
            const list = page.getElementById('path-steps-list');
            path.steps.forEach((step, index) => {
                const item = document.createElement('a');
                item.href = '#';
                item.dataset.page = 'article';
                item.dataset.articleId = step.articleId;
                item.className = 'main-nav-link card-link block p-6 bg-light-green rounded-lg shadow-sm hover:shadow-md transition-shadow flex items-center space-x-6 stagger-in';
                item.style.animationDelay = `${index * 0.1}s`;
                item.innerHTML = `
                    <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center bg-forest-green text-white rounded-full font-lora text-2xl">${step.day}</div>
                    <div>
                        <h3 class="text-xl font-bold text-charcoal font-lora">${step.title}</h3>
                        <p class="text-charcoal/80">Focus: ${step.focus}</p>
                    </div>
                    <div class="ml-auto text-forest-green">&rarr;</div>
                `;
                list.appendChild(item);
            });
            return page;
        };
        
        let timerInterval = null;
        let workoutInterval = null;
        let journalInterval = null;
        let mediaRecorder = null;
        let recordedChunks = [];
        let sessionRecordings = [];

        const sounds = {
            chime: new Audio("data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YV8vT19IA38JfweLCPsI/wklDSAKNA04DhsPMg8ADBwPGA8kEI4Q8xAhEWgSChPWFBoU4BUkFWQWahd6F4EX7xgdGG4YzxkPG8wbKBwSHRseHR8ZICQjJCwmKSgqKiwqLCoqKCQjICAfIBwYGRUQEg8ODAsJCAgHBwUEAwIBAD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8APwA/AD8A"),
            bowl: new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAIARKwAABCxAgAEABAAZGF0YQAAAAA="),
            wood: new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=")
        };
        
        const showLoading = () => {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) {
                loadingIndicator.classList.remove('hidden');
            }
        };
        
        const hideLoading = () => {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) {
                loadingIndicator.classList.add('hidden');
            }
        };

        const showNotification = (message) => {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            text.textContent = message;
            notification.classList.remove('translate-x-full');
            setTimeout(() => {
                notification.classList.add('translate-x-full');
            }, 3000);
        };
        
        // Make navigateTo globally accessible
        window.navigateTo = function(pageName, id = null) {
            // Ensure mainContent is available
            if (!mainContent) {
                mainContent = document.getElementById('main-content');
                if (!mainContent) {
                    console.error('Main content container not found');
                    return;
                }
            }
            
            // Cleanup previous page resources
            cleanupPageResources();
            
            // Show loading for non-instant transitions
            if (pageName !== 'home') {
                showLoading();
            }
            
            // Quick access toolbar was removed - no longer needed
            
            let pageContent;

            switch(pageName) {
                case 'category-introduction': pageContent = renderCategoryPage('introduction'); break;
                case 'category-teachings': pageContent = renderCategoryPage('teachings'); break;
                case 'category-meditation': pageContent = renderCategoryPage('meditation'); break;
                case 'article': pageContent = renderArticlePage(id); break;
                case 'about': pageContent = renderAboutPage(); break;
                case 'privacy': pageContent = templates.privacy.cloneNode(true); break;
                case 'terms': pageContent = templates.terms.cloneNode(true); break;
                case 'glossary': pageContent = renderGlossaryPage(); break;
                case 'searchResults': pageContent = renderSearchResultsPage(id); break;
                case 'timer': pageContent = renderTimerPage(); break;
                case 'path': pageContent = renderPathPage(id); break;
                case 'workout': pageContent = renderWorkoutPage(); break;
                case 'interview': pageContent = renderInterviewPage(); break;
                case 'journal': pageContent = renderJournalPage(); break;
                case 'home': default: pageContent = renderHomePage();
            }
            
            mainContent.appendChild(pageContent);
            
            // Hide loading indicator after content is rendered
            setTimeout(() => {
                hideLoading();
            }, 100);

            if (pageName === 'timer') {
                // Small delay to ensure DOM is fully rendered
                setTimeout(() => {
                    attachTimerLogic();
                }, 100);
            }
            if (pageName === 'article') attachArticlePageLogic(id);
            if (pageName === 'workout') attachWorkoutLogic();
            if (pageName === 'interview') attachInterviewLogic();
            if (pageName === 'journal') attachJournalLogic();

            mainContent.classList.add('fade-in');
            setTimeout(() => mainContent.classList.remove('fade-in'), 500);
            window.scrollTo(0, 0);
            mobileMenu.classList.add('hidden'); // Close mobile menu on nav
            updateProgressBar(); // Recalculate progress for new page
            updateActiveNavLink(pageName);
        };
        
        function updateActiveNavLink(currentPage) {
            document.querySelectorAll('#desktop-nav-links a, #mobile-nav-links a').forEach(link => {
                const linkPage = link.dataset.page;
                // Handle category pages as a special case
                const isActive = (linkPage === currentPage) || 
                               (linkPage.startsWith('category-') && currentPage === linkPage) ||
                               (currentPage.startsWith('path') && linkPage === 'category-meditation');

                if (isActive) {
                     link.classList.add('active');
                } else {
                     link.classList.remove('active');
                }
            });
        }
        
        // --- Onboarding Logic --- //
        const onboardingModal = document.getElementById('onboarding-modal');
        if (!localStorage.getItem('dhammaPathVisited')) {
            onboardingModal.classList.remove('hidden');
        }
        onboardingModal.addEventListener('click', (e) => {
            if (e.target.closest('.onboarding-choice') || e.target.id === 'close-onboarding') {
                onboardingModal.classList.add('hidden');
                localStorage.setItem('dhammaPathVisited', 'true');
            }
        });

        // Error Handling and Resilience
        function showUserError(message, details = '') {
            const errorToast = document.createElement('div');
            errorToast.className = 'fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg shadow-lg z-50 max-w-sm';
            errorToast.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                    </svg>
                    <div>
                        <p class="font-semibold">${message}</p>
                        ${details ? `<p class="text-sm opacity-75">${details}</p>` : ''}
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-red-500 hover:text-red-700">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            `;
            document.body.appendChild(errorToast);
            setTimeout(() => errorToast.remove(), 5000);
        }

        function showUserSuccess(message) {
            const successToast = document.createElement('div');
            successToast.className = 'fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg shadow-lg z-50 max-w-sm';
            successToast.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <div>
                        <p class="font-semibold">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-green-500 hover:text-green-700">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            `;
            document.body.appendChild(successToast);
            setTimeout(() => successToast.remove(), 3000);
        }

        window.addEventListener('error', (e) => {
            showUserError('Something went wrong', 'Please refresh the page if the problem persists.');
        });

        window.addEventListener('unhandledrejection', (e) => {
            showUserError('An unexpected error occurred', 'Please try again or refresh the page.');
            e.preventDefault();
        });

        // Service Worker Registration for Caching
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        // Service worker registered successfully
                    })
                    .catch(registrationError => {
                        // Service worker registration failed
                    });
            });
        }

        // --- SCROLL-BASED ANIMATIONS & INTERACTIVE ELEMENTS --- //
        
        // Intersection Observer for fade-in animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        // Observe all elements with scroll animation classes
        document.querySelectorAll('.observe-fade-in, .observe-slide-left, .observe-slide-right, .observe-scale').forEach(el => {
            observer.observe(el);
        });

        // Parallax scrolling effect
        let ticking = false;
        function updateParallax() {
            const scrolled = window.pageYOffset;
            const parallaxElements = document.querySelectorAll('.parallax-slow, .parallax-medium, .parallax-fast');
            
            parallaxElements.forEach(el => {
                const speed = el.classList.contains('parallax-slow') ? 0.5 : 
                             el.classList.contains('parallax-medium') ? 0.3 : 0.1;
                const yPos = -(scrolled * speed);
                el.style.transform = `translateY(${yPos}px)`;
            });
            
            ticking = false;
        }

        function requestParallaxUpdate() {
            if (!ticking) {
                requestAnimationFrame(updateParallax);
                ticking = true;
            }
        }

        window.addEventListener('scroll', requestParallaxUpdate);

        // Scroll progress indicator
        function updateScrollProgress() {
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            const progressBar = document.getElementById('scroll-progress');
            if (progressBar) {
                progressBar.style.width = scrollPercent + '%';
            }
        }

        window.addEventListener('scroll', throttle(updateScrollProgress, 16));

        // Sticky elements
        function handleStickyElements() {
            const stickyElements = document.querySelectorAll('.sticky-element');
            const scrollTop = window.pageYOffset;
            
            stickyElements.forEach(el => {
                const rect = el.getBoundingClientRect();
                if (scrollTop > 20) {
                    el.classList.add('sticky');
                } else {
                    el.classList.remove('sticky');
                }
            });
        }

        window.addEventListener('scroll', throttle(handleStickyElements, 16));

        // Enhanced ripple effects
        function addRippleEffect(element) {
            element.addEventListener('click', function(e) {
                const ripple = document.createElement('span');
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.width = ripple.style.height = size + 'px';
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';
                ripple.classList.add('ripple-effect');
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        }

        // Apply ripple effects to buttons
        document.querySelectorAll('.btn-press, .ripple-enhanced').forEach(addRippleEffect);


        // Lazy loading for images
        function lazyLoadImages() {
            const images = document.querySelectorAll('img[data-src]');
            const imageObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazy-load');
                        img.classList.add('loaded');
                        imageObserver.unobserve(img);
                    }
                });
            });

            images.forEach(img => imageObserver.observe(img));
        }

        // Initialize lazy loading
        lazyLoadImages();

        // Error boundary functionality
        function showErrorBoundary(message, error) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-boundary';
            errorDiv.innerHTML = `
                <h3>Something went wrong</h3>
                <p>${message}</p>
                <button onclick="this.parentElement.remove()">Dismiss</button>
            `;
            document.body.appendChild(errorDiv);
            // Error boundary caught error
        }

        // Global error handler
        window.addEventListener('error', (e) => {
            showErrorBoundary('An unexpected error occurred. Please refresh the page.', e.error);
        });

        // Toast notification system
        function showToast(message, type = 'info', duration = 3000) {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // Make toast function globally available
        window.showToast = showToast;

        // Performance optimization: Preload critical resources
        function preloadCriticalResources() {
            const criticalImages = [
                // Add any critical image paths here
            ];
            
            criticalImages.forEach(src => {
                const link = document.createElement('link');
                link.rel = 'preload';
                link.as = 'image';
                link.href = src;
                document.head.appendChild(link);
            });
            
            // Preload critical fonts
            if ('fonts' in document) {
                document.fonts.load('400 16px Inter');
                document.fonts.load('400 16px Lora');
            }
        }

        preloadCriticalResources();

        // Performance Monitoring
        if ('performance' in window) {
            window.addEventListener('load', () => {
                setTimeout(() => {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
                    const domContentLoaded = perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart;
                    
                    // Log performance metrics for optimization
                    if (loadTime > 3000) {
                        showUserError('Slow loading detected', 'The page is loading slowly. Please check your connection.');
                    }
                }, 0);
            });
        }

        // Initial page load
        navigateTo('home');

        // Navigation event listener
        document.body.addEventListener('click', (e) => {
            const link = e.target.closest('.main-nav-link');
            if (link) {
                e.preventDefault();
                const page = link.dataset.page;
                const id = link.dataset.articleId || link.dataset.pathId;
                navigateTo(page, id);
            }
        });
        
        // --- Keyboard Shortcuts --- //
        document.addEventListener('keydown', (e) => {
            // Only trigger if not typing in input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            
            switch(e.key) {
                case 'h':
                case 'H':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        navigateTo('home');
                    }
                    break;
                case 't':
                case 'T':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        navigateTo('timer');
                    }
                    break;
                case 'j':
                case 'J':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        navigateTo('journal');
                    }
                    break;
                case '/':
                    e.preventDefault();
                    document.getElementById('search-input').focus();
                    break;
                case 'Escape':
                    document.getElementById('search-input').blur();
                    const autocompleteResults = document.getElementById('autocomplete-results');
                    if (autocompleteResults) {
                        autocompleteResults.classList.add('hidden');
                    }
                    break;
            }
        });
        
        // --- Search with Autocomplete --- //
        const searchInput = document.getElementById('search-input');
        const autocompleteResults = document.getElementById('autocomplete-results');
        
        searchInput.addEventListener('keyup', debounce((e) => {
            const query = searchInput.value.toLowerCase();
            if (e.key === 'Enter' && query.trim() !== '') {
                navigateTo('searchResults', query.trim());
                autocompleteResults.classList.add('hidden');
                searchInput.blur();
                return;
            }

            if (query.length < 2) {
                autocompleteResults.classList.add('hidden');
                return;
            }

            const results = Object.entries(db.articles)
                .filter(([id, article]) => article.title.toLowerCase().includes(query))
                .slice(0, 5);

            if (results.length > 0) {
                autocompleteResults.innerHTML = results.map(([id, article]) => 
                    `<a href="#" data-page="article" data-article-id="${id}" class="main-nav-link block px-4 py-2 hover:bg-light-green dark:hover:bg-gray-700">${article.title}</a>`
                ).join('');
                autocompleteResults.classList.remove('hidden');
            } else {
                autocompleteResults.classList.add('hidden');
            }
        }, 300)); // 300ms debounce

        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target)) {
                autocompleteResults.classList.add('hidden');
            }
        });


        // Pāli Term Tooltips
        mainContent.addEventListener('mouseover', (e) => {
            if (e.target.classList.contains('pali-term')) {
                const term = e.target.dataset.term;
                const definition = db.glossary[term];
                if (definition && !e.target.querySelector('.pali-tooltip')) {
                    const tooltip = document.createElement('span');
                    tooltip.className = 'pali-tooltip';
                    tooltip.textContent = definition;
                    e.target.appendChild(tooltip);
                }
            }
        });
        
        function attachArticlePageLogic(articleId) {
             // Attach audio player if it exists
            const player = mainContent.querySelector('#audio-player-container');
            if (player) {
                attachAudioPlayerLogic();
            }
            
            // Attach read-aloud logic
            const readAloudBtn = document.getElementById('read-aloud-btn');
            if (readAloudBtn) {
                readAloudBtn.addEventListener('click', () => {
                const articleContent = document.getElementById('article-content');
                const text = articleContent.innerText;
                if(speechSynthesis.speaking) {
                    speechSynthesis.cancel();
                    readAloudBtn.querySelector('span').textContent = 'Read Aloud';
                } else {
                    const utterance = new SpeechSynthesisUtterance(text);
                    speechSynthesis.speak(utterance);
                    readAloudBtn.querySelector('span').textContent = 'Stop Reading';
                    utterance.onend = () => {
                        readAloudBtn.querySelector('span').textContent = 'Read Aloud';
                    };
                }
                });
            }
        }
        
        function attachAudioPlayerLogic() {
            const player = mainContent.querySelector('#audio-player-container');
            if (!player) return;

            const playBtn = player.querySelector('.audio-play-btn');
            const playIcon = player.querySelector('.play-icon');
            const pauseIcon = player.querySelector('.pause-icon');
            const progress = player.querySelector('.audio-progress');
            
            // Check if all required elements exist
            if (!playBtn || !playIcon || !pauseIcon || !progress) {
                return;
            }
            
            let isPlaying = false;
            let progressInterval;

            playBtn.addEventListener('click', () => {
                isPlaying = !isPlaying;
                if(isPlaying) {
                    playIcon.classList.add('hidden');
                    pauseIcon.classList.remove('hidden');
                    let width = 0;
                    progressInterval = setInterval(() => {
                        width += 1;
                        progress.style.width = `${width}%`;
                        if (width >= 100) {
                            clearInterval(progressInterval);
                            playIcon.classList.remove('hidden');
                            pauseIcon.classList.add('hidden');
                        }
                    }, 1000); // Fakes 100 second audio
                } else {
                    playIcon.classList.remove('hidden');
                    pauseIcon.classList.add('hidden');
                    clearInterval(progressInterval);
                }
            });
        }
        
        function addKeyboardNavigation(startTimer, pauseTimer, resetTimer, setDuration, timerState) {
            // Space bar to start/pause
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && !e.target.matches('input, textarea, select')) {
                    e.preventDefault();
                    if (timerState.isPaused) {
                        startTimer();
                    } else {
                        pauseTimer();
                    }
                }
                
                // Escape to reset
                if (e.code === 'Escape') {
                    resetTimer();
                }
                
                // Number keys for duration selection
                if (e.code >= 'Digit1' && e.code <= 'Digit5') {
                    const durations = [5, 10, 15, 20, 30];
                    const index = parseInt(e.code.replace('Digit', '')) - 1;
                    if (durations[index]) {
                        setDuration(durations[index]);
                    }
                }
            });
        }
        
        function attachTimerLogic() {
            // Comprehensive element validation
            const elements = {
                display: document.getElementById('timer-display'),
                ringContainer: document.getElementById('timer-ring-container'),
                progressRing: document.getElementById('timer-progress-ring'),
                startBtn: document.getElementById('timer-start-btn'),
                pauseBtn: document.getElementById('timer-pause-btn'),
                resetBtn: document.getElementById('timer-reset-btn'),
                durationButtons: document.getElementById('duration-buttons'),
                soundSelect: document.getElementById('sound-select')
            };

            // Validate all critical elements exist
            const criticalElements = ['display', 'startBtn', 'pauseBtn', 'durationButtons'];
            const missingElements = criticalElements.filter(key => !elements[key]);
            
            if (missingElements.length > 0) {
                showUserError('Timer not properly loaded', `Missing elements: ${missingElements.join(', ')}. Please refresh the page.`);
                return;
            }

            // Timer state with validation
            let timerState = {
                totalSeconds: 600, // default 10 mins
                secondsRemaining: 600,
                isPaused: true,
                isRunning: false,
                timerInterval: null,
                isInitialized: false
            };
            
            const ringCircumference = 2 * Math.PI * 45; // 2 * PI * r
            const validDurations = [5, 10, 15, 20, 30]; // Valid duration options
            
            // Timer elements initialized
            
            function updateDisplay() {
                if (!elements.display || !timerState.isInitialized) {
                    return;
                }
                
                const minutes = Math.floor(timerState.secondsRemaining / 60);
                const seconds = timerState.secondsRemaining % 60;
                elements.display.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (elements.progressRing) {
                    const offset = ringCircumference - (timerState.secondsRemaining / timerState.totalSeconds) * ringCircumference;
                    elements.progressRing.style.strokeDashoffset = offset;
                }

                // Update progress bar and percentage
                updateProgressIndicator();

                // Update session status
                updateSessionStatus();
            }

            function updateProgressIndicator() {
                const progressBar = document.getElementById('progress-bar');
                const progressPercentage = document.getElementById('progress-percentage');
                const sessionProgress = document.getElementById('session-progress');
                
                if (progressBar && progressPercentage) {
                    const progress = ((timerState.totalSeconds - timerState.secondsRemaining) / timerState.totalSeconds) * 100;
                    progressBar.style.width = `${Math.max(0, Math.min(100, progress))}%`;
                    progressPercentage.textContent = `${Math.round(Math.max(0, Math.min(100, progress)))}%`;
                    
                    // Show progress indicator when session is active
                    if (sessionProgress) {
                        if (!timerState.isPaused && timerState.secondsRemaining < timerState.totalSeconds) {
                            sessionProgress.classList.remove('hidden');
                        } else {
                            sessionProgress.classList.add('hidden');
                        }
                    }
                }
            }

            function updateSessionStatus() {
                const sessionStatus = document.getElementById('session-status');
                const sessionTimeRemaining = document.getElementById('session-time-remaining');
                
                if (sessionStatus && sessionTimeRemaining) {
                    const minutes = Math.floor(timerState.secondsRemaining / 60);
                    const seconds = timerState.secondsRemaining % 60;
                    sessionTimeRemaining.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                    
                    if (!timerState.isPaused && timerState.secondsRemaining < timerState.totalSeconds) {
                        sessionStatus.classList.remove('hidden');
                    } else {
                        sessionStatus.classList.add('hidden');
                    }
                }
            }

            function startTimer() {
                // Prevent multiple starts or invalid states
                if (!timerState.isPaused || timerState.isRunning || timerState.secondsRemaining <= 0) {
                    return;
                }

                try {
                    timerState.isPaused = false;
                    timerState.isRunning = true;
                    
                    // Update UI elements with null checks
                    if (elements.startBtn) {
                        elements.startBtn.classList.add('hidden');
                        elements.startBtn.setAttribute('aria-pressed', 'false');
                    }
                    if (elements.pauseBtn) {
                        elements.pauseBtn.classList.remove('hidden');
                        elements.pauseBtn.setAttribute('aria-pressed', 'true');
                    }
                    if (elements.durationButtons) {
                        elements.durationButtons.style.pointerEvents = 'none';
                    }
                    if (elements.soundSelect) {
                        elements.soundSelect.disabled = true;
                    }
                    if (elements.ringContainer) {
                        elements.ringContainer.classList.add('timer-active');
                    }
                    
                    // Play start sound if available
                    if (timerState.secondsRemaining === timerState.totalSeconds && elements.soundSelect && sounds && sounds[elements.soundSelect.value]) {
                        try {
                            sounds[elements.soundSelect.value].play();
                        } catch (e) {
                            // Sound play failed, continue anyway
                        }
                    }
                    
                    // Clear any existing interval
                    if (timerState.timerInterval) {
                        clearInterval(timerState.timerInterval);
                    }
                    
                    // Start the timer
                    timerState.timerInterval = setInterval(() => {
                        timerState.secondsRemaining--;
                        updateDisplay();
                        saveSessionState();
                        
                        if (timerState.secondsRemaining <= 0) {
                            clearInterval(timerState.timerInterval);
                            timerState.isRunning = false;
                            
                            // Play completion sound
                            if (elements.soundSelect && sounds && sounds[elements.soundSelect.value]) {
                                try {
                                    sounds[elements.soundSelect.value].play();
                                } catch (e) {
                                    // Sound play failed, continue anyway
                                }
                            }
                            
                            logSession();
                            resetTimer();
                            
                            // Mark meditation as complete
                            if (typeof ProgressTracker !== 'undefined') {
                                ProgressTracker.markComplete('meditation');
                            }
                            showUserSuccess('Meditation session completed! Great work!');
                            
                            // Clear saved session on completion
                            localStorage.removeItem('meditationSession');
                        }
                    }, 1000);
                } catch (error) {
                    showUserError('Timer start failed', 'Please try again or refresh the page.');
                    timerState.isPaused = true;
                    timerState.isRunning = false;
                }
            }

            function pauseTimer() {
                if (!timerState.isRunning || timerState.isPaused) {
                    return;
                }

                try {
                    timerState.isPaused = true;
                    timerState.isRunning = false;
                    
                    if (timerState.timerInterval) {
                        clearInterval(timerState.timerInterval);
                        timerState.timerInterval = null;
                    }
                    
                    if (elements.startBtn) {
                        elements.startBtn.textContent = 'Resume';
                        elements.startBtn.classList.remove('hidden');
                        elements.startBtn.setAttribute('aria-pressed', 'false');
                    }
                    if (elements.pauseBtn) {
                        elements.pauseBtn.classList.add('hidden');
                        elements.pauseBtn.setAttribute('aria-pressed', 'false');
                    }
                    if (elements.ringContainer) {
                        elements.ringContainer.classList.remove('timer-active');
                    }
                    
                    saveSessionState();
                } catch (error) {
                    showUserError('Timer pause failed', 'Please try again.');
                }
            }

            function resetTimer() {
                try {
                    // Clear any running timer
                    if (timerState.timerInterval) {
                        clearInterval(timerState.timerInterval);
                        timerState.timerInterval = null;
                    }
                    
                    // Reset state
                    timerState.isPaused = true;
                    timerState.isRunning = false;
                    timerState.secondsRemaining = timerState.totalSeconds;
                    
                    // Update display
                    updateDisplay();
                    
                    // Reset UI elements
                    if (elements.startBtn) {
                        elements.startBtn.textContent = 'Start';
                        elements.startBtn.classList.remove('hidden');
                        elements.startBtn.setAttribute('aria-pressed', 'false');
                    }
                    if (elements.pauseBtn) {
                        elements.pauseBtn.classList.add('hidden');
                        elements.pauseBtn.setAttribute('aria-pressed', 'false');
                    }
                    if (elements.durationButtons) {
                        elements.durationButtons.style.pointerEvents = 'auto';
                    }
                    if (elements.soundSelect) {
                        elements.soundSelect.disabled = false;
                    }
                    if (elements.ringContainer) {
                        elements.ringContainer.classList.remove('timer-active');
                    }
                    
                    // Clear saved session on reset
                    localStorage.removeItem('meditationSession');
                    
                    // Hide progress indicators
                    const sessionProgress = document.getElementById('session-progress');
                    const sessionStatus = document.getElementById('session-status');
                    if (sessionProgress) sessionProgress.classList.add('hidden');
                    if (sessionStatus) sessionStatus.classList.add('hidden');
                } catch (error) {
                    showUserError('Timer reset failed', 'Please refresh the page.');
                }
            }
            
            function setDuration(minutes) {
                // Validate duration
                if (!minutes || !validDurations.includes(minutes) || minutes < 1 || minutes > 60) {
                    showUserError('Invalid duration', 'Please select a valid meditation duration.');
                    return;
                }

                try {
                    // Update timer state
                    timerState.totalSeconds = minutes * 60;
                    timerState.secondsRemaining = timerState.totalSeconds;
                    
                    // Reset timer to apply new duration
                    resetTimer();
                    
                    // Visual feedback - highlight selected duration
                    if (elements.durationButtons) {
                        const buttons = elements.durationButtons.querySelectorAll('.timer-duration-btn');
                        buttons.forEach(btn => {
                            const btnDuration = parseInt(btn.dataset.duration);
                            if (isNaN(btnDuration)) return;
                            
                            btn.classList.remove('ring-4', 'ring-earthy-gold', 'ring-opacity-50');
                            btn.setAttribute('aria-pressed', 'false');
                            
                            if (btnDuration === minutes) {
                                btn.classList.add('ring-4', 'ring-earthy-gold', 'ring-opacity-50');
                                btn.setAttribute('aria-pressed', 'true');
                            }
                        });
                    }
                    
                    // Announce duration change to screen readers
                    const announcement = document.createElement('div');
                    announcement.setAttribute('aria-live', 'polite');
                    announcement.setAttribute('aria-atomic', 'true');
                    announcement.className = 'sr-only';
                    announcement.textContent = `Meditation duration set to ${minutes} minutes`;
                    document.body.appendChild(announcement);
                    setTimeout(() => {
                        if (document.body.contains(announcement)) {
                            document.body.removeChild(announcement);
                        }
                    }, 1000);
                    
                    // Duration set successfully
                } catch (error) {
                    showUserError('Duration change failed', 'Please try again.');
                }
            }

            function logSession() {
                try {
                    const log = JSON.parse(localStorage.getItem('practiceLog')) || [];
                    const today = new Date().toISOString().split('T')[0];
                    log.push({ date: today, duration: totalSeconds / 60 });
                    localStorage.setItem('practiceLog', JSON.stringify(log));
                } catch (e) {
                    // Could not save practice log
                }
                displayPracticeLog();
            }

            function displayPracticeLog() {
                let log = [];
                try {
                    log = JSON.parse(localStorage.getItem('practiceLog')) || [];
                } catch(e) {
                    // Could not read practice log
                }
                const logContainer = document.getElementById('practice-log');
                if (log.length > 0) {
                    const totalMinutes = log.reduce((sum, entry) => sum + entry.duration, 0);
                    let streak = 0;
                    if(log.length > 0) {
                        const uniqueDates = [...new Set(log.map(l => l.date))].sort().reverse();
                        let today = new Date();
                        if(new Date(uniqueDates[0]).toDateString() === today.toDateString()) {
                            streak = 1;
                        } else {
                            today.setDate(today.getDate() -1);
                             if(uniqueDates[0] && new Date(uniqueDates[0]).toDateString() === today.toDateString()) {
                                streak = 1;
                             }
                        }
                        
                        if (streak > 0) {
                             for(let i=0; i < uniqueDates.length -1; i++){
                                let d1 = new Date(uniqueDates[i]);
                                d1.setDate(d1.getDate() - 1);
                                let d2 = new Date(uniqueDates[i+1]);
                                if(d1.toDateString() === d2.toDateString()) {
                                    streak++;
                                } else {
                                    break;
                                }
                            }
                        }
                    }

                    logContainer.innerHTML = `
                        <h3 class="text-2xl font-bold font-lora mb-4">Practice Log</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                           <div><p class="text-charcoal/80">Total Minutes</p><strong class="text-2xl font-lora text-forest-green">${totalMinutes}</strong></div>
                           <div><p class="text-charcoal/80">Total Sessions</p><strong class="text-2xl font-lora text-forest-green">${log.length}</strong></div>
                           <div><p class="text-charcoal/80">Current Streak</p><strong class="text-2xl font-lora text-forest-green">${streak} days</strong></div>
                        </div>
                        <canvas id="practice-chart" class="mt-4 h-40 w-full"></canvas>
                    `;
                    
                    const canvas = document.getElementById('practice-chart');
                    const ctx = canvas.getContext('2d');
                    const last7DaysData = {};
                    for(let i = 6; i >= 0; i--) {
                        const d = new Date();
                        d.setDate(d.getDate() - i);
                        const key = d.toISOString().split('T')[0].slice(5);
                        last7DaysData[key] = 0;
                    }
                    log.forEach(entry => {
                        const key = entry.date.slice(5);
                        if(last7DaysData[key] !== undefined) {
                            last7DaysData[key] += entry.duration;
                        }
                    });
                     // Basic chart drawing - no external libs
                    const maxValue = Math.max(...Object.values(last7DaysData), 10);
                    const barWidth = canvas.width / 7;
                    let i = 0;
                    const isDark = document.documentElement.classList.contains('dark');
                    ctx.font = '12px Inter';
                    for(const [day, minutes] of Object.entries(last7DaysData)) {
                        const barHeight = (minutes / maxValue) * (canvas.height - 20);
                        ctx.fillStyle = isDark ? '#86b596' : 'var(--forest-green)';
                        ctx.fillRect(i * barWidth + 5, canvas.height - barHeight - 15, barWidth - 10, barHeight);
                        ctx.fillStyle = isDark ? '#d1d1d1' : 'var(--charcoal)';
                        ctx.fillText(day, i * barWidth + 10, canvas.height - 2);
                        i++;
                    }


                } else {
                     logContainer.innerHTML = `<p class="text-center text-charcoal/70">Your practice log will appear here once you complete a session.</p>`;
                }
            }

            // Enhanced event listener with comprehensive error handling
            if (elements.durationButtons) {
                elements.durationButtons.addEventListener('click', e => {
                    try {
                        // Use event delegation for better reliability
                        const button = e.target.closest('.timer-duration-btn');
                        if (!button) {
                            return;
                        }
                        
                        const duration = parseInt(button.dataset.duration);
                        
                        if (isNaN(duration) || !validDurations.includes(duration)) {
                            showUserError('Invalid duration selected', 'Please try a different duration.');
                            return;
                        }
                        
                        setDuration(duration);
                    } catch (error) {
                        console.error('Duration selection error:', error);
                        showUserError('Duration selection failed', 'Please try again.');
                    }
                });
            } else {
                showUserError('Timer controls not found', 'Please refresh the page and try again.');
                return;
            }
            
            // Add event listeners with error handling
            if (elements.startBtn) {
                elements.startBtn.addEventListener('click', startTimer);
            }
            if (elements.pauseBtn) {
                elements.pauseBtn.addEventListener('click', pauseTimer);
            }
            if (elements.resetBtn) {
                elements.resetBtn.addEventListener('click', resetTimer);
            }

            // Initialize timer state
            timerState.isInitialized = true;
            
            // Initialize display and practice log
            updateDisplay();
            displayPracticeLog();
            
            // Highlight default duration (10 minutes)
            setDuration(10);
            
            // Add keyboard navigation
            addKeyboardNavigation(startTimer, pauseTimer, resetTimer, setDuration, timerState);
            
            // Add session persistence
            loadSessionState();
            
            // Ensure timer display is visible
            if (elements.display) {
                elements.display.style.display = 'flex';
                elements.display.style.visibility = 'visible';
            }
            
            // Timer initialized successfully

            // Add keyboard navigation
            addKeyboardNavigation(startTimer, pauseTimer, resetTimer, setDuration, timerState);

            function loadSessionState() {
                // Load saved session state from localStorage
                const savedState = localStorage.getItem('meditationSession');
                if (savedState) {
                    try {
                        const state = JSON.parse(savedState);
                        if (state.totalSeconds && state.secondsRemaining) {
                            totalSeconds = state.totalSeconds;
                            secondsRemaining = state.secondsRemaining;
                            isPaused = state.isPaused || true;
                            updateDisplay();
                            
                            if (state.soundSelect) {
                                if (soundSelect) soundSelect.value = state.soundSelect;
                            }
                        }
                    } catch (e) {
                        // Could not load session state
                    }
                }
            }

            function saveSessionState() {
                // Save current session state
                const state = {
                    totalSeconds,
                    secondsRemaining,
                    isPaused,
                    soundSelect: soundSelect ? soundSelect.value : 'chime',
                    timestamp: Date.now()
                };
                localStorage.setItem('meditationSession', JSON.stringify(state));
            }
        }
        
        function attachWorkoutLogic() {
            const statusEl = document.getElementById('workout-status');
            const exerciseEl = document.getElementById('workout-exercise');
            const timerEl = document.getElementById('workout-timer');
            const nextEl = document.getElementById('workout-next-exercise');
            const startBtn = document.getElementById('workout-start-btn');
            const pauseBtn = document.getElementById('workout-pause-btn');
            const forwardBtn = document.getElementById('workout-forward-btn');
            const backBtn = document.getElementById('workout-back-btn');
            const doubleModeCheckbox = document.getElementById('workout-double-mode');
            const visualEl = document.getElementById('workout-visual');
            const soundSelect = document.getElementById('workout-sound');
            const instructionText = document.getElementById('workout-instruction-text');
            const phaseEl = document.getElementById('workout-phase');
            const progressText = document.getElementById('workout-progress-text');
            const progressBar = document.getElementById('workout-progress-bar');
            const totalTimeEl = document.getElementById('workout-total-time');
            const caloriesEl = document.getElementById('workout-calories');
            const completedEl = document.getElementById('workout-completed');

            let workoutPlan = [...db.workout.exercises];
            let currentExerciseIndex = 0;
            let isResting = true;
            let secondsRemaining = 10;
            let isPaused = true;
            let totalTime = 0;
            let totalCalories = 0;
            let completedExercises = 0;
            
            const bellSound = sounds.chime;

            function speak(text) {
                if (soundSelect.value === 'on' && 'speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = 1.2;
                    window.speechSynthesis.speak(utterance);
                }
            }
            
            function updateDisplay() {
                timerEl.textContent = secondsRemaining;
                const currentEx = workoutPlan[currentExerciseIndex];
                visualEl.innerHTML = currentEx.visual;
                
                // Update instructions
                if (currentEx.instructions) {
                    instructionText.textContent = currentEx.instructions;
                }
                
                // Update progress
                const progress = ((currentExerciseIndex + (isResting ? 0 : 1)) / workoutPlan.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `Exercise ${currentExerciseIndex + 1} of ${workoutPlan.length}`;
                
                // Update stats
                const minutes = Math.floor(totalTime / 60);
                const seconds = totalTime % 60;
                totalTimeEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                caloriesEl.textContent = totalCalories;
                completedEl.textContent = `${completedExercises}/${workoutPlan.length}`;
                
                if (isResting) {
                    statusEl.textContent = 'Get Ready!';
                    exerciseEl.textContent = currentEx.name;
                    phaseEl.textContent = 'Rest';
                    nextEl.style.visibility = 'visible';
                    
                    // Add pulse animation during rest
                    timerEl.classList.add('workout-pulse');
                     if (secondsRemaining === 3 && isPaused === false) speak(`Next: ${currentEx.name}`);
                } else {
                    statusEl.textContent = `Workout #${currentExerciseIndex + 1}`;
                    exerciseEl.textContent = currentEx.name;
                    phaseEl.textContent = 'Exercise';
                    nextEl.style.visibility = 'hidden';
                    
                    // Add bounce animation during exercise
                    timerEl.classList.remove('workout-pulse');
                    timerEl.classList.add('workout-bounce');
                }
                
                const nextIndex = currentExerciseIndex + 1;
                if(nextIndex < workoutPlan.length) {
                   nextEl.textContent = workoutPlan[nextIndex].name;
                } else {
                   nextEl.textContent = 'Last one!';
                }
            }
            
            function tick() {
                secondsRemaining--;
                totalTime++;
                
                // Add calories during exercise
                if (!isResting && workoutPlan[currentExerciseIndex].calories) {
                    const caloriesPerSecond = workoutPlan[currentExerciseIndex].calories / workoutPlan[currentExerciseIndex].duration;
                    totalCalories += caloriesPerSecond;
                }
                
                if (secondsRemaining <= 3 && secondsRemaining > 0) speak(secondsRemaining);
                if (secondsRemaining < 0) {
                    if (soundSelect.value === 'on') bellSound.play();
                    isResting = !isResting;
                    if (!isResting) { // Finished rest, start exercise
                        secondsRemaining = workoutPlan[currentExerciseIndex].duration;
                        speak('Begin');
                    } else { // Finished exercise, start rest
                        completedExercises++;
                        currentExerciseIndex++;
                        if (currentExerciseIndex >= workoutPlan.length) {
                            finishWorkout();
                            return;
                        }
                        secondsRemaining = db.workout.restDuration;
                    }
                }
                updateDisplay();
            }

            function startWorkout() {
                if (isPaused) {
                    isPaused = false;
                    startBtn.classList.add('hidden');
                    pauseBtn.classList.remove('hidden');
                    if(secondsRemaining === 10 && currentExerciseIndex === 0) {
                        speak(`Starting ${doubleModeCheckbox.checked ? '14' : '7'} minute workout.`);
                    }
                    workoutInterval = setInterval(tick, 1000);
                }
            }
            
            function pauseWorkout() {
                isPaused = true;
                clearInterval(workoutInterval);
                startBtn.textContent = 'Resume';
                startBtn.classList.remove('hidden');
                pauseBtn.classList.add('hidden');
            }

            function changeExercise(direction) {
                pauseWorkout();
                currentExerciseIndex += direction;
                if (currentExerciseIndex < 0) currentExerciseIndex = 0;
                if (currentExerciseIndex >= workoutPlan.length) currentExerciseIndex = workoutPlan.length - 1;
                isResting = true;
                secondsRemaining = db.workout.restDuration;
                updateDisplay();
            }

            function resetWorkout() {
                if (doubleModeCheckbox.checked) {
                    workoutPlan = [...db.workout.exercises, ...db.workout.exercises];
                } else {
                    workoutPlan = [...db.workout.exercises];
                }
                currentExerciseIndex = 0;
                isResting = true;
                secondsRemaining = 10;
                isPaused = true;
                totalTime = 0;
                totalCalories = 0;
                completedExercises = 0;
                clearInterval(workoutInterval);
                startBtn.textContent = 'Start Workout';
                startBtn.classList.remove('hidden');
                pauseBtn.classList.add('hidden');
                updateDisplay();
            }
            
            function finishWorkout() {
                 clearInterval(workoutInterval);
                 statusEl.textContent = 'Finished!';
                 exerciseEl.textContent = 'Well Done!';
                 timerEl.textContent = '🎉';
                 phaseEl.textContent = 'Complete';
                 nextEl.style.visibility = 'hidden';
                 
                 // Add celebration animation
                 timerEl.classList.remove('workout-pulse', 'workout-bounce');
                 timerEl.classList.add('workout-shake');
                 
                 // Update final stats
                 totalCalories = Math.round(totalCalories);
                 updateDisplay();
                 
                 speak('Workout complete. Well done!');
                 showNotification(`Workout complete! You burned ${totalCalories} calories in ${Math.floor(totalTime/60)}:${(totalTime%60).toString().padStart(2, '0')}`);
                 // Mark workout as complete
                 ProgressTracker.markComplete('workout');
            }

            startBtn.addEventListener('click', startWorkout);
            pauseBtn.addEventListener('click', pauseWorkout);
            forwardBtn.addEventListener('click', () => changeExercise(1));
            backBtn.addEventListener('click', () => changeExercise(-1));
            doubleModeCheckbox.addEventListener('change', resetWorkout);

            resetWorkout(); // Initialize display
        }
        
        function attachInterviewLogic() {
            const questionEl = document.getElementById('interview-question');
            const liveVideo = document.getElementById('live-video');
            const playbackVideo = document.getElementById('playback-video');
            const playbackVideoContainer = document.getElementById('playback-video-container');
            const startBtn = document.getElementById('start-recording-btn');
            const stopBtn = document.getElementById('stop-recording-btn');
            const nextBtn = document.getElementById('next-question-btn');
            const playbackSection = document.getElementById('playback-section');
            const recordingsList = document.getElementById('recordings-list');
            const noRecordingsMsg = document.getElementById('no-recordings-message');
            const catButtons = document.querySelectorAll('.interview-cat-btn');
            const feedbackEl = document.getElementById('interview-feedback');
            const cameraErrorEl = document.getElementById('camera-error');
            
            let currentCategory = 'general';
            let currentQuestionIndex = 0;
            sessionRecordings = [];

            function setCategory(category) {
                currentCategory = category;
                currentQuestionIndex = 0;
                updateQuestion();
                catButtons.forEach(btn => {
                    btn.classList.toggle('bg-earthy-gold', btn.dataset.category === category);
                     btn.classList.toggle('text-white', btn.dataset.category === category);
                });
            }

            function updateQuestion() {
                questionEl.textContent = db.interviewQuestions[currentCategory][currentQuestionIndex];
            }

            async function setupCamera() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                    if (!stream.getAudioTracks().length > 0) {
                        throw new Error("No audio track found. Please check microphone permissions.");
                    }
                    liveVideo.srcObject = stream;
                    
                    const options = { mimeType: 'video/webm;codecs=vp8,opus' };
                    if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                         // MIME type not supported, using default
                         mediaRecorder = new MediaRecorder(stream);
                    } else {
                         mediaRecorder = new MediaRecorder(stream, options);
                    }
                   
                    mediaRecorder.ondataavailable = e => recordedChunks.push(e.data);
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'video/webm' });
                        recordedChunks = [];
                        const videoURL = URL.createObjectURL(blob);
                        addRecordingToList({
                            question: db.interviewQuestions[currentCategory][currentQuestionIndex],
                            url: videoURL,
                            timestamp: new Date()
                        });
                        
                        // Mark confidence practice as complete
                        ProgressTracker.markComplete('confidence');
                        showUserSuccess('Recording saved! Great practice session!');
                    };
                } catch (err) {
                    // Error accessing camera
                    cameraErrorEl.classList.remove('hidden');
                }
            }
            
            function addRecordingToList(recording) {
                sessionRecordings.push(recording);
                noRecordingsMsg.classList.add('hidden');
                
                const item = document.createElement('div');
                item.className = 'p-4 bg-light-green dark:bg-gray-700/50 rounded-lg flex items-center justify-between';
                item.innerHTML = `
                    <div class="flex-1">
                        <p class="font-semibold text-charcoal">${recording.question}</p>
                        <p class="text-sm text-charcoal/70">${recording.timestamp.toLocaleTimeString()}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button class="play-recording-btn px-4 py-2 bg-forest-green text-white text-sm font-semibold rounded-lg hover:bg-forest-green/90 transition flex items-center space-x-2" data-url="${recording.url}">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                            <span>Play</span>
                        </button>
                        <button class="delete-recording-btn px-4 py-2 bg-red-600 text-white text-sm font-semibold rounded-lg hover:bg-red-700 transition" data-url="${recording.url}">🗑️ Delete</button>
                    </div>
                `;
                recordingsList.appendChild(item);
                
                playbackVideo.src = recording.url;
                playbackVideoContainer.classList.remove('hidden');
                playbackVideo.onended = showFeedback;
            }

            function showFeedback() {
                const feedbacks = ["Great pacing!", "Clear and confident delivery.", "Excellent example. Try to vary your tone slightly.", "Strong eye contact with the camera."];
                const randomFeedback = feedbacks[Math.floor(Math.random() * feedbacks.length)];
                feedbackEl.textContent = `💡 Feedback: ${randomFeedback}`;
                feedbackEl.classList.remove('hidden');
            }

            function startRecording() {
                if(mediaRecorder) {
                    recordedChunks = [];
                    mediaRecorder.start();
                    startBtn.classList.add('hidden');
                    stopBtn.classList.remove('hidden');
                    playbackVideoContainer.classList.add('hidden');
                    feedbackEl.classList.add('hidden');
                }
            }

            function stopRecording() {
                if(mediaRecorder) {
                    mediaRecorder.stop();
                    startBtn.classList.remove('hidden');
                    stopBtn.classList.add('hidden');
                }
            }
            
            function nextQuestion() {
                currentQuestionIndex = (currentQuestionIndex + 1) % db.interviewQuestions[currentCategory].length;
                updateQuestion();
                playbackVideo.classList.add('hidden');
                feedbackEl.classList.add('hidden');
            }
            
            function previousQuestion() {
                currentQuestionIndex = currentQuestionIndex === 0 ? 
                    db.interviewQuestions[currentCategory].length - 1 : 
                    currentQuestionIndex - 1;
                updateQuestion();
                playbackVideo.classList.add('hidden');
                feedbackEl.classList.add('hidden');
            }
            
            // Debug interview button visibility
            // Interview start button initialized
            
            startBtn.addEventListener('click', startRecording);
            stopBtn.addEventListener('click', stopRecording);
            nextBtn.addEventListener('click', nextQuestion);
            
            // Previous question button
            const prevBtn = document.getElementById('previous-question-btn');
            prevBtn.addEventListener('click', previousQuestion);
            catButtons.forEach(btn => btn.addEventListener('click', () => setCategory(btn.dataset.category)));
            
            // Random question button
            const randomBtn = document.getElementById('random-question-btn');
            randomBtn.addEventListener('click', () => {
                const allQuestions = Object.values(db.interviewQuestions).flat();
                const randomIndex = Math.floor(Math.random() * allQuestions.length);
                questionEl.textContent = allQuestions[randomIndex];
                // Highlight the random button briefly
                randomBtn.classList.add('bg-yellow-500');
                setTimeout(() => randomBtn.classList.remove('bg-yellow-500'), 1000);
            });
            
            recordingsList.addEventListener('click', (e) => {
                if(e.target.classList.contains('play-recording-btn')) {
                    playbackVideo.src = e.target.dataset.url;
                    playbackVideoContainer.classList.remove('hidden');
                    playbackVideo.play();
                    feedbackEl.classList.add('hidden');
                } else if(e.target.classList.contains('delete-recording-btn')) {
                    const url = e.target.dataset.url;
                    // Remove from session recordings array
                    const index = sessionRecordings.findIndex(r => r.url === url);
                    if (index > -1) {
                        sessionRecordings.splice(index, 1);
                    }
                    // Remove from DOM
                    e.target.closest('div').remove();
                    // Revoke the URL to free memory
                    URL.revokeObjectURL(url);
                    // Show no recordings message if list is empty
                    if (sessionRecordings.length === 0) {
                        noRecordingsMsg.classList.remove('hidden');
                        playbackVideoContainer.classList.add('hidden');
                    }
                }
            });
            
            setCategory('general');
            setupCamera();
        }
        
        function attachJournalLogic() {
            const timerEl = document.getElementById('journal-timer');
            const startBtn = document.getElementById('journal-start-btn');
            const entryEl = document.getElementById('journal-entry');
            const historyList = document.getElementById('journal-history-list');
            const durationSelect = document.getElementById('timer-duration');
            const saveBtn = document.getElementById('journal-save-btn');
            
            let secondsRemaining = 600;
            let totalDuration = 600;
            let isRunning = false;
            
            function updateDisplay() {
                const minutes = Math.floor(secondsRemaining / 60);
                const seconds = secondsRemaining % 60;
                timerEl.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }

            function resetTimer() {
                totalDuration = parseInt(durationSelect.value);
                secondsRemaining = totalDuration;
                updateDisplay();
                // Journal timer reset
            }

            function startJournal() {
                if(isRunning) return;
                isRunning = true;
                startBtn.disabled = true;
                startBtn.textContent = 'Writing...';
                startBtn.classList.add('opacity-50');
                durationSelect.disabled = true;

                journalInterval = setInterval(() => {
                    secondsRemaining--;
                    updateDisplay();
                    if(secondsRemaining <= 0) {
                        finishJournal();
                    }
                }, 1000);
            }

            function finishJournal() {
                clearInterval(journalInterval);
                sounds.chime.play();
                entryEl.disabled = true;
                startBtn.disabled = false;
                startBtn.textContent = 'Start New Entry';
                startBtn.classList.remove('opacity-50');
                durationSelect.disabled = false;
                saveEntry();
                resetTimer();
                isRunning = false;
            }
            
            function saveEntry() {
                const content = entryEl.value.trim();
                if (content === '') return;
                
                try {
                    const entries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                    const newEntry = {
                        date: new Date().toISOString(),
                        content: content
                    };
                    entries.unshift(newEntry);
                    localStorage.setItem('journalEntries', JSON.stringify(entries));
                    
                    // Mark journal as complete
                    ProgressTracker.markComplete('journal');
                    showUserSuccess('Journal entry saved successfully!');
                } catch(e) {
                    // Failed to save journal entry
                }
                
                entryEl.value = '';
                displayEntries();
            }

            function deleteEntry(index) {
                try {
                    const entries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                    if (index >= 0 && index < entries.length) {
                        // Show confirmation dialog
                        if (confirm('Are you sure you want to delete this journal entry? This action cannot be undone.')) {
                            entries.splice(index, 1);
                            localStorage.setItem('journalEntries', JSON.stringify(entries));
                            showUserSuccess('Journal entry deleted successfully!');
                            displayEntries(); // Refresh the display
                        }
                    }
                } catch(e) {
                    showUserError('Failed to delete journal entry', 'Please try again.');
                }
            }

            function displayEntries() {
                 let entries = [];
                try {
                    entries = JSON.parse(localStorage.getItem('journalEntries')) || [];
                } catch(e) {
                    // Failed to load journal entries
                }
                historyList.innerHTML = '';
                if(entries.length === 0) {
                    historyList.innerHTML = `<p class="text-center text-charcoal/70">Your saved journal entries will appear here.</p>`;
                    return;
                }

                entries.forEach((entry, index) => {
                    const date = new Date(entry.date);
                    const item = document.createElement('div');
                    item.className = 'bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-black/5 hover:shadow-md transition-all duration-300';
                    item.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                        <p class="font-semibold text-earthy-gold">${date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                                <p class="mt-2 text-charcoal/80 whitespace-pre-wrap leading-relaxed">${entry.content}</p>
                            </div>
                            <button class="delete-entry-btn ml-4 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all duration-200" data-index="${index}" title="Delete this entry">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    `;
                    historyList.appendChild(item);
                });

                // Add event listeners to delete buttons
                const deleteButtons = historyList.querySelectorAll('.delete-entry-btn');
                deleteButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        const index = parseInt(button.getAttribute('data-index'));
                        deleteEntry(index);
                    });
                });
            }
            
            // Duration selector change handler
            durationSelect.addEventListener('change', () => {
                if (!isRunning) {
                    resetTimer();
                }
            });
            
            entryEl.addEventListener('input', () => {
                if (!isRunning && entryEl.value.length > 0) {
                     startJournal();
                }
                // Show save button when user starts typing
                if (entryEl.value.length > 0) {
                    saveBtn.classList.remove('hidden');
                } else {
                    saveBtn.classList.add('hidden');
                }
            });
            
            startBtn.addEventListener('click', () => {
                // Journal start clicked
                entryEl.disabled = false;
                entryEl.value = '';
                entryEl.focus();
            });

            saveBtn.addEventListener('click', () => {
                if (entryEl.value.trim()) {
                    saveEntry();
                    showNotification('Entry saved successfully!');
                }
            });

            // Quick preset buttons
            document.querySelectorAll('.quick-preset-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const duration = parseInt(btn.dataset.duration);
                    durationSelect.value = duration;
                    resetTimer();
                    // Visual feedback
                    document.querySelectorAll('.quick-preset-btn').forEach(b => b.classList.remove('ring-2', 'ring-forest-green'));
                    btn.classList.add('ring-2', 'ring-forest-green');
                });
            });

            // Initialize timer display
            resetTimer();
            displayEntries();
        }

    });
    </script>
</body>
</html>

