<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working Meditation Timer Example</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-4xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold text-center mb-8 text-green-600">Working Meditation Timer</h1>
        
        <div class="bg-white rounded-xl p-6 shadow-xl">
            <div class="text-center">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">Your Meditation Timer</h2>
                
                <!-- Timer Display with Progress Ring -->
                <div class="relative w-80 h-80 mx-auto mb-8">
                    <svg class="w-full h-full transform -rotate-90" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" stroke="#e5e7eb" stroke-width="6" fill="none" opacity="0.3"/>
                        <circle id="progress-ring" cx="50" cy="50" r="45" stroke="#4A6C55" stroke-width="6" fill="none" 
                                stroke-dasharray="283" stroke-dashoffset="283" 
                                class="transition-all duration-1000 ease-linear"/>
                    </svg>
                    
                    <div class="absolute inset-0 flex flex-col items-center justify-center">
                        <div id="timer-display" class="text-8xl font-bold text-green-600 mb-4">10:00</div>
                        <div id="timer-status" class="text-xl text-gray-600 mb-4">Ready to begin</div>
                        <div class="text-6xl">üßò‚Äç‚ôÄÔ∏è</div>
                    </div>
                </div>
                
                <!-- Duration Selection -->
                <div class="mb-6">
                    <label for="timer-duration" class="block text-sm font-bold mb-2">Duration:</label>
                    <select id="timer-duration" class="px-4 py-3 border-2 border-green-300 rounded-xl">
                        <option value="300">5 minutes</option>
                        <option value="600" selected>10 minutes</option>
                        <option value="900">15 minutes</option>
                        <option value="1200">20 minutes</option>
                        <option value="1800">30 minutes</option>
                    </select>
                </div>
                
                <!-- Sound Options -->
                <div class="mb-6">
                    <label class="flex items-center justify-center space-x-3 cursor-pointer">
                        <input type="checkbox" id="timer-sound" class="h-5 w-5 rounded text-green-600" checked>
                        <span class="font-bold">üîî Sound</span>
                    </label>
                </div>
                
                <!-- Control Buttons -->
                <div class="flex justify-center space-x-6">
                    <button id="timer-start-btn" class="px-8 py-6 bg-green-600 text-white font-bold rounded-3xl text-2xl hover:bg-green-700 transition-colors">
                        ‚ñ∂Ô∏è Start Meditation
                    </button>
                    <button id="timer-pause-btn" class="px-8 py-6 bg-yellow-500 text-white font-bold rounded-3xl text-2xl hover:bg-yellow-600 transition-colors hidden">
                        ‚è∏Ô∏è Pause
                    </button>
                    <button id="timer-reset-btn" class="px-8 py-6 bg-gray-500 text-white font-bold rounded-3xl text-2xl hover:bg-gray-600 transition-colors">
                        üîÑ Reset
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Console Log Area -->
        <div class="mt-8 bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm">
            <div class="mb-2 text-white">Console Logs:</div>
            <div id="console-logs"></div>
        </div>
    </div>

    <script>
        // ===== WORKING MEDITATION TIMER =====
        
        // Global timer variables
        let timeRemaining = 600; // 10 minutes default
        let totalTime = 600;
        let isRunning = false;
        let isPaused = false;
        let timerInterval = null;
        
        // DOM elements
        let startBtn, pauseBtn, resetBtn, display, status, durationSelect, soundToggle, progressRing;
        
        // Log function to show in console area
        function log(message) {
            console.log(message);
            const logs = document.getElementById('console-logs');
            logs.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
            logs.scrollTop = logs.scrollHeight;
        }
        
        // Update display function
        function updateDisplay() {
            if (display) {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                const displayText = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                display.textContent = displayText;
                log('‚úÖ Display updated to: ' + displayText);
            }
            
            if (status) {
                if (isRunning) {
                    status.textContent = 'Meditating...';
                } else if (isPaused) {
                    status.textContent = 'Paused';
                } else {
                    status.textContent = 'Ready to begin';
                }
            }
            
            // Update progress ring
            if (progressRing && totalTime > 0) {
                const progress = (timeRemaining / totalTime) * 283;
                progressRing.style.strokeDashoffset = progress;
                log('Progress ring updated to: ' + progress);
            }
        }
        
        // Start timer function
        function startTimer() {
            log('üöÄ Starting timer...');
            if (!isRunning) {
                isRunning = true;
                isPaused = false;
                
                if (startBtn) startBtn.classList.add('hidden');
                if (pauseBtn) pauseBtn.classList.remove('hidden');
                
                timerInterval = setInterval(() => {
                    if (timeRemaining > 0) {
                        timeRemaining--;
                        log('Timer tick: ' + timeRemaining + ' seconds remaining');
                        updateDisplay();
                    } else {
                        clearInterval(timerInterval);
                        isRunning = false;
                        log('‚úÖ Timer finished!');
                        
                        if (status) status.textContent = 'Session complete! üéâ';
                        if (startBtn) startBtn.classList.remove('hidden');
                        if (pauseBtn) pauseBtn.classList.add('hidden');
                        
                        // Play completion sound if enabled
                        if (soundToggle && soundToggle.checked) {
                            log('üîî Playing completion sound');
                        }
                    }
                }, 1000);
                
                log('Timer started successfully');
            }
        }
        
        // Pause timer function
        function pauseTimer() {
            log('‚è∏Ô∏è Pausing timer...');
            if (isRunning) {
                isRunning = false;
                isPaused = true;
                clearInterval(timerInterval);
                
                if (startBtn) startBtn.classList.remove('hidden');
                if (pauseBtn) pauseBtn.classList.add('hidden');
                
                log('Timer paused');
            }
        }
        
        // Reset timer function
        function resetTimer() {
            log('üîÑ Resetting timer...');
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            isRunning = false;
            isPaused = false;
            timeRemaining = parseInt(durationSelect ? durationSelect.value : 600);
            totalTime = timeRemaining;
            
            if (startBtn) startBtn.classList.remove('hidden');
            if (pauseBtn) pauseBtn.classList.add('hidden');
            
            updateDisplay();
            log('Timer reset to ' + timeRemaining + ' seconds');
        }
        
        // Initialize timer when page loads
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Initializing timer...');
            
            // Get DOM elements
            startBtn = document.getElementById('timer-start-btn');
            pauseBtn = document.getElementById('timer-pause-btn');
            resetBtn = document.getElementById('timer-reset-btn');
            display = document.getElementById('timer-display');
            status = document.getElementById('timer-status');
            durationSelect = document.getElementById('timer-duration');
            soundToggle = document.getElementById('timer-sound');
            progressRing = document.getElementById('progress-ring');
            
            log('DOM elements found: ' + JSON.stringify({
                startBtn: !!startBtn,
                pauseBtn: !!pauseBtn,
                resetBtn: !!resetBtn,
                display: !!display,
                status: !!status,
                durationSelect: !!durationSelect,
                soundToggle: !!soundToggle,
                progressRing: !!progressRing
            }));
            
            // Set up event listeners
            if (startBtn) {
                startBtn.addEventListener('click', startTimer);
                log('‚úÖ Start button listener added');
            }
            
            if (pauseBtn) {
                pauseBtn.addEventListener('click', pauseTimer);
                log('‚úÖ Pause button listener added');
            }
            
            if (resetBtn) {
                resetBtn.addEventListener('click', resetTimer);
                log('‚úÖ Reset button listener added');
            }
            
            if (durationSelect) {
                durationSelect.addEventListener('change', function() {
                    if (!isRunning) {
                        timeRemaining = parseInt(durationSelect.value);
                        totalTime = timeRemaining;
                        updateDisplay();
                        log('Duration changed to: ' + timeRemaining + ' seconds');
                    }
                });
                log('‚úÖ Duration select listener added');
            }
            
            // Initialize display
            updateDisplay();
            log('‚úÖ Timer initialization complete');
        });
    </script>
</body>
</html>
